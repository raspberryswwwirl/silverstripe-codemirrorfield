function e(e,t){const i=Object.create(null);const n=e.split(",");for(let s=0;s<n.length;s++)i[n[s]]=true;return t?e=>!!i[e.toLowerCase()]:e=>!!i[e]}const t=`itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly`;const i=e(t);function n(e){return!!e||""===e}function s(e){if(b(e)){const t={};for(let i=0;i<e.length;i++){const n=e[i];const r=C(n)?l(n):s(n);if(r)for(const e in r)t[e]=r[e]}return t}else if(C(e))return e;else if(M(e))return e}const r=/;(?![^(]*\))/g;const o=/:(.+)/;function l(e){const t={};e.split(r).forEach((e=>{if(e){const i=e.split(o);i.length>1&&(t[i[0].trim()]=i[1].trim())}}));return t}function a(e){let t="";if(C(e))t=e;else if(b(e))for(let i=0;i<e.length;i++){const n=a(e[i]);if(n)t+=n+" "}else if(M(e))for(const i in e)if(e[i])t+=i+" ";return t.trim()}const h={};const c=[];const f=()=>{};const u=()=>false;const d=/^on[^a-z]/;const p=e=>d.test(e);const m=e=>e.startsWith("onUpdate:");const g=Object.assign;const v=(e,t)=>{const i=e.indexOf(t);if(i>-1)e.splice(i,1)};const w=Object.prototype.hasOwnProperty;const y=(e,t)=>w.call(e,t);const b=Array.isArray;const x=e=>"[object Map]"===T(e);const k=e=>"[object Set]"===T(e);const S=e=>"function"===typeof e;const C=e=>"string"===typeof e;const A=e=>"symbol"===typeof e;const M=e=>null!==e&&"object"===typeof e;const O=e=>M(e)&&S(e.then)&&S(e.catch);const D=Object.prototype.toString;const T=e=>D.call(e);const E=e=>T(e).slice(8,-1);const R=e=>"[object Object]"===T(e);const _=e=>C(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e;const B=e(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted");const L=e=>{const t=Object.create(null);return i=>{const n=t[i];return n||(t[i]=e(i))}};const P=/-(\w)/g;const N=L((e=>e.replace(P,((e,t)=>t?t.toUpperCase():""))));const I=/\B([A-Z])/g;const V=L((e=>e.replace(I,"-$1").toLowerCase()));const F=L((e=>e.charAt(0).toUpperCase()+e.slice(1)));const H=L((e=>e?`on${F(e)}`:``));const W=(e,t)=>!Object.is(e,t);const z=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)};const q=(e,t,i)=>{Object.defineProperty(e,t,{configurable:true,enumerable:false,value:i})};const j=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let $;const U=()=>$||($="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{});let K;class G{constructor(e=false){this.active=true;this.effects=[];this.cleanups=[];if(!e&&K){this.parent=K;this.index=(K.scopes||(K.scopes=[])).push(this)-1}}run(e){if(this.active)try{K=this;return e()}finally{K=this.parent}}on(){K=this}off(){K=this.parent}stop(e){if(this.active){let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(true);if(this.parent&&!e){const e=this.parent.scopes.pop();if(e&&e!==this){this.parent.scopes[this.index]=e;e.index=this.index}}this.active=false}}}function J(e,t=K){if(t&&t.active)t.effects.push(e)}const X=e=>{const t=new Set(e);t.w=0;t.n=0;return t};const Y=e=>(e.w&ne)>0;const Q=e=>(e.n&ne)>0;const Z=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=ne};const ee=e=>{const{deps:t}=e;if(t.length){let i=0;for(let n=0;n<t.length;n++){const s=t[n];if(Y(s)&&!Q(s))s.delete(e);else t[i++]=s;s.w&=~ne;s.n&=~ne}t.length=i}};const te=new WeakMap;let ie=0;let ne=1;const se=30;let re;const oe=Symbol("");const le=Symbol("");class ae{constructor(e,t=null,i){this.fn=e;this.scheduler=t;this.active=true;this.deps=[];this.parent=void 0;J(this,i)}run(){if(!this.active)return this.fn();let e=re;let t=ce;while(e){if(e===this)return;e=e.parent}try{this.parent=re;re=this;ce=true;ne=1<<++ie;if(ie<=se)Z(this);else he(this);return this.fn()}finally{if(ie<=se)ee(this);ne=1<<--ie;re=this.parent;ce=t;this.parent=void 0}}stop(){if(this.active){he(this);if(this.onStop)this.onStop();this.active=false}}}function he(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let ce=true;const fe=[];function ue(){fe.push(ce);ce=false}function de(){const e=fe.pop();ce=void 0===e?true:e}function pe(e,t,i){if(ce&&re){let t=te.get(e);if(!t)te.set(e,t=new Map);let n=t.get(i);if(!n)t.set(i,n=X());me(n)}}function me(e,t){let i=false;if(ie<=se){if(!Q(e)){e.n|=ne;i=!Y(e)}}else i=!e.has(re);if(i){e.add(re);re.deps.push(e)}}function ge(e,t,i,n,s,r){const o=te.get(e);if(!o)return;let l=[];if("clear"===t)l=[...o.values()];else if("length"===i&&b(e))o.forEach(((e,t)=>{if("length"===t||t>=n)l.push(e)}));else{if(void 0!==i)l.push(o.get(i));switch(t){case"add":if(!b(e)){l.push(o.get(oe));if(x(e))l.push(o.get(le))}else if(_(i))l.push(o.get("length"));break;case"delete":if(!b(e)){l.push(o.get(oe));if(x(e))l.push(o.get(le))}break;case"set":if(x(e))l.push(o.get(oe));break}}if(1===l.length){if(l[0])ve(l[0])}else{const e=[];for(const t of l)if(t)e.push(...t);ve(X(e))}}function ve(e,t){for(const i of b(e)?e:[...e])if(i!==re||i.allowRecurse)if(i.scheduler)i.scheduler();else i.run()}const we=e(`__proto__,__v_isRef,__isVue`);const ye=new Set(Object.getOwnPropertyNames(Symbol).map((e=>Symbol[e])).filter(A));const be=Ae();const xe=Ae(false,true);const ke=Ae(true);const Se=Ce();function Ce(){const e={};["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const i=gt(this);for(let t=0,s=this.length;t<s;t++)pe(i,"get",t+"");const n=i[t](...e);if(-1===n||false===n)return i[t](...e.map(gt));else return n}}));["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){ue();const i=gt(this)[t].apply(this,e);de();return i}}));return e}function Ae(e=false,t=false){return function i(n,s,r){if("__v_isReactive"===s)return!e;else if("__v_isReadonly"===s)return e;else if("__v_isShallow"===s)return t;else if("__v_raw"===s&&r===(e?t?rt:st:t?nt:it).get(n))return n;const o=b(n);if(!e&&o&&y(Se,s))return Reflect.get(Se,s,r);const l=Reflect.get(n,s,r);if(A(s)?ye.has(s):we(s))return l;if(!e)pe(n,"get",s);if(t)return l;if(kt(l)){const e=!o||!_(s);return e?l.value:l}if(M(l))return e?ct(l):at(l);return l}}const Me=De();const Oe=De(true);function De(e=false){return function t(i,n,s,r){let o=i[n];if(dt(o)&&kt(o)&&!kt(s))return false;if(!e&&!dt(s)){if(!pt(s)){s=gt(s);o=gt(o)}if(!b(i)&&kt(o)&&!kt(s)){o.value=s;return true}}const l=b(i)&&_(n)?Number(n)<i.length:y(i,n);const a=Reflect.set(i,n,s,r);if(i===gt(r))if(!l)ge(i,"add",n,s);else if(W(s,o))ge(i,"set",n,s);return a}}function Te(e,t){const i=y(e,t);e[t];const n=Reflect.deleteProperty(e,t);if(n&&i)ge(e,"delete",t,void 0);return n}function Ee(e,t){const i=Reflect.has(e,t);if(!A(t)||!ye.has(t))pe(e,"has",t);return i}function Re(e){pe(e,"iterate",b(e)?"length":oe);return Reflect.ownKeys(e)}const _e={get:be,set:Me,deleteProperty:Te,has:Ee,ownKeys:Re};const Be={get:ke,set(e,t){return true},deleteProperty(e,t){return true}};const Le=g({},_e,{get:xe,set:Oe});const Pe=e=>e;const Ne=e=>Reflect.getPrototypeOf(e);function Ie(e,t,i=false,n=false){e=e["__v_raw"];const s=gt(e);const r=gt(t);if(t!==r)!i&&pe(s,"get",t);!i&&pe(s,"get",r);const{has:o}=Ne(s);const l=n?Pe:i?yt:wt;if(o.call(s,t))return l(e.get(t));else if(o.call(s,r))return l(e.get(r));else if(e!==s)e.get(t)}function Ve(e,t=false){const i=this["__v_raw"];const n=gt(i);const s=gt(e);if(e!==s)!t&&pe(n,"has",e);!t&&pe(n,"has",s);return e===s?i.has(e):i.has(e)||i.has(s)}function Fe(e,t=false){e=e["__v_raw"];!t&&pe(gt(e),"iterate",oe);return Reflect.get(e,"size",e)}function He(e){e=gt(e);const t=gt(this);const i=Ne(t);const n=i.has.call(t,e);if(!n){t.add(e);ge(t,"add",e,e)}return this}function We(e,t){t=gt(t);const i=gt(this);const{has:n,get:s}=Ne(i);let r=n.call(i,e);if(!r){e=gt(e);r=n.call(i,e)}const o=s.call(i,e);i.set(e,t);if(!r)ge(i,"add",e,t);else if(W(t,o))ge(i,"set",e,t);return this}function ze(e){const t=gt(this);const{has:i,get:n}=Ne(t);let s=i.call(t,e);if(!s){e=gt(e);s=i.call(t,e)}n?n.call(t,e):void 0;const r=t.delete(e);if(s)ge(t,"delete",e,void 0);return r}function qe(){const e=gt(this);const t=0!==e.size;const i=e.clear();if(t)ge(e,"clear",void 0,void 0);return i}function je(e,t){return function i(n,s){const r=this;const o=r["__v_raw"];const l=gt(o);const a=t?Pe:e?yt:wt;!e&&pe(l,"iterate",oe);return o.forEach(((e,t)=>n.call(s,a(e),a(t),r)))}}function $e(e,t,i){return function(...n){const s=this["__v_raw"];const r=gt(s);const o=x(r);const l="entries"===e||e===Symbol.iterator&&o;const a="keys"===e&&o;const h=s[e](...n);const c=i?Pe:t?yt:wt;!t&&pe(r,"iterate",a?le:oe);return{next(){const{value:e,done:t}=h.next();return t?{value:e,done:t}:{value:l?[c(e[0]),c(e[1])]:c(e),done:t}},[Symbol.iterator](){return this}}}}function Ue(e){return function(...t){return"delete"===e?false:this}}function Ke(){const e={get(e){return Ie(this,e)},get size(){return Fe(this)},has:Ve,add:He,set:We,delete:ze,clear:qe,forEach:je(false,false)};const t={get(e){return Ie(this,e,false,true)},get size(){return Fe(this)},has:Ve,add:He,set:We,delete:ze,clear:qe,forEach:je(false,true)};const i={get(e){return Ie(this,e,true)},get size(){return Fe(this,true)},has(e){return Ve.call(this,e,true)},add:Ue("add"),set:Ue("set"),delete:Ue("delete"),clear:Ue("clear"),forEach:je(true,false)};const n={get(e){return Ie(this,e,true,true)},get size(){return Fe(this,true)},has(e){return Ve.call(this,e,true)},add:Ue("add"),set:Ue("set"),delete:Ue("delete"),clear:Ue("clear"),forEach:je(true,true)};const s=["keys","values","entries",Symbol.iterator];s.forEach((s=>{e[s]=$e(s,false,false);i[s]=$e(s,true,false);t[s]=$e(s,false,true);n[s]=$e(s,true,true)}));return[e,i,t,n]}const[Ge,Je,Xe,Ye]=Ke();function Qe(e,t){const i=t?e?Ye:Xe:e?Je:Ge;return(t,n,s)=>{if("__v_isReactive"===n)return!e;else if("__v_isReadonly"===n)return e;else if("__v_raw"===n)return t;return Reflect.get(y(i,n)&&n in t?i:t,n,s)}}const Ze={get:Qe(false,false)};const et={get:Qe(false,true)};const tt={get:Qe(true,false)};const it=new WeakMap;const nt=new WeakMap;const st=new WeakMap;const rt=new WeakMap;function ot(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function lt(e){return e["__v_skip"]||!Object.isExtensible(e)?0:ot(E(e))}function at(e){if(dt(e))return e;return ft(e,false,_e,Ze,it)}function ht(e){return ft(e,false,Le,et,nt)}function ct(e){return ft(e,true,Be,tt,st)}function ft(e,t,i,n,s){if(!M(e))return e;if(e["__v_raw"]&&!(t&&e["__v_isReactive"]))return e;const r=s.get(e);if(r)return r;const o=lt(e);if(0===o)return e;const l=new Proxy(e,2===o?n:i);s.set(e,l);return l}function ut(e){if(dt(e))return ut(e["__v_raw"]);return!!(e&&e["__v_isReactive"])}function dt(e){return!!(e&&e["__v_isReadonly"])}function pt(e){return!!(e&&e["__v_isShallow"])}function mt(e){return ut(e)||dt(e)}function gt(e){const t=e&&e["__v_raw"];return t?gt(t):e}function vt(e){q(e,"__v_skip",true);return e}const wt=e=>M(e)?at(e):e;const yt=e=>M(e)?ct(e):e;function bt(e){if(ce&&re){e=gt(e);me(e.dep||(e.dep=X()))}}function xt(e,t){e=gt(e);if(e.dep)ve(e.dep)}function kt(e){return!!(e&&true===e.__v_isRef)}function St(e){return Ct(e,false)}function Ct(e,t){if(kt(e))return e;return new At(e,t)}class At{constructor(e,t){this.__v_isShallow=t;this.dep=void 0;this.__v_isRef=true;this._rawValue=t?e:gt(e);this._value=t?e:wt(e)}get value(){bt(this);return this._value}set value(e){e=this.__v_isShallow?e:gt(e);if(W(e,this._rawValue)){this._rawValue=e;this._value=this.__v_isShallow?e:wt(e);xt(this)}}}function Mt(e){return kt(e)?e.value:e}const Ot={get:(e,t,i)=>Mt(Reflect.get(e,t,i)),set:(e,t,i,n)=>{const s=e[t];if(kt(s)&&!kt(i)){s.value=i;return true}else return Reflect.set(e,t,i,n)}};function Dt(e){return ut(e)?e:new Proxy(e,Ot)}class Tt{constructor(e,t,i,n){this._setter=t;this.dep=void 0;this.__v_isRef=true;this._dirty=true;this.effect=new ae(e,(()=>{if(!this._dirty){this._dirty=true;xt(this)}}));this.effect.computed=this;this.effect.active=this._cacheable=!n;this["__v_isReadonly"]=i}get value(){const e=gt(this);bt(e);if(e._dirty||!e._cacheable){e._dirty=false;e._value=e.effect.run()}return e._value}set value(e){this._setter(e)}}function Et(e,t,i=false){let n;let s;const r=S(e);if(r){n=e;s=f}else{n=e.get;s=e.set}const o=new Tt(n,s,r||!s,i);return o}Promise.resolve();function Rt(e,t,i,n){let s;try{s=n?e(...n):e()}catch(r){Bt(r,t,i)}return s}function _t(e,t,i,n){if(S(e)){const s=Rt(e,t,i,n);if(s&&O(s))s.catch((e=>{Bt(e,t,i)}));return s}const s=[];for(let r=0;r<e.length;r++)s.push(_t(e[r],t,i,n));return s}function Bt(e,t,i,n=true){const s=t?t.vnode:null;if(t){let n=t.parent;const s=t.proxy;const r=i;while(n){const t=n.ec;if(t)for(let i=0;i<t.length;i++)if(false===t[i](e,s,r))return;n=n.parent}const o=t.appContext.config.errorHandler;if(o){Rt(o,null,10,[e,s,r]);return}}Lt(e,i,s,n)}function Lt(e,t,i,n=true){void 0}let Pt=false;let Nt=false;const It=[];let Vt=0;const Ft=[];let Ht=null;let Wt=0;const zt=[];let qt=null;let jt=0;const $t=Promise.resolve();let Ut=null;let Kt=null;function Gt(e){const t=Ut||$t;return e?t.then(this?e.bind(this):e):t}function Jt(e){let t=Vt+1;let i=It.length;while(t<i){const n=t+i>>>1;const s=si(It[n]);s<e?t=n+1:i=n}return t}function Xt(e){if((!It.length||!It.includes(e,Pt&&e.allowRecurse?Vt+1:Vt))&&e!==Kt){if(null==e.id)It.push(e);else It.splice(Jt(e.id),0,e);Yt()}}function Yt(){if(!Pt&&!Nt){Nt=true;Ut=$t.then(ri)}}function Qt(e){const t=It.indexOf(e);if(t>Vt)It.splice(t,1)}function Zt(e,t,i,n){if(!b(e)){if(!t||!t.includes(e,e.allowRecurse?n+1:n))i.push(e)}else i.push(...e);Yt()}function ei(e){Zt(e,Ht,Ft,Wt)}function ti(e){Zt(e,qt,zt,jt)}function ii(e,t=null){if(Ft.length){Kt=t;Ht=[...new Set(Ft)];Ft.length=0;for(Wt=0;Wt<Ht.length;Wt++)Ht[Wt]();Ht=null;Wt=0;Kt=null;ii(e,t)}}function ni(e){if(zt.length){const e=[...new Set(zt)];zt.length=0;if(qt){qt.push(...e);return}qt=e;qt.sort(((e,t)=>si(e)-si(t)));for(jt=0;jt<qt.length;jt++)qt[jt]();qt=null;jt=0}}const si=e=>null==e.id?1/0:e.id;function ri(e){Nt=false;Pt=true;ii(e);It.sort(((e,t)=>si(e)-si(t)));const t=f;try{for(Vt=0;Vt<It.length;Vt++){const e=It[Vt];if(e&&false!==e.active){if(false);Rt(e,null,14)}}}finally{Vt=0;It.length=0;ni();Pt=false;Ut=null;if(It.length||Ft.length||zt.length)ri(e)}}function oi(e,t,...i){const n=e.vnode.props||h;let s=i;const r=t.startsWith("update:");const o=r&&t.slice(7);if(o&&o in n){const e=`${"modelValue"===o?"model":o}Modifiers`;const{number:t,trim:r}=n[e]||h;if(r)s=i.map((e=>e.trim()));else if(t)s=i.map(j)}let l;let a=n[l=H(t)]||n[l=H(N(t))];if(!a&&r)a=n[l=H(V(t))];if(a)_t(a,e,6,s);const c=n[l+`Once`];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=true;_t(c,e,6,s)}}function li(e,t,i=false){const n=t.emitsCache;const s=n.get(e);if(void 0!==s)return s;const r=e.emits;let o={};let l=false;if(!S(e)){const n=e=>{const i=li(e,t,true);if(i){l=true;g(o,i)}};if(!i&&t.mixins.length)t.mixins.forEach(n);if(e.extends)n(e.extends);if(e.mixins)e.mixins.forEach(n)}if(!r&&!l){n.set(e,null);return null}if(b(r))r.forEach((e=>o[e]=null));else g(o,r);n.set(e,o);return o}function ai(e,t){if(!e||!p(t))return false;t=t.slice(2).replace(/Once$/,"");return y(e,t[0].toLowerCase()+t.slice(1))||y(e,V(t))||y(e,t)}let hi=null;let ci=null;function fi(e){const t=hi;hi=e;ci=e&&e.type.__scopeId||null;return t}function ui(e,t=hi,i){if(!t)return e;if(e._n)return e;const n=(...i)=>{if(n._d)ss(-1);const s=fi(t);const r=e(...i);fi(s);if(n._d)ss(1);return r};n._n=true;n._c=true;n._d=true;return n}function di(){}function pi(e){const{type:t,vnode:i,proxy:n,withProxy:s,props:r,propsOptions:[o],slots:l,attrs:a,emit:h,render:c,renderCache:f,data:u,setupState:d,ctx:p,inheritAttrs:g}=e;let v;let w;const y=fi(e);try{if(4&i.shapeFlag){const e=s||n;v=ws(c.call(e,e,f,r,d,u,p));w=a}else{const e=t;if(false);v=ws(e.length>1?e(r,false?{get attrs(){di();return a},slots:l,emit:h}:{attrs:a,slots:l,emit:h}):e(r,null));w=t.props?a:mi(a)}}catch(x){Zn.length=0;Bt(x,e,1);v=ds(Yn)}let b=v;if(w&&false!==g){const e=Object.keys(w);const{shapeFlag:t}=b;if(e.length)if(t&(1|6)){if(o&&e.some(m))w=gi(w,o);b=gs(b,w)}}if(i.dirs)b.dirs=b.dirs?b.dirs.concat(i.dirs):i.dirs;if(i.transition)b.transition=i.transition;v=b;fi(y);return v}const mi=e=>{let t;for(const i in e)if("class"===i||"style"===i||p(i))(t||(t={}))[i]=e[i];return t};const gi=(e,t)=>{const i={};for(const n in e)if(!m(n)||!(n.slice(9)in t))i[n]=e[n];return i};function vi(e,t,i){const{props:n,children:s,component:r}=e;const{props:o,children:l,patchFlag:a}=t;const h=r.emitsOptions;if(t.dirs||t.transition)return true;if(i&&a>=0){if(1024&a)return true;if(16&a){if(!n)return!!o;return wi(n,o,h)}else if(8&a){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const i=e[t];if(o[i]!==n[i]&&!ai(h,i))return true}}}else{if(s||l)if(!l||!l.$stable)return true;if(n===o)return false;if(!n)return!!o;if(!o)return true;return wi(n,o,h)}return false}function wi(e,t,i){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return true;for(let s=0;s<n.length;s++){const r=n[s];if(t[r]!==e[r]&&!ai(i,r))return true}return false}function yi({vnode:e,parent:t},i){while(t&&t.subTree===e){(e=t.vnode).el=i;t=t.parent}}const bi=e=>e.__isSuspense;function xi(e,t){if(t&&t.pendingBranch)if(b(e))t.effects.push(...e);else t.effects.push(e);else ti(e)}function ki(e,t){if(!Rs);else{let i=Rs.provides;const n=Rs.parent&&Rs.parent.provides;if(n===i)i=Rs.provides=Object.create(n);i[e]=t}}function Si(e,t,i=false){const n=Rs||hi;if(n){const s=null==n.parent?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(s&&e in s)return s[e];else if(arguments.length>1)return i&&S(t)?t.call(n.proxy):t}}const Ci={};function Ai(e,t,i){return Mi(e,t,i)}function Mi(e,t,{immediate:i,deep:n,flush:s,onTrack:r,onTrigger:o}=h){const l=Rs;let a;let c=false;let u=false;if(kt(e)){a=()=>e.value;c=pt(e)}else if(ut(e)){a=()=>e;n=true}else if(b(e)){u=true;c=e.some(ut);a=()=>e.map((e=>{if(kt(e))return e.value;else if(ut(e))return Ti(e);else if(S(e))return Rt(e,l,2)}))}else if(S(e))if(t)a=()=>Rt(e,l,2);else a=()=>{if(l&&l.isUnmounted)return;if(d)d();return _t(e,l,3,[p])};else a=f;if(t&&n){const e=a;a=()=>Ti(e())}let d;let p=e=>{d=y.onStop=()=>{Rt(e,l,4)}};if(Ns){p=f;if(!t)a();else if(i)_t(t,l,3,[a(),u?[]:void 0,p]);return f}let m=u?[]:Ci;const g=()=>{if(!y.active)return;if(t){const e=y.run();if(n||c||(u?e.some(((e,t)=>W(e,m[t]))):W(e,m))||false){if(d)d();_t(t,l,3,[e,m===Ci?void 0:m,p]);m=e}}else y.run()};g.allowRecurse=!!t;let w;if("sync"===s)w=g;else if("post"===s)w=()=>Wn(g,l&&l.suspense);else w=()=>{if(!l||l.isMounted)ei(g);else g()};const y=new ae(a,w);if(t)if(i)g();else m=y.run();else if("post"===s)Wn(y.run.bind(y),l&&l.suspense);else y.run();return()=>{y.stop();if(l&&l.scope)v(l.scope.effects,y)}}function Oi(e,t,i){const n=this.proxy;const s=C(e)?e.includes(".")?Di(n,e):()=>n[e]:e.bind(n,n);let r;if(S(t))r=t;else{r=t.handler;i=t}const o=Rs;Bs(this);const l=Mi(s,r.bind(n),i);if(o)Bs(o);else Ls();return l}function Di(e,t){const i=t.split(".");return()=>{let t=e;for(let e=0;e<i.length&&t;e++)t=t[i[e]];return t}}function Ti(e,t){if(!M(e)||e["__v_skip"])return e;t=t||new Set;if(t.has(e))return e;t.add(e);if(kt(e))Ti(e.value,t);else if(b(e))for(let i=0;i<e.length;i++)Ti(e[i],t);else if(k(e)||x(e))e.forEach((e=>{Ti(e,t)}));else if(R(e))for(const i in e)Ti(e[i],t);return e}function Ei(){const e={isMounted:false,isLeaving:false,isUnmounting:false,leavingVNodes:new Map};Xi((()=>{e.isMounted=true}));Zi((()=>{e.isUnmounting=true}));return e}const Ri=[Function,Array];const _i={name:`BaseTransition`,props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ri,onEnter:Ri,onAfterEnter:Ri,onEnterCancelled:Ri,onBeforeLeave:Ri,onLeave:Ri,onAfterLeave:Ri,onLeaveCancelled:Ri,onBeforeAppear:Ri,onAppear:Ri,onAfterAppear:Ri,onAppearCancelled:Ri},setup(e,{slots:t}){const i=_s();const n=Ei();let s;return()=>{const r=t.default&&Fi(t.default(),true);if(!r||!r.length)return;const o=gt(e);const{mode:l}=o;const a=r[0];if(n.isLeaving)return Ni(a);const h=Ii(a);if(!h)return Ni(a);const c=Pi(h,o,n,i);Vi(h,c);const f=i.subTree;const u=f&&Ii(f);let d=false;const{getTransitionKey:p}=h.type;if(p){const e=p();if(void 0===s)s=e;else if(e!==s){s=e;d=true}}if(u&&u.type!==Yn&&(!as(h,u)||d)){const e=Pi(u,o,n,i);Vi(u,e);if("out-in"===l){n.isLeaving=true;e.afterLeave=()=>{n.isLeaving=false;i.update()};return Ni(a)}else if("in-out"===l&&h.type!==Yn)e.delayLeave=(e,t,i)=>{const s=Li(n,u);s[String(u.key)]=u;e._leaveCb=()=>{t();e._leaveCb=void 0;delete c.delayedLeave};c.delayedLeave=i}}return a}}};const Bi=_i;function Li(e,t){const{leavingVNodes:i}=e;let n=i.get(t.type);if(!n){n=Object.create(null);i.set(t.type,n)}return n}function Pi(e,t,i,n){const{appear:s,mode:r,persisted:o=false,onBeforeEnter:l,onEnter:a,onAfterEnter:h,onEnterCancelled:c,onBeforeLeave:f,onLeave:u,onAfterLeave:d,onLeaveCancelled:p,onBeforeAppear:m,onAppear:g,onAfterAppear:v,onAppearCancelled:w}=t;const y=String(e.key);const b=Li(i,e);const x=(e,t)=>{e&&_t(e,n,9,t)};const k={mode:r,persisted:o,beforeEnter(t){let n=l;if(!i.isMounted)if(s)n=m||l;else return;if(t._leaveCb)t._leaveCb(true);const r=b[y];if(r&&as(e,r)&&r.el._leaveCb)r.el._leaveCb();x(n,[t])},enter(e){let t=a;let n=h;let r=c;if(!i.isMounted)if(s){t=g||a;n=v||h;r=w||c}else return;let o=false;const l=e._enterCb=t=>{if(o)return;o=true;if(t)x(r,[e]);else x(n,[e]);if(k.delayedLeave)k.delayedLeave();e._enterCb=void 0};if(t){t(e,l);if(t.length<=1)l()}else l()},leave(t,n){const s=String(e.key);if(t._enterCb)t._enterCb(true);if(i.isUnmounting)return n();x(f,[t]);let r=false;const o=t._leaveCb=i=>{if(r)return;r=true;n();if(i)x(p,[t]);else x(d,[t]);t._leaveCb=void 0;if(b[s]===e)delete b[s]};b[s]=e;if(u){u(t,o);if(u.length<=1)o()}else o()},clone(e){return Pi(e,t,i,n)}};return k}function Ni(e){if(zi(e)){e=gs(e);e.children=null;return e}}function Ii(e){return zi(e)?e.children?e.children[0]:void 0:e}function Vi(e,t){if(6&e.shapeFlag&&e.component)Vi(e.component.subTree,t);else if(128&e.shapeFlag){e.ssContent.transition=t.clone(e.ssContent);e.ssFallback.transition=t.clone(e.ssFallback)}else e.transition=t}function Fi(e,t=false){let i=[];let n=0;for(let s=0;s<e.length;s++){const r=e[s];if(r.type===Jn){if(128&r.patchFlag)n++;i=i.concat(Fi(r.children,t))}else if(t||r.type!==Yn)i.push(r)}if(n>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function Hi(e){return S(e)?{setup:e,name:e.name}:e}const Wi=e=>!!e.type.__asyncLoader;const zi=e=>e.type.__isKeepAlive;function qi(e,t){$i(e,"a",t)}function ji(e,t){$i(e,"da",t)}function $i(e,t,i=Rs){const n=e.__wdc||(e.__wdc=()=>{let t=i;while(t){if(t.isDeactivated)return;t=t.parent}return e()});Ki(t,n,i);if(i){let e=i.parent;while(e&&e.parent){if(zi(e.parent.vnode))Ui(n,t,i,e);e=e.parent}}}function Ui(e,t,i,n){const s=Ki(t,e,n,true);en((()=>{v(n[t],s)}),i)}function Ki(e,t,i=Rs,n=false){if(i){const s=i[e]||(i[e]=[]);const r=t.__weh||(t.__weh=(...n)=>{if(i.isUnmounted)return;ue();Bs(i);const s=_t(t,i,e,n);Ls();de();return s});if(n)s.unshift(r);else s.push(r);return r}}const Gi=e=>(t,i=Rs)=>(!Ns||"sp"===e)&&Ki(e,t,i);const Ji=Gi("bm");const Xi=Gi("m");const Yi=Gi("bu");const Qi=Gi("u");const Zi=Gi("bum");const en=Gi("um");const tn=Gi("sp");const nn=Gi("rtg");const sn=Gi("rtc");function rn(e,t=Rs){Ki("ec",e,t)}let on=true;function ln(e){const t=fn(e);const i=e.proxy;const n=e.ctx;on=false;if(t.beforeCreate)hn(t.beforeCreate,e,"bc");const{data:s,computed:r,methods:o,watch:l,provide:a,inject:h,created:c,beforeMount:u,mounted:d,beforeUpdate:p,updated:m,activated:g,deactivated:v,beforeDestroy:w,beforeUnmount:y,destroyed:x,unmounted:k,render:C,renderTracked:A,renderTriggered:O,errorCaptured:D,serverPrefetch:T,expose:E,inheritAttrs:R,components:_,directives:B,filters:L}=t;const P=null;if(h)an(h,n,P,e.appContext.config.unwrapInjectedRef);if(o)for(const f in o){const e=o[f];if(S(e))n[f]=e.bind(i)}if(s){const t=s.call(i,i);if(!M(t));else e.data=at(t)}on=true;if(r)for(const b in r){const e=r[b];const t=S(e)?e.bind(i,i):S(e.get)?e.get.bind(i,i):f;const s=!S(e)&&S(e.set)?e.set.bind(i):f;const o=Us({get:t,set:s});Object.defineProperty(n,b,{enumerable:true,configurable:true,get:()=>o.value,set:e=>o.value=e})}if(l)for(const f in l)cn(l[f],n,i,f);if(a){const e=S(a)?a.call(i):a;Reflect.ownKeys(e).forEach((t=>{ki(t,e[t])}))}if(c)hn(c,e,"c");function N(e,t){if(b(t))t.forEach((t=>e(t.bind(i))));else if(t)e(t.bind(i))}N(Ji,u);N(Xi,d);N(Yi,p);N(Qi,m);N(qi,g);N(ji,v);N(rn,D);N(sn,A);N(nn,O);N(Zi,y);N(en,k);N(tn,T);if(b(E))if(E.length){const t=e.exposed||(e.exposed={});E.forEach((e=>{Object.defineProperty(t,e,{get:()=>i[e],set:t=>i[e]=t})}))}else if(!e.exposed)e.exposed={};if(C&&e.render===f)e.render=C;if(null!=R)e.inheritAttrs=R;if(_)e.components=_;if(B)e.directives=B}function an(e,t,i=f,n=false){if(b(e))e=gn(e);for(const s in e){const i=e[s];let r;if(M(i))if("default"in i)r=Si(i.from||s,i.default,true);else r=Si(i.from||s);else r=Si(i);if(kt(r))if(n)Object.defineProperty(t,s,{enumerable:true,configurable:true,get:()=>r.value,set:e=>r.value=e});else t[s]=r;else t[s]=r}}function hn(e,t,i){_t(b(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,i)}function cn(e,t,i,n){const s=n.includes(".")?Di(i,n):()=>i[n];if(C(e)){const i=t[e];if(S(i))Ai(s,i)}else if(S(e))Ai(s,e.bind(i));else if(M(e))if(b(e))e.forEach((e=>cn(e,t,i,n)));else{const n=S(e.handler)?e.handler.bind(i):t[e.handler];if(S(n))Ai(s,n,e)}}function fn(e){const t=e.type;const{mixins:i,extends:n}=t;const{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=e.appContext;const l=r.get(t);let a;if(l)a=l;else if(!s.length&&!i&&!n)a=t;else{a={};if(s.length)s.forEach((e=>un(a,e,o,true)));un(a,t,o)}r.set(t,a);return a}function un(e,t,i,n=false){const{mixins:s,extends:r}=t;if(r)un(e,r,i,true);if(s)s.forEach((t=>un(e,t,i,true)));for(const o in t)if(n&&"expose"===o);else{const n=dn[o]||i&&i[o];e[o]=n?n(e[o],t[o]):t[o]}return e}const dn={data:pn,props:wn,emits:wn,methods:wn,computed:wn,beforeCreate:vn,created:vn,beforeMount:vn,mounted:vn,beforeUpdate:vn,updated:vn,beforeDestroy:vn,beforeUnmount:vn,destroyed:vn,unmounted:vn,activated:vn,deactivated:vn,errorCaptured:vn,serverPrefetch:vn,components:wn,directives:wn,watch:yn,provide:pn,inject:mn};function pn(e,t){if(!t)return e;if(!e)return t;return function i(){return g(S(e)?e.call(this,this):e,S(t)?t.call(this,this):t)}}function mn(e,t){return wn(gn(e),gn(t))}function gn(e){if(b(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function vn(e,t){return e?[...new Set([].concat(e,t))]:t}function wn(e,t){return e?g(g(Object.create(null),e),t):t}function yn(e,t){if(!e)return t;if(!t)return e;const i=g(Object.create(null),e);for(const n in t)i[n]=vn(e[n],t[n]);return i}function bn(e,t,i,n=false){const s={};const r={};q(r,hs,1);e.propsDefaults=Object.create(null);kn(e,t,s,r);for(const o in e.propsOptions[0])if(!(o in s))s[o]=void 0;if(i)e.props=n?s:ht(s);else if(!e.type.props)e.props=r;else e.props=s;e.attrs=r}function xn(e,t,i,n){const{props:s,attrs:r,vnode:{patchFlag:o}}=e;const l=gt(s);const[a]=e.propsOptions;let h=false;if((n||o>0)&&!(16&o)){if(8&o){const i=e.vnode.dynamicProps;for(let n=0;n<i.length;n++){let o=i[n];const c=t[o];if(a)if(y(r,o)){if(c!==r[o]){r[o]=c;h=true}}else{const t=N(o);s[t]=Sn(a,l,t,c,e,false)}else if(c!==r[o]){r[o]=c;h=true}}}}else{if(kn(e,t,s,r))h=true;let n;for(const r in l)if(!t||!y(t,r)&&((n=V(r))===r||!y(t,n)))if(a){if(i&&(void 0!==i[r]||void 0!==i[n]))s[r]=Sn(a,l,r,void 0,e,true)}else delete s[r];if(r!==l)for(const e in r)if(!t||!y(t,e)&&true){delete r[e];h=true}}if(h)ge(e,"set","$attrs")}function kn(e,t,i,n){const[s,r]=e.propsOptions;let o=false;let l;if(t)for(let a in t){if(B(a))continue;const h=t[a];let c;if(s&&y(s,c=N(a)))if(!r||!r.includes(c))i[c]=h;else(l||(l={}))[c]=h;else if(!ai(e.emitsOptions,a))if(!(a in n)||h!==n[a]){n[a]=h;o=true}}if(r){const t=gt(i);const n=l||h;for(let o=0;o<r.length;o++){const l=r[o];i[l]=Sn(s,t,l,n[l],e,!y(n,l))}}return o}function Sn(e,t,i,n,s,r){const o=e[i];if(null!=o){const e=y(o,"default");if(e&&void 0===n){const e=o.default;if(o.type!==Function&&S(e)){const{propsDefaults:r}=s;if(i in r)n=r[i];else{Bs(s);n=r[i]=e.call(null,t);Ls()}}else n=e}if(o[0])if(r&&!e)n=false;else if(o[1]&&(""===n||n===V(i)))n=true}return n}function Cn(e,t,i=false){const n=t.propsCache;const s=n.get(e);if(s)return s;const r=e.props;const o={};const l=[];let a=false;if(!S(e)){const n=e=>{a=true;const[i,n]=Cn(e,t,true);g(o,i);if(n)l.push(...n)};if(!i&&t.mixins.length)t.mixins.forEach(n);if(e.extends)n(e.extends);if(e.mixins)e.mixins.forEach(n)}if(!r&&!a){n.set(e,c);return c}if(b(r))for(let c=0;c<r.length;c++){const e=N(r[c]);if(An(e))o[e]=h}else if(r)for(const h in r){const e=N(h);if(An(e)){const t=r[h];const i=o[e]=b(t)||S(t)?{type:t}:t;if(i){const t=Dn(Boolean,i.type);const n=Dn(String,i.type);i[0]=t>-1;i[1]=n<0||t<n;if(t>-1||y(i,"default"))l.push(e)}}}const f=[o,l];n.set(e,f);return f}function An(e){if("$"!==e[0])return true;return false}function Mn(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function On(e,t){return Mn(e)===Mn(t)}function Dn(e,t){if(b(t))return t.findIndex((t=>On(t,e)));else if(S(t))return On(t,e)?0:-1;return-1}const Tn=e=>"_"===e[0]||"$stable"===e;const En=e=>b(e)?e.map(ws):[ws(e)];const Rn=(e,t,i)=>{const n=ui(((...e)=>En(t(...e))),i);n._c=false;return n};const _n=(e,t,i)=>{const n=e._ctx;for(const s in e){if(Tn(s))continue;const i=e[s];if(S(i))t[s]=Rn(s,i,n);else if(null!=i){const e=En(i);t[s]=()=>e}}};const Bn=(e,t)=>{const i=En(t);e.slots.default=()=>i};const Ln=(e,t)=>{if(32&e.vnode.shapeFlag){const i=t._;if(i){e.slots=gt(t);q(t,"_",i)}else _n(t,e.slots={})}else{e.slots={};if(t)Bn(e,t)}q(e.slots,hs,1)};const Pn=(e,t,i)=>{const{vnode:n,slots:s}=e;let r=true;let o=h;if(32&n.shapeFlag){const e=t._;if(e)if(i&&1===e)r=false;else{g(s,t);if(!i&&1===e)delete s._}else{r=!t.$stable;_n(t,s)}o=t}else if(t){Bn(e,t);o={default:1}}if(r)for(const l in s)if(!Tn(l)&&!(l in o))delete s[l]};function Nn(e,t,i,n){const s=e.dirs;const r=t&&t.dirs;for(let o=0;o<s.length;o++){const l=s[o];if(r)l.oldValue=r[o].value;let a=l.dir[n];if(a){ue();_t(a,i,8,[e.el,l,e,t]);de()}}}function In(){return{app:null,config:{isNativeTag:u,performance:false,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Vn=0;function Fn(e,t){return function i(n,s=null){if(null!=s&&!M(s))s=null;const r=In();const o=new Set;let l=false;const a=r.app={_uid:Vn++,_component:n,_props:s,_container:null,_context:r,_instance:null,version:Ks,get config(){return r.config},set config(e){},use(e,...t){if(o.has(e));else if(e&&S(e.install)){o.add(e);e.install(a,...t)}else if(S(e)){o.add(e);e(a,...t)}return a},mixin(e){if(!r.mixins.includes(e))r.mixins.push(e);return a},component(e,t){if(!t)return r.components[e];r.components[e]=t;return a},directive(e,t){if(!t)return r.directives[e];r.directives[e]=t;return a},mount(i,o,h){if(!l){const c=ds(n,s);c.appContext=r;if(o&&t)t(c,i);else e(c,i,h);l=true;a._container=i;i.__vue_app__=a;return js(c.component)||c.component.proxy}},unmount(){if(l){e(null,a._container);delete a._container.__vue_app__}},provide(e,t){r.provides[e]=t;return a}};return a}}function Hn(e,t,i,n,s=false){if(b(e)){e.forEach(((e,r)=>Hn(e,t&&(b(t)?t[r]:t),i,n,s)));return}if(Wi(n)&&!s)return;const r=4&n.shapeFlag?js(n.component)||n.component.proxy:n.el;const o=s?null:r;const{i:l,r:a}=e;const c=t&&t.r;const f=l.refs===h?l.refs={}:l.refs;const u=l.setupState;if(null!=c&&c!==a)if(C(c)){f[c]=null;if(y(u,c))u[c]=null}else if(kt(c))c.value=null;if(S(a))Rt(a,l,12,[o,f]);else{const t=C(a);const n=kt(a);if(t||n){const n=()=>{if(e.f){const i=t?f[a]:a.value;if(s)b(i)&&v(i,r);else if(!b(i))if(t)f[a]=[r];else{a.value=[r];if(e.k)f[e.k]=a.value}else if(!i.includes(r))i.push(r)}else if(t){f[a]=o;if(y(u,a))u[a]=o}else if(kt(a)){a.value=o;if(e.k)f[e.k]=o}};if(o){n.id=-1;Wn(n,i)}else n()}}}const Wn=xi;function zn(e){return qn(e)}function qn(e,t){const i=U();i.__VUE__=true;const{insert:n,remove:s,patchProp:r,createElement:o,createText:l,createComment:a,setText:u,setElementText:d,parentNode:p,nextSibling:m,setScopeId:g=f,cloneNode:v,insertStaticContent:w}=e;const y=(e,t,i,n=null,s=null,r=null,o=false,l=null,a=!!t.dynamicChildren)=>{if(e===t)return;if(e&&!as(e,t)){n=X(e);j(e,s,r,true);e=null}if(-2===t.patchFlag){a=false;t.dynamicChildren=null}const{type:h,ref:c,shapeFlag:f}=t;switch(h){case Xn:b(e,t,i,n);break;case Yn:x(e,t,i,n);break;case Qn:if(null==e)k(t,i,n,o);break;case Jn:_(e,t,i,n,s,r,o,l,a);break;default:if(1&f)A(e,t,i,n,s,r,o,l,a);else if(6&f)L(e,t,i,n,s,r,o,l,a);else if(64&f)h.process(e,t,i,n,s,r,o,l,a,Q);else if(128&f)h.process(e,t,i,n,s,r,o,l,a,Q)}if(null!=c&&s)Hn(c,e&&e.ref,r,t||e,!t)};const b=(e,t,i,s)=>{if(null==e)n(t.el=l(t.children),i,s);else{const i=t.el=e.el;if(t.children!==e.children)u(i,t.children)}};const x=(e,t,i,s)=>{if(null==e)n(t.el=a(t.children||""),i,s);else t.el=e.el};const k=(e,t,i,n)=>{[e.el,e.anchor]=w(e.children,t,i,n,e.el,e.anchor)};const S=({el:e,anchor:t},i,s)=>{let r;while(e&&e!==t){r=m(e);n(e,i,s);e=r}n(t,i,s)};const C=({el:e,anchor:t})=>{let i;while(e&&e!==t){i=m(e);s(e);e=i}s(t)};const A=(e,t,i,n,s,r,o,l,a)=>{o=o||"svg"===t.type;if(null==e)M(t,i,n,s,r,o,l,a);else T(e,t,s,r,o,l,a)};const M=(e,t,i,s,l,a,h,c)=>{let f;let u;const{type:p,props:m,shapeFlag:g,transition:w,patchFlag:y,dirs:b}=e;if(e.el&&void 0!==v&&-1===y)f=e.el=v(e.el);else{f=e.el=o(e.type,a,m&&m.is,m);if(8&g)d(f,e.children);else if(16&g)D(e.children,f,null,s,l,a&&"foreignObject"!==p,h,c);if(b)Nn(e,null,s,"created");if(m){for(const t in m)if("value"!==t&&!B(t))r(f,t,null,m[t],a,e.children,s,l,J);if("value"in m)r(f,"value",null,m.value);if(u=m.onVnodeBeforeMount)ks(u,s,e)}O(f,e,e.scopeId,h,s)}if(b)Nn(e,null,s,"beforeMount");const x=(!l||l&&!l.pendingBranch)&&w&&!w.persisted;if(x)w.beforeEnter(f);n(f,t,i);if((u=m&&m.onVnodeMounted)||x||b)Wn((()=>{u&&ks(u,s,e);x&&w.enter(f);b&&Nn(e,null,s,"mounted")}),l)};const O=(e,t,i,n,s)=>{if(i)g(e,i);if(n)for(let r=0;r<n.length;r++)g(e,n[r]);if(s){let i=s.subTree;if(t===i){const t=s.vnode;O(e,t,t.scopeId,t.slotScopeIds,s.parent)}}};const D=(e,t,i,n,s,r,o,l,a=0)=>{for(let h=a;h<e.length;h++){const a=e[h]=l?ys(e[h]):ws(e[h]);y(null,a,t,i,n,s,r,o,l)}};const T=(e,t,i,n,s,o,l)=>{const a=t.el=e.el;let{patchFlag:c,dynamicChildren:f,dirs:u}=t;c|=16&e.patchFlag;const p=e.props||h;const m=t.props||h;let g;i&&jn(i,false);if(g=m.onVnodeBeforeUpdate)ks(g,i,t,e);if(u)Nn(t,e,i,"beforeUpdate");i&&jn(i,true);const v=s&&"foreignObject"!==t.type;if(f)E(e.dynamicChildren,f,a,i,n,v,o);else if(!l)F(e,t,a,null,i,n,v,o,false);if(c>0){if(16&c)R(a,t,p,m,i,n,s);else{if(2&c)if(p.class!==m.class)r(a,"class",null,m.class,s);if(4&c)r(a,"style",p.style,m.style,s);if(8&c){const o=t.dynamicProps;for(let t=0;t<o.length;t++){const l=o[t];const h=p[l];const c=m[l];if(c!==h||"value"===l)r(a,l,h,c,s,e.children,i,n,J)}}}if(1&c)if(e.children!==t.children)d(a,t.children)}else if(!l&&null==f)R(a,t,p,m,i,n,s);if((g=m.onVnodeUpdated)||u)Wn((()=>{g&&ks(g,i,t,e);u&&Nn(t,e,i,"updated")}),n)};const E=(e,t,i,n,s,r,o)=>{for(let l=0;l<t.length;l++){const a=e[l];const h=t[l];const c=a.el&&(a.type===Jn||!as(a,h)||a.shapeFlag&(6|64))?p(a.el):i;y(a,h,c,null,n,s,r,o,true)}};const R=(e,t,i,n,s,o,l)=>{if(i!==n){for(const a in n){if(B(a))continue;const h=n[a];const c=i[a];if(h!==c&&"value"!==a)r(e,a,c,h,l,t.children,s,o,J)}if(i!==h)for(const a in i)if(!B(a)&&!(a in n))r(e,a,i[a],null,l,t.children,s,o,J);if("value"in n)r(e,"value",i.value,n.value)}};const _=(e,t,i,s,r,o,a,h,c)=>{const f=t.el=e?e.el:l("");const u=t.anchor=e?e.anchor:l("");let{patchFlag:d,dynamicChildren:p,slotScopeIds:m}=t;if(m)h=h?h.concat(m):m;if(null==e){n(f,i,s);n(u,i,s);D(t.children,i,u,r,o,a,h,c)}else if(d>0&&64&d&&p&&e.dynamicChildren){E(e.dynamicChildren,p,i,r,o,a,h);if(null!=t.key||r&&t===r.subTree)$n(e,t,true)}else F(e,t,i,u,r,o,a,h,c)};const L=(e,t,i,n,s,r,o,l,a)=>{t.slotScopeIds=l;if(null==e)if(512&t.shapeFlag)s.ctx.activate(t,i,n,o,a);else P(t,i,n,s,r,o,a);else N(e,t,a)};const P=(e,t,i,n,s,r,o)=>{const l=e.component=Es(e,n,s);if(zi(e))l.ctx.renderer=Q;Is(l);if(l.asyncDep){s&&s.registerDep(l,I);if(!e.el){const e=l.subTree=ds(Yn);x(null,e,t,i)}return}I(l,e,t,i,s,r,o)};const N=(e,t,i)=>{const n=t.component=e.component;if(vi(e,t,i))if(n.asyncDep&&!n.asyncResolved){V(n,t,i);return}else{n.next=t;Qt(n.update);n.update()}else{t.component=e.component;t.el=e.el;n.vnode=t}};const I=(e,t,i,n,s,r,o)=>{const l=()=>{if(!e.isMounted){let o;const{el:l,props:a}=t;const{bm:h,m:c,parent:f}=e;const u=Wi(t);jn(e,false);if(h)z(h);if(!u&&(o=a&&a.onVnodeBeforeMount))ks(o,f,t);jn(e,true);if(l&&ee){const i=()=>{e.subTree=pi(e);ee(l,e.subTree,e,s,null)};if(u)t.type.__asyncLoader().then((()=>!e.isUnmounted&&i()));else i()}else{const o=e.subTree=pi(e);y(null,o,i,n,e,s,r);t.el=o.el}if(c)Wn(c,s);if(!u&&(o=a&&a.onVnodeMounted)){const e=t;Wn((()=>ks(o,f,e)),s)}if(256&t.shapeFlag)e.a&&Wn(e.a,s);e.isMounted=true;t=i=n=null}else{let{next:t,bu:i,u:n,parent:l,vnode:a}=e;let h=t;let c;jn(e,false);if(t){t.el=a.el;V(e,t,o)}else t=a;if(i)z(i);if(c=t.props&&t.props.onVnodeBeforeUpdate)ks(c,l,t,a);jn(e,true);const f=pi(e);const u=e.subTree;e.subTree=f;y(u,f,p(u.el),X(u),e,s,r);t.el=f.el;if(null===h)yi(e,f.el);if(n)Wn(n,s);if(c=t.props&&t.props.onVnodeUpdated)Wn((()=>ks(c,l,t,a)),s)}};const a=e.effect=new ae(l,(()=>Xt(e.update)),e.scope);const h=e.update=a.run.bind(a);h.id=e.uid;jn(e,true);h()};const V=(e,t,i)=>{t.component=e;const n=e.vnode.props;e.vnode=t;e.next=null;xn(e,t.props,n,i);Pn(e,t.children,i);ue();ii(void 0,e.update);de()};const F=(e,t,i,n,s,r,o,l,a=false)=>{const h=e&&e.children;const c=e?e.shapeFlag:0;const f=t.children;const{patchFlag:u,shapeFlag:p}=t;if(u>0)if(128&u){W(h,f,i,n,s,r,o,l,a);return}else if(256&u){H(h,f,i,n,s,r,o,l,a);return}if(8&p){if(16&c)J(h,s,r);if(f!==h)d(i,f)}else if(16&c)if(16&p)W(h,f,i,n,s,r,o,l,a);else J(h,s,r,true);else{if(8&c)d(i,"");if(16&p)D(f,i,n,s,r,o,l,a)}};const H=(e,t,i,n,s,r,o,l,a)=>{e=e||c;t=t||c;const h=e.length;const f=t.length;const u=Math.min(h,f);let d;for(d=0;d<u;d++){const n=t[d]=a?ys(t[d]):ws(t[d]);y(e[d],n,i,null,s,r,o,l,a)}if(h>f)J(e,s,r,true,false,u);else D(t,i,n,s,r,o,l,a,u)};const W=(e,t,i,n,s,r,o,l,a)=>{let h=0;const f=t.length;let u=e.length-1;let d=f-1;while(h<=u&&h<=d){const n=e[h];const c=t[h]=a?ys(t[h]):ws(t[h]);if(as(n,c))y(n,c,i,null,s,r,o,l,a);else break;h++}while(h<=u&&h<=d){const n=e[u];const h=t[d]=a?ys(t[d]):ws(t[d]);if(as(n,h))y(n,h,i,null,s,r,o,l,a);else break;u--;d--}if(h>u){if(h<=d){const e=d+1;const c=e<f?t[e].el:n;while(h<=d){y(null,t[h]=a?ys(t[h]):ws(t[h]),i,c,s,r,o,l,a);h++}}}else if(h>d)while(h<=u){j(e[h],s,r,true);h++}else{const p=h;const m=h;const g=new Map;for(h=m;h<=d;h++){const e=t[h]=a?ys(t[h]):ws(t[h]);if(null!=e.key)g.set(e.key,h)}let v;let w=0;const b=d-m+1;let x=false;let k=0;const S=new Array(b);for(h=0;h<b;h++)S[h]=0;for(h=p;h<=u;h++){const n=e[h];if(w>=b){j(n,s,r,true);continue}let c;if(null!=n.key)c=g.get(n.key);else for(v=m;v<=d;v++)if(0===S[v-m]&&as(n,t[v])){c=v;break}if(void 0===c)j(n,s,r,true);else{S[c-m]=h+1;if(c>=k)k=c;else x=true;y(n,t[c],i,null,s,r,o,l,a);w++}}const C=x?Un(S):c;v=C.length-1;for(h=b-1;h>=0;h--){const e=m+h;const c=t[e];const u=e+1<f?t[e+1].el:n;if(0===S[h])y(null,c,i,u,s,r,o,l,a);else if(x)if(v<0||h!==C[v])q(c,i,u,2);else v--}}};const q=(e,t,i,s,r=null)=>{const{el:o,type:l,transition:a,children:h,shapeFlag:c}=e;if(6&c){q(e.component.subTree,t,i,s);return}if(128&c){e.suspense.move(t,i,s);return}if(64&c){l.move(e,t,i,Q);return}if(l===Jn){n(o,t,i);for(let e=0;e<h.length;e++)q(h[e],t,i,s);n(e.anchor,t,i);return}if(l===Qn){S(e,t,i);return}const f=2!==s&&1&c&&a;if(f)if(0===s){a.beforeEnter(o);n(o,t,i);Wn((()=>a.enter(o)),r)}else{const{leave:e,delayLeave:s,afterLeave:r}=a;const l=()=>n(o,t,i);const h=()=>{e(o,(()=>{l();r&&r()}))};if(s)s(o,l,h);else h()}else n(o,t,i)};const j=(e,t,i,n=false,s=false)=>{const{type:r,props:o,ref:l,children:a,dynamicChildren:h,shapeFlag:c,patchFlag:f,dirs:u}=e;if(null!=l)Hn(l,null,i,e,true);if(256&c){t.ctx.deactivate(e);return}const d=1&c&&u;const p=!Wi(e);let m;if(p&&(m=o&&o.onVnodeBeforeUnmount))ks(m,t,e);if(6&c)G(e.component,i,n);else{if(128&c){e.suspense.unmount(i,n);return}if(d)Nn(e,null,t,"beforeUnmount");if(64&c)e.type.remove(e,t,i,s,Q,n);else if(h&&(r!==Jn||f>0&&64&f))J(h,t,i,false,true);else if(r===Jn&&f&(128|256)||!s&&16&c)J(a,t,i);if(n)$(e)}if(p&&(m=o&&o.onVnodeUnmounted)||d)Wn((()=>{m&&ks(m,t,e);d&&Nn(e,null,t,"unmounted")}),i)};const $=e=>{const{type:t,el:i,anchor:n,transition:r}=e;if(t===Jn){K(i,n);return}if(t===Qn){C(e);return}const o=()=>{s(i);if(r&&!r.persisted&&r.afterLeave)r.afterLeave()};if(1&e.shapeFlag&&r&&!r.persisted){const{leave:t,delayLeave:n}=r;const s=()=>t(i,o);if(n)n(e.el,o,s);else s()}else o()};const K=(e,t)=>{let i;while(e!==t){i=m(e);s(e);e=i}s(t)};const G=(e,t,i)=>{const{bum:n,scope:s,update:r,subTree:o,um:l}=e;if(n)z(n);s.stop();if(r){r.active=false;j(o,e,t,i)}if(l)Wn(l,t);Wn((()=>{e.isUnmounted=true}),t);if(t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId){t.deps--;if(0===t.deps)t.resolve()}};const J=(e,t,i,n=false,s=false,r=0)=>{for(let o=r;o<e.length;o++)j(e[o],t,i,n,s)};const X=e=>{if(6&e.shapeFlag)return X(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();return m(e.anchor||e.el)};const Y=(e,t,i)=>{if(null==e){if(t._vnode)j(t._vnode,null,null,true)}else y(t._vnode||null,e,t,null,null,null,i);ni();t._vnode=e};const Q={p:y,um:j,m:q,r:$,mt:P,mc:D,pc:F,pbc:E,n:X,o:e};let Z;let ee;if(t)[Z,ee]=t(Q);return{render:Y,hydrate:Z,createApp:Fn(Y,Z)}}function jn({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function $n(e,t,i=false){const n=e.children;const s=t.children;if(b(n)&&b(s))for(let r=0;r<n.length;r++){const e=n[r];let t=s[r];if(1&t.shapeFlag&&!t.dynamicChildren){if(t.patchFlag<=0||32===t.patchFlag){t=s[r]=ys(s[r]);t.el=e.el}if(!i)$n(e,t)}}}function Un(e){const t=e.slice();const i=[0];let n,s,r,o,l;const a=e.length;for(n=0;n<a;n++){const a=e[n];if(0!==a){s=i[i.length-1];if(e[s]<a){t[n]=s;i.push(n);continue}r=0;o=i.length-1;while(r<o){l=r+o>>1;if(e[i[l]]<a)r=l+1;else o=l}if(a<e[i[r]]){if(r>0)t[n]=i[r-1];i[r]=n}}}r=i.length;o=i[r-1];while(r-- >0){i[r]=o;o=t[o]}return i}const Kn=e=>e.__isTeleport;const Gn=Symbol();const Jn=Symbol(void 0);const Xn=Symbol(void 0);const Yn=Symbol(void 0);const Qn=Symbol(void 0);const Zn=[];let es=null;function ts(e=false){Zn.push(es=e?null:[])}function is(){Zn.pop();es=Zn[Zn.length-1]||null}let ns=1;function ss(e){ns+=e}function rs(e){e.dynamicChildren=ns>0?es||c:null;is();if(ns>0&&es)es.push(e);return e}function os(e,t,i,n,s){return rs(ds(e,t,i,n,s,true))}function ls(e){return e?true===e.__v_isVNode:false}function as(e,t){return e.type===t.type&&e.key===t.key}const hs=`__vInternal`;const cs=({key:e})=>null!=e?e:null;const fs=({ref:e,ref_key:t,ref_for:i})=>null!=e?C(e)||kt(e)||S(e)?{i:hi,r:e,k:t,f:!!i}:e:null;function us(e,t=null,i=null,n=0,s=null,r=(e===Jn?0:1),o=false,l=false){const a={__v_isVNode:true,__v_skip:true,type:e,props:t,key:t&&cs(t),ref:t&&fs(t),scopeId:ci,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null};if(l){bs(a,i);if(128&r)e.normalize(a)}else if(i)a.shapeFlag|=C(i)?8:16;if(ns>0&&!o&&es&&(a.patchFlag>0||6&r)&&32!==a.patchFlag)es.push(a);return a}const ds=ps;function ps(e,t=null,i=null,n=0,r=null,o=false){if(!e||e===Gn)e=Yn;if(ls(e)){const n=gs(e,t,true);if(i)bs(n,i);return n}if($s(e))e=e.__vccOpts;if(t){t=ms(t);let{class:e,style:i}=t;if(e&&!C(e))t.class=a(e);if(M(i)){if(mt(i)&&!b(i))i=g({},i);t.style=s(i)}}const l=C(e)?1:bi(e)?128:Kn(e)?64:M(e)?4:S(e)?2:0;return us(e,t,i,n,r,l,o,true)}function ms(e){if(!e)return null;return mt(e)||hs in e?g({},e):e}function gs(e,t,i=false){const{props:n,ref:s,patchFlag:r,children:o}=e;const l=t?xs(n||{},t):n;const a={__v_isVNode:true,__v_skip:true,type:e.type,props:l,key:l&&cs(l),ref:t&&t.ref?i&&s?b(s)?s.concat(fs(t)):[s,fs(t)]:fs(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Jn?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&gs(e.ssContent),ssFallback:e.ssFallback&&gs(e.ssFallback),el:e.el,anchor:e.anchor};return a}function vs(e=" ",t=0){return ds(Xn,null,e,t)}function ws(e){if(null==e||"boolean"===typeof e)return ds(Yn);else if(b(e))return ds(Jn,null,e.slice());else if("object"===typeof e)return ys(e);else return ds(Xn,null,String(e))}function ys(e){return null===e.el||e.memo?e:gs(e)}function bs(e,t){let i=0;const{shapeFlag:n}=e;if(null==t)t=null;else if(b(t))i=16;else if("object"===typeof t)if(n&(1|64)){const i=t.default;if(i){i._c&&(i._d=false);bs(e,i());i._c&&(i._d=true)}return}else{i=32;const n=t._;if(!n&&!(hs in t))t._ctx=hi;else if(3===n&&hi)if(1===hi.slots._)t._=1;else{t._=2;e.patchFlag|=1024}}else if(S(t)){t={default:t,_ctx:hi};i=32}else{t=String(t);if(64&n){i=16;t=[vs(t)]}else i=8}e.children=t;e.shapeFlag|=i}function xs(...e){const t={};for(let i=0;i<e.length;i++){const n=e[i];for(const e in n)if("class"===e){if(t.class!==n.class)t.class=a([t.class,n.class])}else if("style"===e)t.style=s([t.style,n.style]);else if(p(e)){const i=t[e];const s=n[e];if(s&&i!==s&&!(b(i)&&i.includes(s)))t[e]=i?[].concat(i,s):s}else if(""!==e)t[e]=n[e]}return t}function ks(e,t,i,n=null){_t(e,t,7,[i,n])}function Ss(e,t,i={},n,s){if(hi.isCE)return ds("slot","default"===t?null:{name:t},n&&n());let r=e[t];if(r&&r._c)r._d=false;ts();const o=r&&Cs(r(i));const l=os(Jn,{key:i.key||`_${t}`},o||(n?n():[]),o&&1===e._?64:-2);if(!s&&l.scopeId)l.slotScopeIds=[l.scopeId+"-s"];if(r&&r._c)r._d=true;return l}function Cs(e){return e.some((e=>{if(!ls(e))return true;if(e.type===Yn)return false;if(e.type===Jn&&!Cs(e.children))return false;return true}))?e:null}const As=e=>{if(!e)return null;if(Ps(e))return js(e)||e.proxy;return As(e.parent)};const Ms=g(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>As(e.parent),$root:e=>As(e.root),$emit:e=>e.emit,$options:e=>fn(e),$forceUpdate:e=>()=>Xt(e.update),$nextTick:e=>Gt.bind(e.proxy),$watch:e=>Oi.bind(e)});const Os={get({_:e},t){const{ctx:i,setupState:n,data:s,props:r,accessCache:o,type:l,appContext:a}=e;let c;if("$"!==t[0]){const l=o[t];if(void 0!==l)switch(l){case 1:return n[t];case 2:return s[t];case 4:return i[t];case 3:return r[t]}else if(n!==h&&y(n,t)){o[t]=1;return n[t]}else if(s!==h&&y(s,t)){o[t]=2;return s[t]}else if((c=e.propsOptions[0])&&y(c,t)){o[t]=3;return r[t]}else if(i!==h&&y(i,t)){o[t]=4;return i[t]}else if(on)o[t]=0}const f=Ms[t];let u,d;if(f){if("$attrs"===t)pe(e,"get",t);return f(e)}else if((u=l.__cssModules)&&(u=u[t]))return u;else if(i!==h&&y(i,t)){o[t]=4;return i[t]}else if(d=a.config.globalProperties,y(d,t))return d[t]},set({_:e},t,i){const{data:n,setupState:s,ctx:r}=e;if(s!==h&&y(s,t)){s[t]=i;return true}else if(n!==h&&y(n,t)){n[t]=i;return true}else if(y(e.props,t))return false;if("$"===t[0]&&t.slice(1)in e)return false;else r[t]=i;return true},has({_:{data:e,setupState:t,accessCache:i,ctx:n,appContext:s,propsOptions:r}},o){let l;return!!i[o]||e!==h&&y(e,o)||t!==h&&y(t,o)||(l=r[0])&&y(l,o)||y(n,o)||y(Ms,o)||y(s.config.globalProperties,o)},defineProperty(e,t,i){if(null!=i.get)this.set(e,t,i.get(),null);else if(null!=i.value)this.set(e,t,i.value,null);return Reflect.defineProperty(e,t,i)}};const Ds=In();let Ts=0;function Es(e,t,i){const n=e.type;const s=(t?t.appContext:e.appContext)||Ds;const r={uid:Ts++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new G(true),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Cn(n,s),emitsOptions:li(n,s),emit:null,emitted:null,propsDefaults:h,inheritAttrs:n.inheritAttrs,ctx:h,data:h,props:h,attrs:h,slots:h,refs:h,setupState:h,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:false,isMounted:false,isUnmounted:false,isDeactivated:false,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};r.ctx={_:r};r.root=t?t.root:r;r.emit=oi.bind(null,r);if(e.ce)e.ce(r);return r}let Rs=null;const _s=()=>Rs||hi;const Bs=e=>{Rs=e;e.scope.on()};const Ls=()=>{Rs&&Rs.scope.off();Rs=null};function Ps(e){return 4&e.vnode.shapeFlag}let Ns=false;function Is(e,t=false){Ns=t;const{props:i,children:n}=e.vnode;const s=Ps(e);bn(e,i,s,t);Ln(e,n);const r=s?Vs(e,t):void 0;Ns=false;return r}function Vs(e,t){const i=e.type;e.accessCache=Object.create(null);e.proxy=vt(new Proxy(e.ctx,Os));const{setup:n}=i;if(n){const i=e.setupContext=n.length>1?qs(e):null;Bs(e);ue();const s=Rt(n,e,0,[e.props,i]);de();Ls();if(O(s)){s.then(Ls,Ls);if(t)return s.then((i=>{Fs(e,i,t)})).catch((t=>{Bt(t,e,0)}));else e.asyncDep=s}else Fs(e,s,t)}else Ws(e,t)}function Fs(e,t,i){if(S(t))if(e.type.__ssrInlineRender)e.ssrRender=t;else e.render=t;else if(M(t))e.setupState=Dt(t);Ws(e,i)}let Hs;function Ws(e,t,i){const n=e.type;if(!e.render){if(!t&&Hs&&!n.render){const t=n.template;if(t){const{isCustomElement:i,compilerOptions:s}=e.appContext.config;const{delimiters:r,compilerOptions:o}=n;const l=g(g({isCustomElement:i,delimiters:r},s),o);n.render=Hs(t,l)}}e.render=n.render||f}Bs(e);ue();ln(e);de();Ls()}function zs(e){return new Proxy(e.attrs,{get(t,i){pe(e,"get","$attrs");return t[i]}})}function qs(e){const t=t=>{e.exposed=t||{}};let i;return{get attrs(){return i||(i=zs(e))},slots:e.slots,emit:e.emit,expose:t}}function js(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Dt(vt(e.exposed)),{get(t,i){if(i in t)return t[i];else if(i in Ms)return Ms[i](e)}}))}function $s(e){return S(e)&&"__vccOpts"in e}const Us=(e,t)=>Et(e,t,Ns);const Ks="3.2.31";const Gs="http://www.w3.org/2000/svg";const Js="undefined"!==typeof document?document:null;const Xs=Js&&Js.createElement("template");const Ys={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;if(t)t.removeChild(e)},createElement:(e,t,i,n)=>{const s=t?Js.createElementNS(Gs,e):Js.createElement(e,i?{is:i}:void 0);if("select"===e&&n&&null!=n.multiple)s.setAttribute("multiple",n.multiple);return s},createText:e=>Js.createTextNode(e),createComment:e=>Js.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Js.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(true);if(`_value`in e)t._value=e._value;return t},insertStaticContent(e,t,i,n,s,r){const o=i?i.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))while(true){t.insertBefore(s.cloneNode(true),i);if(s===r||!(s=s.nextSibling))break}else{Xs.innerHTML=n?`<svg>${e}</svg>`:e;const s=Xs.content;if(n){const e=s.firstChild;while(e.firstChild)s.appendChild(e.firstChild);s.removeChild(e)}t.insertBefore(s,i)}return[o?o.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function Qs(e,t,i){const n=e._vtc;if(n)t=(t?[t,...n]:[...n]).join(" ");if(null==t)e.removeAttribute("class");else if(i)e.setAttribute("class",t);else e.className=t}function Zs(e,t,i){const n=e.style;const s=C(i);if(i&&!s){for(const e in i)tr(n,e,i[e]);if(t&&!C(t))for(const e in t)if(null==i[e])tr(n,e,"")}else{const r=n.display;if(s){if(t!==i)n.cssText=i}else if(t)e.removeAttribute("style");if("_vod"in e)n.display=r}}const er=/\s*!important$/;function tr(e,t,i){if(b(i))i.forEach((i=>tr(e,t,i)));else if(t.startsWith("--"))e.setProperty(t,i);else{const n=sr(e,t);if(er.test(i))e.setProperty(V(n),i.replace(er,""),"important");else e[n]=i}}const ir=["Webkit","Moz","ms"];const nr={};function sr(e,t){const i=nr[t];if(i)return i;let n=N(t);if("filter"!==n&&n in e)return nr[t]=n;n=F(n);for(let s=0;s<ir.length;s++){const i=ir[s]+n;if(i in e)return nr[t]=i}return t}const rr="http://www.w3.org/1999/xlink";function or(e,t,s,r,o){if(r&&t.startsWith("xlink:"))if(null==s)e.removeAttributeNS(rr,t.slice(6,t.length));else e.setAttributeNS(rr,t,s);else{const r=i(t);if(null==s||r&&!n(s))e.removeAttribute(t);else e.setAttribute(t,r?"":s)}}function lr(e,t,i,s,r,o,l){if("innerHTML"===t||"textContent"===t){if(s)l(s,r,o);e[t]=null==i?"":i;return}if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=i;const n=null==i?"":i;if(e.value!==n||"OPTION"===e.tagName)e.value=n;if(null==i)e.removeAttribute(t);return}if(""===i||null==i){const s=typeof e[t];if("boolean"===s){e[t]=n(i);return}else if(null==i&&"string"===s){e[t]="";e.removeAttribute(t);return}else if("number"===s){try{e[t]=0}catch(a){}e.removeAttribute(t);return}}try{e[t]=i}catch(h){}}let ar=Date.now;let hr=false;if("undefined"!==typeof window){if(ar()>document.createEvent("Event").timeStamp)ar=()=>performance.now();const e=navigator.userAgent.match(/firefox\/(\d+)/i);hr=!!(e&&Number(e[1])<=53)}let cr=0;const fr=Promise.resolve();const ur=()=>{cr=0};const dr=()=>cr||(fr.then(ur),cr=ar());function pr(e,t,i,n){e.addEventListener(t,i,n)}function mr(e,t,i,n){e.removeEventListener(t,i,n)}function gr(e,t,i,n,s=null){const r=e._vei||(e._vei={});const o=r[t];if(n&&o)o.value=n;else{const[i,l]=wr(t);if(n){const o=r[t]=yr(n,s);pr(e,i,o,l)}else if(o){mr(e,i,o,l);r[t]=void 0}}}const vr=/(?:Once|Passive|Capture)$/;function wr(e){let t;if(vr.test(e)){t={};let i;while(i=e.match(vr)){e=e.slice(0,e.length-i[0].length);t[i[0].toLowerCase()]=true}}return[V(e.slice(2)),t]}function yr(e,t){const i=e=>{const n=e.timeStamp||ar();if(hr||n>=i.attached-1)_t(br(e,i.value),t,5,[e])};i.value=e;i.attached=dr();return i}function br(e,t){if(b(t)){const i=e.stopImmediatePropagation;e.stopImmediatePropagation=()=>{i.call(e);e._stopped=true};return t.map((e=>t=>!t._stopped&&e&&e(t)))}else return t}const xr=/^on[a-z]/;const kr=(e,t,i,n,s=false,r,o,l,a)=>{if("class"===t)Qs(e,n,s);else if("style"===t)Zs(e,i,n);else if(p(t)){if(!m(t))gr(e,t,i,n,o)}else if("."===t[0]?(t=t.slice(1),true):"^"===t[0]?(t=t.slice(1),false):Sr(e,t,n,s))lr(e,t,n,r,o,l,a);else{if("true-value"===t)e._trueValue=n;else if("false-value"===t)e._falseValue=n;or(e,t,n,s)}};function Sr(e,t,i,n){if(n){if("innerHTML"===t||"textContent"===t)return true;if(t in e&&xr.test(t)&&S(i))return true;return false}if("spellcheck"===t||"draggable"===t)return false;if("form"===t)return false;if("list"===t&&"INPUT"===e.tagName)return false;if("type"===t&&"TEXTAREA"===e.tagName)return false;if(xr.test(t)&&C(i))return false;return t in e}function Cr(e,t){const i=Hi(e);class n extends Mr{constructor(e){super(i,e,t)}}n.def=i;return n}const Ar="undefined"!==typeof HTMLElement?HTMLElement:class{};class Mr extends Ar{constructor(e,t={},i){super();this._def=e;this._props=t;this._instance=null;this._connected=false;this._resolved=false;this._numberProps=null;if(this.shadowRoot&&i)i(this._createVNode(),this.shadowRoot);else this.attachShadow({mode:"open"})}connectedCallback(){this._connected=true;if(!this._instance)this._resolveDef()}disconnectedCallback(){this._connected=false;Gt((()=>{if(!this._connected){Rr(null,this.shadowRoot);this._instance=null}}))}_resolveDef(){if(this._resolved)return;this._resolved=true;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);new MutationObserver((e=>{for(const t of e)this._setAttr(t.attributeName)})).observe(this,{attributes:true});const e=e=>{const{props:t,styles:i}=e;const n=!b(t);const s=t?n?Object.keys(t):t:[];let r;if(n)for(const o in this._props){const e=t[o];if(e===Number||e&&e.type===Number){this._props[o]=j(this._props[o]);(r||(r=Object.create(null)))[o]=true}}this._numberProps=r;for(const o of Object.keys(this))if("_"!==o[0])this._setProp(o,this[o],true,false);for(const o of s.map(N))Object.defineProperty(this,o,{get(){return this._getProp(o)},set(e){this._setProp(o,e)}});this._applyStyles(i);this._update()};const t=this._def.__asyncLoader;if(t)t().then(e);else e(this._def)}_setAttr(e){let t=this.getAttribute(e);if(this._numberProps&&this._numberProps[e])t=j(t);this._setProp(N(e),t,false)}_getProp(e){return this._props[e]}_setProp(e,t,i=true,n=true){if(t!==this._props[e]){this._props[e]=t;if(n&&this._instance)this._update();if(i)if(true===t)this.setAttribute(V(e),"");else if("string"===typeof t||"number"===typeof t)this.setAttribute(V(e),t+"");else if(!t)this.removeAttribute(V(e))}}_update(){Rr(this._createVNode(),this.shadowRoot)}_createVNode(){const e=ds(this._def,g({},this._props));if(!this._instance)e.ce=e=>{this._instance=e;e.isCE=true;e.emit=(e,...t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};let t=this;while(t=t&&(t.parentNode||t.host))if(t instanceof Mr){e.parent=t._instance;break}};return e}_applyStyles(e){if(e)e.forEach((e=>{const t=document.createElement("style");t.textContent=e;this.shadowRoot.appendChild(t)}))}}const Or={name:String,type:String,css:{type:Boolean,default:true},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};g({},Bi.props,Or);const Dr=g({patchProp:kr},Ys);let Tr;function Er(){return Tr||(Tr=zn(Dr))}const Rr=(...e)=>{Er().render(...e)};class _r{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,false,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,true,1,0)}replace(e,t,i){let n=[];this.decompose(0,e,n,2);if(i.length)i.decompose(0,i.length,n,1|2);this.decompose(t,this.length,n,1);return Lr.from(n,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let i=[];this.decompose(e,t,i,0);return Lr.from(i,t-e)}eq(e){if(e==this)return true;if(e.length!=this.length||e.lines!=this.lines)return false;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1);let n=new Vr(this),s=new Vr(e);for(let r=t,o=t;;){n.next(r);s.next(r);r=0;if(n.lineBreak!=s.lineBreak||n.done!=s.done||n.value!=s.value)return false;o+=n.value.length;if(n.done||o>=i)return true}}iter(e=1){return new Vr(this,e)}iterRange(e,t=this.length){return new Fr(this,e,t)}iterLines(e,t){let i;if(null==e)i=this.iter();else{if(null==t)t=this.lines+1;let n=this.line(e).from;i=this.iterRange(n,Math.max(n,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Hr(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];this.flatten(e);return e}static of(e){if(0==e.length)throw new RangeError("A document must have at least one line");if(1==e.length&&!e[0])return _r.empty;return e.length<=32?new Br(e):Lr.from(Br.split(e,[]))}}class Br extends _r{constructor(e,t=Pr(e)){super();this.text=e;this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,n){for(let s=0;;s++){let r=this.text[s],o=n+r.length;if((t?i:o)>=e)return new Wr(n,o,i,r);n=o+1;i++}}decompose(e,t,i,n){let s=e<=0&&t>=this.length?this:new Br(Ir(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(1&n){let e=i.pop();let t=Nr(s.text,e.text.slice(),0,s.length);if(t.length<=32)i.push(new Br(t,e.length+s.length));else{let e=t.length>>1;i.push(new Br(t.slice(0,e)),new Br(t.slice(e)))}}else i.push(s)}replace(e,t,i){if(!(i instanceof Br))return super.replace(e,t,i);let n=Nr(this.text,Nr(i.text,Ir(this.text,0,e)),t);let s=this.length+i.length-(t-e);if(n.length<=32)return new Br(n,s);return Lr.from(Br.split(n,[]),s)}sliceString(e,t=this.length,i="\n"){let n="";for(let s=0,r=0;s<=t&&r<this.text.length;r++){let o=this.text[r],l=s+o.length;if(s>e&&r)n+=i;if(e<l&&t>s)n+=o.slice(Math.max(0,e-s),t-s);s=l+1}return n}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],n=-1;for(let s of e){i.push(s);n+=s.length+1;if(32==i.length){t.push(new Br(i,n));i=[];n=-1}}if(n>-1)t.push(new Br(i,n));return t}}class Lr extends _r{constructor(e,t){super();this.children=e;this.length=t;this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,n){for(let s=0;;s++){let r=this.children[s],o=n+r.length,l=i+r.lines-1;if((t?l:o)>=e)return r.lineInner(e,t,i,n);n=o+1;i=l+1}}decompose(e,t,i,n){for(let s=0,r=0;r<=t&&s<this.children.length;s++){let o=this.children[s],l=r+o.length;if(e<=l&&t>=r){let s=n&((r<=e?1:0)|(l>=t?2:0));if(r>=e&&l<=t&&!s)i.push(o);else o.decompose(e-r,t-r,i,s)}r=l+1}}replace(e,t,i){if(i.lines<this.lines)for(let n=0,s=0;n<this.children.length;n++){let r=this.children[n],o=s+r.length;if(e>=s&&t<=o){let l=r.replace(e-s,t-s,i);let a=this.lines-r.lines+l.lines;if(l.lines<a>>5-1&&l.lines>a>>5+1){let s=this.children.slice();s[n]=l;return new Lr(s,this.length-(t-e)+i.length)}return super.replace(s,o,l)}s=o+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i="\n"){let n="";for(let s=0,r=0;s<this.children.length&&r<=t;s++){let o=this.children[s],l=r+o.length;if(r>e&&s)n+=i;if(e<l&&t>r)n+=o.sliceString(e-r,t-r,i);r=l+1}return n}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Lr))return 0;let i=0;let[n,s,r,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=t,s+=t){if(n==r||s==o)return i;let l=this.children[n],a=e.children[s];if(l!=a)return i+l.scanIdentical(a,t);i+=l.length+1}}static from(e,t=e.reduce(((e,t)=>e+t.length+1),-1)){let i=0;for(let u of e)i+=u.lines;if(i<32){let i=[];for(let t of e)t.flatten(i);return new Br(i,t)}let n=Math.max(32,i>>5),s=n<<1,r=n>>1;let o=[],l=0,a=-1,h=[];function c(e){let t;if(e.lines>s&&e instanceof Lr)for(let i of e.children)c(i);else if(e.lines>r&&(l>r||!l)){f();o.push(e)}else if(e instanceof Br&&l&&(t=h[h.length-1])instanceof Br&&e.lines+t.lines<=32){l+=e.lines;a+=e.length+1;h[h.length-1]=new Br(t.text.concat(e.text),t.length+1+e.length)}else{if(l+e.lines>n)f();l+=e.lines;a+=e.length+1;h.push(e)}}function f(){if(0==l)return;o.push(1==h.length?h[0]:Lr.from(h,a));a=-1;l=h.length=0}for(let u of e)c(u);f();return 1==o.length?o[0]:new Lr(o,t)}}_r.empty=new Br([""],0);function Pr(e){let t=-1;for(let i of e)t+=i.length+1;return t}function Nr(e,t,i=0,n=1e9){for(let s=0,r=0,o=true;r<e.length&&s<=n;r++){let l=e[r],a=s+l.length;if(a>=i){if(a>n)l=l.slice(0,n-s);if(s<i)l=l.slice(i-s);if(o){t[t.length-1]+=l;o=false}else t.push(l)}s=a+1}return t}function Ir(e,t,i){return Nr(e,[""],t,i)}class Vr{constructor(e,t=1){this.dir=t;this.done=false;this.lineBreak=false;this.value="";this.nodes=[e];this.offsets=[t>0?1:(e instanceof Br?e.text.length:e.children.length)<<1]}nextInner(e,t){this.done=this.lineBreak=false;for(;;){let i=this.nodes.length-1;let n=this.nodes[i],s=this.offsets[i],r=s>>1;let o=n instanceof Br?n.text.length:n.children.length;if(r==(t>0?o:0)){if(0==i){this.done=true;this.value="";return this}if(t>0)this.offsets[i-1]++;this.nodes.pop();this.offsets.pop()}else if((1&s)==(t>0?0:1)){this.offsets[i]+=t;if(0==e){this.lineBreak=true;this.value="\n";return this}e--}else if(n instanceof Br){let s=n.text[r+(t<0?-1:0)];this.offsets[i]+=t;if(s.length>Math.max(0,e)){this.value=0==e?s:t>0?s.slice(e):s.slice(0,s.length-e);return this}e-=s.length}else{let s=n.children[r+(t<0?-1:0)];if(e>s.length){e-=s.length;this.offsets[i]+=t}else{if(t<0)this.offsets[i]--;this.nodes.push(s);this.offsets.push(t>0?1:(s instanceof Br?s.text.length:s.children.length)<<1)}}}}next(e=0){if(e<0){this.nextInner(-e,-this.dir);e=this.value.length}return this.nextInner(e,this.dir)}}class Fr{constructor(e,t,i){this.value="";this.done=false;this.cursor=new Vr(e,t>i?-1:1);this.pos=t>i?e.length:0;this.from=Math.min(t,i);this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to){this.value="";this.done=true;return this}e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;if(e>i)e=i;i-=e;let{value:n}=this.cursor.next(e);this.pos+=(n.length+e)*t;this.value=n.length<=i?n:t<0?n.slice(n.length-i):n.slice(0,i);this.done=!this.value;return this}next(e=0){if(e<0)e=Math.max(e,this.from-this.pos);else if(e>0)e=Math.min(e,this.to-this.pos);return this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class Hr{constructor(e){this.inner=e;this.afterBreak=true;this.value="";this.done=false}next(e=0){let{done:t,lineBreak:i,value:n}=this.inner.next(e);if(t){this.done=true;this.value=""}else if(i)if(this.afterBreak)this.value="";else{this.afterBreak=true;this.next()}else{this.value=n;this.afterBreak=false}return this}get lineBreak(){return false}}if("undefined"!=typeof Symbol){_r.prototype[Symbol.iterator]=function(){return this.iter()};Vr.prototype[Symbol.iterator]=Fr.prototype[Symbol.iterator]=Hr.prototype[Symbol.iterator]=function(){return this}}class Wr{constructor(e,t,i,n){this.from=e;this.to=t;this.number=i;this.text=n}get length(){return this.to-this.from}}let zr="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((e=>e?parseInt(e,36):1));for(let tk=1;tk<zr.length;tk++)zr[tk]+=zr[tk-1];function qr(e){for(let t=1;t<zr.length;t+=2)if(zr[t]>e)return zr[t-1]<=e;return false}function jr(e){return e>=127462&&e<=127487}const $r=8205;function Ur(e,t,i=true,n=true){return(i?Kr:Gr)(e,t,n)}function Kr(e,t,i){if(t==e.length)return t;if(t&&Jr(e.charCodeAt(t))&&Xr(e.charCodeAt(t-1)))t--;let n=Yr(e,t);t+=Zr(n);while(t<e.length){let s=Yr(e,t);if(n==$r||s==$r||i&&qr(s)){t+=Zr(s);n=s}else if(jr(s)){let i=0,n=t-2;while(n>=0&&jr(Yr(e,n))){i++;n-=2}if(i%2==0)break;else t+=2}else break}return t}function Gr(e,t,i){while(t>0){let n=Kr(e,t-2,i);if(n<t)return n;t--}return 0}function Jr(e){return e>=56320&&e<57344}function Xr(e){return e>=55296&&e<56320}function Yr(e,t){let i=e.charCodeAt(t);if(!Xr(i)||t+1==e.length)return i;let n=e.charCodeAt(t+1);if(!Jr(n))return i;return(i-55296<<10)+(n-56320)+65536}function Qr(e){if(e<=65535)return String.fromCharCode(e);e-=65536;return String.fromCharCode((e>>10)+55296,(1023&e)+56320)}function Zr(e){return e<65536?1:2}const eo=/\r\n?|\n/;var to=function(e){e[e["Simple"]=0]="Simple";e[e["TrackDel"]=1]="TrackDel";e[e["TrackBefore"]=2]="TrackBefore";e[e["TrackAfter"]=3]="TrackAfter";return e}(to||(to={}));class io{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,n=0;t<this.sections.length;){let s=this.sections[t++],r=this.sections[t++];if(r<0){e(i,n,s);n+=s}else n+=r;i+=s}}iterChangedRanges(e,t=false){oo(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];if(n<0)e.push(i,n);else e.push(n,i)}return new io(e)}composeDesc(e){return this.empty?e:e.empty?this:ao(this,e)}mapDesc(e,t=false){return e.empty?this:lo(this,e,t)}mapPos(e,t=-1,i=to.Simple){let n=0,s=0;for(let r=0;r<this.sections.length;){let o=this.sections[r++],l=this.sections[r++],a=n+o;if(l<0){if(a>e)return s+(e-n);s+=o}else{if(i!=to.Simple&&a>=e&&(i==to.TrackDel&&n<e&&a>e||i==to.TrackBefore&&n<e||i==to.TrackAfter&&a>e))return null;if(a>e||a==e&&t<0&&!o)return e==n||t<0?s:s+l;s+=l}n=a}if(e>n)throw new RangeError(`Position ${e} is out of range for changeset of length ${n}`);return s}touchesRange(e,t=e){for(let i=0,n=0;i<this.sections.length&&n<=t;){let s=this.sections[i++],r=this.sections[i++],o=n+s;if(r>=0&&n<=t&&o>=e)return n<e&&o>t?"cover":true;n=o}return false}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],n=this.sections[t++];e+=(e?" ":"")+i+(n>=0?":"+n:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some((e=>"number"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new io(e)}static create(e){return new io(e)}}class no extends io{constructor(e,t){super(e);this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");oo(this,((t,i,n,s,r)=>e=e.replace(n,n+(i-t),r)),false);return e}mapDesc(e,t=false){return lo(this,e,t,true)}invert(e){let t=this.sections.slice(),i=[];for(let n=0,s=0;n<t.length;n+=2){let r=t[n],o=t[n+1];if(o>=0){t[n]=o;t[n+1]=r;let l=n>>1;while(i.length<l)i.push(_r.empty);i.push(r?e.slice(s,s+r):_r.empty)}s+=r}return new no(t,i)}compose(e){return this.empty?e:e.empty?this:ao(this,e,true)}map(e,t=false){return e.empty?this:lo(this,e,t,true)}iterChanges(e,t=false){oo(this,e,t)}get desc(){return io.create(this.sections)}filter(e){let t=[],i=[],n=[];let s=new ho(this);e:for(let r=0,o=0;;){let l=r==e.length?1e9:e[r++];while(o<l||o==l&&0==s.len){if(s.done)break e;let e=Math.min(s.len,l-o);so(n,e,-1);let r=-1==s.ins?-1:0==s.off?s.ins:0;so(t,e,r);if(r>0)ro(i,t,s.text);s.forward(e);o+=e}let a=e[r++];while(o<a){if(s.done)break e;let e=Math.min(s.len,a-o);so(t,e,-1);so(n,e,-1==s.ins?-1:0==s.off?s.ins:0);s.forward(e);o+=e}}return{changes:new no(t,i),filtered:io.create(n)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],n=this.sections[t+1];if(n<0)e.push(i);else if(0==n)e.push([i]);else e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let n=[],s=[],r=0;let o=null;function l(e=false){if(!e&&!n.length)return;if(r<t)so(n,t-r,-1);let i=new no(n,s);o=o?o.compose(i.map(o)):i;n=[];s=[];r=0}function a(e){if(Array.isArray(e))for(let t of e)a(t);else if(e instanceof no){if(e.length!=t)throw new RangeError(`Mismatched change set length (got ${e.length}, expected ${t})`);l();o=o?o.compose(e.map(o)):e}else{let{from:o,to:a=o,insert:h}=e;if(o>a||o<0||a>t)throw new RangeError(`Invalid change range ${o} to ${a} (in doc of length ${t})`);let c=!h?_r.empty:"string"==typeof h?_r.of(h.split(i||eo)):h;let f=c.length;if(o==a&&0==f)return;if(o<r)l();if(o>r)so(n,o-r,-1);so(n,a-o,f);ro(s,n,c);r=a}}a(e);l(!o);return o}static empty(e){return new no(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let n=0;n<e.length;n++){let s=e[n];if("number"==typeof s)t.push(s,-1);else if(!Array.isArray(s)||"number"!=typeof s[0]||s.some(((e,t)=>t&&"string"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeSet");else if(1==s.length)t.push(s[0],0);else{while(i.length<n)i.push(_r.empty);i[n]=_r.of(s.slice(1));t.push(s[0],i[n].length)}}return new no(t,i)}static createSet(e,t){return new no(e,t)}}function so(e,t,i,n=false){if(0==t&&i<=0)return;let s=e.length-2;if(s>=0&&i<=0&&i==e[s+1])e[s]+=t;else if(0==t&&0==e[s])e[s+1]+=i;else if(n){e[s]+=t;e[s+1]+=i}else e.push(t,i)}function ro(e,t,i){if(0==i.length)return;let n=t.length-2>>1;if(n<e.length)e[e.length-1]=e[e.length-1].append(i);else{while(e.length<n)e.push(_r.empty);e.push(i)}}function oo(e,t,i){let n=e.inserted;for(let s=0,r=0,o=0;o<e.sections.length;){let l=e.sections[o++],a=e.sections[o++];if(a<0){s+=l;r+=l}else{let h=s,c=r,f=_r.empty;for(;;){h+=l;c+=a;if(a&&n)f=f.append(n[o-2>>1]);if(i||o==e.sections.length||e.sections[o+1]<0)break;l=e.sections[o++];a=e.sections[o++]}t(s,h,r,c,f);s=h;r=c}}}function lo(e,t,i,n=false){let s=[],r=n?[]:null;let o=new ho(e),l=new ho(t);for(let a=-1;;)if(-1==o.ins&&-1==l.ins){let e=Math.min(o.len,l.len);so(s,e,-1);o.forward(e);l.forward(e)}else if(l.ins>=0&&(o.ins<0||a==o.i||0==o.off&&(l.len<o.len||l.len==o.len&&!i))){let e=l.len;so(s,l.ins,-1);while(e){let t=Math.min(o.len,e);if(o.ins>=0&&a<o.i&&o.len<=t){so(s,0,o.ins);if(r)ro(r,s,o.text);a=o.i}o.forward(t);e-=t}l.next()}else if(o.ins>=0){let e=0,t=o.len;while(t)if(-1==l.ins){let i=Math.min(t,l.len);e+=i;t-=i;l.forward(i)}else if(0==l.ins&&l.len<t){t-=l.len;l.next()}else break;so(s,e,a<o.i?o.ins:0);if(r&&a<o.i)ro(r,s,o.text);a=o.i;o.forward(o.len-t)}else if(o.done&&l.done)return r?no.createSet(s,r):io.create(s);else throw new Error("Mismatched change set lengths")}function ao(e,t,i=false){let n=[];let s=i?[]:null;let r=new ho(e),o=new ho(t);for(let l=false;;)if(r.done&&o.done)return s?no.createSet(n,s):io.create(n);else if(0==r.ins){so(n,r.len,0,l);r.next()}else if(0==o.len&&!o.done){so(n,0,o.ins,l);if(s)ro(s,n,o.text);o.next()}else if(r.done||o.done)throw new Error("Mismatched change set lengths");else{let e=Math.min(r.len2,o.len),t=n.length;if(-1==r.ins){let t=-1==o.ins?-1:o.off?0:o.ins;so(n,e,t,l);if(s&&t)ro(s,n,o.text)}else if(-1==o.ins){so(n,r.off?0:r.len,e,l);if(s)ro(s,n,r.textBit(e))}else{so(n,r.off?0:r.len,o.off?0:o.ins,l);if(s&&!o.off)ro(s,n,o.text)}l=(r.ins>e||o.ins>=0&&o.len>e)&&(l||n.length>t);r.forward2(e);o.forward(e)}}class ho{constructor(e){this.set=e;this.i=0;this.next()}next(){let{sections:e}=this.set;if(this.i<e.length){this.len=e[this.i++];this.ins=e[this.i++]}else{this.len=0;this.ins=-2}this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?_r.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?_r.empty:t[i].slice(this.off,null==e?void 0:this.off+e)}forward(e){if(e==this.len)this.next();else{this.len-=e;this.off+=e}}forward2(e){if(-1==this.ins)this.forward(e);else if(e==this.ins)this.next();else{this.ins-=e;this.off+=e}}}class co{constructor(e,t,i){this.from=e;this.to=t;this.flags=i}get anchor(){return 16&this.flags?this.to:this.from}get head(){return 16&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 4&this.flags?-1:8&this.flags?1:0}get bidiLevel(){let e=3&this.flags;return 3==e?null:e}get goalColumn(){let e=this.flags>>5;return 33554431==e?void 0:e}map(e,t=-1){let i,n;if(this.empty)i=n=e.mapPos(this.from,t);else{i=e.mapPos(this.from,1);n=e.mapPos(this.to,-1)}return i==this.from&&n==this.to?this:new co(i,n,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return fo.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return fo.range(this.anchor,i)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return fo.range(e.anchor,e.head)}static create(e,t,i){return new co(e,t,i)}}class fo{constructor(e,t){this.ranges=e;this.mainIndex=t}map(e,t=-1){if(e.empty)return this;return fo.create(this.ranges.map((i=>i.map(e,t))),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return false;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return false;return true}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new fo([this.main],0)}addRange(e,t=true){return fo.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();i[t]=e;return fo.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((e=>e.toJSON())),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new fo(e.ranges.map((e=>co.fromJSON(e))),e.main)}static single(e,t=e){return new fo([fo.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<e.length;n++){let s=e[n];if(s.empty?s.from<=i:s.from<i)return fo.normalized(e.slice(),t);i=s.to}return new fo(e,t)}static cursor(e,t=0,i,n){return co.create(e,e,(0==t?0:t<0?4:8)|(null==i?3:Math.min(2,i))|(null!==n&&void 0!==n?n:33554431)<<5)}static range(e,t,i){let n=(null!==i&&void 0!==i?i:33554431)<<5;return t<e?co.create(t,e,16|n|8):co.create(e,t,n|(t>e?4:0))}static normalized(e,t=0){let i=e[t];e.sort(((e,t)=>e.from-t.from));t=e.indexOf(i);for(let n=1;n<e.length;n++){let i=e[n],s=e[n-1];if(i.empty?i.from<=s.to:i.from<s.to){let r=s.from,o=Math.max(i.to,s.to);if(n<=t)t--;e.splice(--n,2,i.anchor>i.head?fo.range(o,r):fo.range(r,o))}}return new fo(e,t)}}function uo(e,t){for(let i of e.ranges)if(i.to>t)throw new RangeError("Selection points outside of document")}let po=0;class mo{constructor(e,t,i,n,s){this.combine=e;this.compareInput=t;this.compare=i;this.isStatic=n;this.id=po++;this.default=e([]);this.extensions="function"==typeof s?s(this):s}static define(e={}){return new mo(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(!e.combine?go:(e,t)=>e===t),!!e.static,e.enables)}of(e){return new vo([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new vo(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new vo(e,this,2,t)}from(e,t){if(!t)t=e=>e;return this.compute([e],(i=>t(i.field(e))))}}function go(e,t){return e==t||e.length==t.length&&e.every(((e,i)=>e===t[i]))}class vo{constructor(e,t,i,n){this.dependencies=e;this.facet=t;this.type=i;this.value=n;this.id=po++}dynamicSlot(e){var t;let i=this.value;let n=this.facet.compareInput;let s=this.id,r=e[s]>>1,o=2==this.type;let l=false,a=false,h=[];for(let c of this.dependencies)if("doc"==c)l=true;else if("selection"==c)a=true;else if(0==(1&(null!==(t=e[c.id])&&void 0!==t?t:1)))h.push(e[c.id]);return{create(e){e.values[r]=i(e);return 1},update(e,t){if(l&&t.docChanged||a&&(t.docChanged||t.selection)||yo(e,h)){let t=i(e);if(o?!wo(t,e.values[r],n):!n(t,e.values[r])){e.values[r]=t;return 1}}return 0},reconfigure:(e,t)=>{let l=i(e);let a=t.config.address[s];if(null!=a){let i=_o(t,a);if(this.dependencies.every((i=>i instanceof mo?t.facet(i)===e.facet(i):i instanceof ko?t.field(i,false)==e.field(i,false):true))||(o?wo(l,i,n):n(l,i))){e.values[r]=i;return 0}}e.values[r]=l;return 1}}}}function wo(e,t,i){if(e.length!=t.length)return false;for(let n=0;n<e.length;n++)if(!i(e[n],t[n]))return false;return true}function yo(e,t){let i=false;for(let n of t)if(1&Ro(e,n))i=true;return i}function bo(e,t,i){let n=i.map((t=>e[t.id]));let s=i.map((e=>e.type));let r=n.filter((e=>!(1&e)));let o=e[t.id]>>1;function l(e){let i=[];for(let t=0;t<n.length;t++){let r=_o(e,n[t]);if(2==s[t])for(let e of r)i.push(e);else i.push(r)}return t.combine(i)}return{create(e){for(let t of n)Ro(e,t);e.values[o]=l(e);return 1},update(e,i){if(!yo(e,r))return 0;let n=l(e);if(t.compare(n,e.values[o]))return 0;e.values[o]=n;return 1},reconfigure(e,s){let r=yo(e,n);let a=s.config.facets[t.id],h=s.facet(t);if(a&&!r&&go(i,a)){e.values[o]=h;return 0}let c=l(e);if(t.compare(c,h)){e.values[o]=h;return 0}e.values[o]=c;return 1}}}const xo=mo.define({static:true});class ko{constructor(e,t,i,n,s){this.id=e;this.createF=t;this.updateF=i;this.compareF=n;this.spec=s;this.provides=void 0}static define(e){let t=new ko(po++,e.create,e.update,e.compare||((e,t)=>e===t),e);if(e.provide)t.provides=e.provide(t);return t}create(e){let t=e.facet(xo).find((e=>e.field==this));return((null===t||void 0===t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>{e.values[t]=this.create(e);return 1},update:(e,i)=>{let n=e.values[t];let s=this.updateF(n,i);if(this.compareF(n,s))return 0;e.values[t]=s;return 1},reconfigure:(e,i)=>{if(null!=i.config.address[this.id]){e.values[t]=i.field(this);return 0}e.values[t]=this.create(e);return 1}}}init(e){return[this,xo.of({field:this,create:e})]}get extension(){return this}}const So={lowest:4,low:3,default:2,high:1,highest:0};function Co(e){return t=>new Mo(t,e)}const Ao={highest:Co(So.highest),high:Co(So.high),default:Co(So.default),low:Co(So.low),lowest:Co(So.lowest)};class Mo{constructor(e,t){this.inner=e;this.prec=t}}class Oo{of(e){return new Do(this,e)}reconfigure(e){return Oo.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Do{constructor(e,t){this.compartment=e;this.inner=t}}class To{constructor(e,t,i,n,s,r){this.base=e;this.compartments=t;this.dynamicSlots=i;this.address=n;this.staticValues=s;this.facets=r;this.statusTemplate=[];while(this.statusTemplate.length<i.length)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let n=[];let s=Object.create(null);let r=new Map;for(let f of Eo(e,t,r))if(f instanceof ko)n.push(f);else(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let o=Object.create(null);let l=[];let a=[];for(let f of n){o[f.id]=a.length<<1;a.push((e=>f.slot(e)))}let h=null===i||void 0===i?void 0:i.config.facets;for(let f in s){let e=s[f],t=e[0].facet;let n=h&&h[f]||[];if(e.every((e=>0==e.type))){o[t.id]=l.length<<1|1;if(go(n,e))l.push(i.facet(t));else{let n=t.combine(e.map((e=>e.value)));l.push(i&&t.compare(n,i.facet(t))?i.facet(t):n)}}else{for(let t of e)if(0==t.type){o[t.id]=l.length<<1|1;l.push(t.value)}else{o[t.id]=a.length<<1;a.push((e=>t.dynamicSlot(e)))}o[t.id]=a.length<<1;a.push((i=>bo(i,t,e)))}}let c=a.map((e=>e(o)));return new To(e,r,c,o,l,s)}}function Eo(e,t,i){let n=[[],[],[],[],[]];let s=new Map;function r(e,o){let l=s.get(e);if(null!=l){if(l<=o)return;let t=n[l].indexOf(e);if(t>-1)n[l].splice(t,1);if(e instanceof Do)i.delete(e.compartment)}s.set(e,o);if(Array.isArray(e))for(let t of e)r(t,o);else if(e instanceof Do){if(i.has(e.compartment))throw new RangeError(`Duplicate use of compartment in extensions`);let n=t.get(e.compartment)||e.inner;i.set(e.compartment,n);r(n,o)}else if(e instanceof Mo)r(e.inner,e.prec);else if(e instanceof ko){n[o].push(e);if(e.provides)r(e.provides,o)}else if(e instanceof vo){n[o].push(e);if(e.facet.extensions)r(e.facet.extensions,So.default)}else{let t=e.extension;if(!t)throw new Error(`Unrecognized extension value in extension set (${e}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(t,o)}}r(e,So.default);return n.reduce(((e,t)=>e.concat(t)))}function Ro(e,t){if(1&t)return 2;let i=t>>1;let n=e.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;e.status[i]=4;let s=e.computeSlot(e,e.config.dynamicSlots[i]);return e.status[i]=2|s}function _o(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}const Bo=mo.define();const Lo=mo.define({combine:e=>e.some((e=>e)),static:true});const Po=mo.define({combine:e=>e.length?e[0]:void 0,static:true});const No=mo.define();const Io=mo.define();const Vo=mo.define();const Fo=mo.define({combine:e=>e.length?e[0]:false});class Ho{constructor(e,t){this.type=e;this.value=t}static define(){return new Wo}}class Wo{of(e){return new Ho(this,e)}}class zo{constructor(e){this.map=e}of(e){return new qo(this,e)}}class qo{constructor(e,t){this.type=e;this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new qo(this.type,t)}is(e){return this.type==e}static define(e={}){return new zo(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let n of e){let e=n.map(t);if(e)i.push(e)}return i}}qo.reconfigure=qo.define();qo.appendConfig=qo.define();class jo{constructor(e,t,i,n,s,r){this.startState=e;this.changes=t;this.selection=i;this.effects=n;this.annotations=s;this.scrollIntoView=r;this._doc=null;this._state=null;if(i)uo(i,t.newLength);if(!s.some((e=>e.type==jo.time)))this.annotations=s.concat(jo.time.of(Date.now()))}static create(e,t,i,n,s,r){return new jo(e,t,i,n,s,r)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){if(!this._state)this.startState.applyTransaction(this);return this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value;return}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(jo.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}}jo.time=Ho.define();jo.userEvent=Ho.define();jo.addToHistory=Ho.define();jo.remote=Ho.define();function $o(e,t){let i=[];for(let n=0,s=0;;){let r,o;if(n<e.length&&(s==t.length||t[s]>=e[n])){r=e[n++];o=e[n++]}else if(s<t.length){r=t[s++];o=t[s++]}else return i;if(!i.length||i[i.length-1]<r)i.push(r,o);else if(i[i.length-1]<o)i[i.length-1]=o}}function Uo(e,t,i){var n;let s,r,o;if(i){s=t.changes;r=no.empty(t.changes.length);o=e.changes.compose(t.changes)}else{s=t.changes.map(e.changes);r=e.changes.mapDesc(t.changes,true);o=e.changes.compose(s)}return{changes:o,selection:t.selection?t.selection.map(r):null===(n=e.selection)||void 0===n?void 0:n.map(s),effects:qo.mapEffects(e.effects,s).concat(qo.mapEffects(t.effects,r)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function Ko(e,t,i){let n=t.selection,s=Qo(t.annotations);if(t.userEvent)s=s.concat(jo.userEvent.of(t.userEvent));return{changes:t.changes instanceof no?t.changes:no.of(t.changes||[],i,e.facet(Po)),selection:n&&(n instanceof fo?n:fo.single(n.anchor,n.head)),effects:Qo(t.effects),annotations:s,scrollIntoView:!!t.scrollIntoView}}function Go(e,t,i){let n=Ko(e,t.length?t[0]:{},e.doc.length);if(t.length&&false===t[0].filter)i=false;for(let r=1;r<t.length;r++){if(false===t[r].filter)i=false;let s=!!t[r].sequential;n=Uo(n,Ko(e,t[r],s?n.changes.newLength:e.doc.length),s)}let s=jo.create(e,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return Xo(i?Jo(s):s)}function Jo(e){let t=e.startState;let i=true;for(let s of t.facet(No)){let t=s(e);if(false===t){i=false;break}if(Array.isArray(t))i=true===i?t:$o(i,t)}if(true!==i){let n,s;if(false===i){s=e.changes.invertedDesc;n=no.empty(t.doc.length)}else{let t=e.changes.filter(i);n=t.changes;s=t.filtered.mapDesc(t.changes).invertedDesc}e=jo.create(t,n,e.selection&&e.selection.map(s),qo.mapEffects(e.effects,s),e.annotations,e.scrollIntoView)}let n=t.facet(Io);for(let s=n.length-1;s>=0;s--){let i=n[s](e);if(i instanceof jo)e=i;else if(Array.isArray(i)&&1==i.length&&i[0]instanceof jo)e=i[0];else e=Go(t,Qo(i),false)}return e}function Xo(e){let t=e.startState,i=t.facet(Vo),n=e;for(let s=i.length-1;s>=0;s--){let r=i[s](e);if(r&&Object.keys(r).length)n=Uo(e,Ko(t,r,e.changes.newLength),true)}return n==e?e:jo.create(t,e.changes,e.selection,n.effects,n.annotations,n.scrollIntoView)}const Yo=[];function Qo(e){return null==e?Yo:Array.isArray(e)?e:[e]}var Zo=function(e){e[e["Word"]=0]="Word";e[e["Space"]=1]="Space";e[e["Other"]=2]="Other";return e}(Zo||(Zo={}));const el=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let tl;try{tl=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(ek){}function il(e){if(tl)return tl.test(e);for(let t=0;t<e.length;t++){let i=e[t];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||el.test(i)))return true}return false}function nl(e){return t=>{if(!/\S/.test(t))return Zo.Space;if(il(t))return Zo.Word;for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return Zo.Word;return Zo.Other}}class sl{constructor(e,t,i,n,s,r){this.config=e;this.doc=t;this.selection=i;this.values=n;this.status=e.statusTemplate.slice();this.computeSlot=s;if(r)r._state=this;for(let o=0;o<this.config.dynamicSlots.length;o++)Ro(this,o<<1);this.computeSlot=null}field(e,t=true){let i=this.config.address[e.id];if(null==i){if(t)throw new RangeError("Field is not present in this state");return}Ro(this,i);return _o(this,i)}update(...e){return Go(this,e,true)}applyTransaction(e){let t=this.config,{base:i,compartments:n}=t;for(let r of e.effects)if(r.is(Oo.reconfigure)){if(t){n=new Map;t.compartments.forEach(((e,t)=>n.set(t,e)));t=null}n.set(r.value.compartment,r.value.extension)}else if(r.is(qo.reconfigure)){t=null;i=r.value}else if(r.is(qo.appendConfig)){t=null;i=Qo(i).concat(r.value)}let s;if(!t){t=To.resolve(i,n,this);let e=new sl(t,this.doc,this.selection,t.dynamicSlots.map((()=>null)),((e,t)=>t.reconfigure(e,this)),null);s=e.values}else s=e.startState.values.slice();new sl(t,e.newDoc,e.newSelection,s,((t,i)=>i.update(t,e)),e)}replaceSelection(e){if("string"==typeof e)e=this.toText(e);return this.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:e},range:fo.cursor(t.from+e.length)})))}changeByRange(e){let t=this.selection;let i=e(t.ranges[0]);let n=this.changes(i.changes),s=[i.range];let r=Qo(i.effects);for(let o=1;o<t.ranges.length;o++){let i=e(t.ranges[o]);let l=this.changes(i.changes),a=l.map(n);for(let e=0;e<o;e++)s[e]=s[e].map(a);let h=n.mapDesc(l,true);s.push(i.range.map(h));n=n.compose(a);r=qo.mapEffects(r,a).concat(qo.mapEffects(Qo(i.effects),h))}return{changes:n,selection:fo.create(s,t.mainIndex),effects:r}}changes(e=[]){if(e instanceof no)return e;return no.of(e,this.doc.length,this.facet(sl.lineSeparator))}toText(e){return _r.of(e.split(this.facet(sl.lineSeparator)||eo))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];if(null==t)return e.default;Ro(this,t);return _o(this,t)}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let n=e[i];if(n instanceof ko&&null!=this.config.address[n.id])t[i]=n.spec.toJSON(this.field(e[i]),this)}return t}static fromJSON(e,t={},i){if(!e||"string"!=typeof e.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let s in i)if(Object.prototype.hasOwnProperty.call(e,s)){let t=i[s],r=e[s];n.push(t.init((e=>t.spec.fromJSON(r,e))))}return sl.create({doc:e.doc,selection:fo.fromJSON(e.selection),extensions:t.extensions?n.concat([t.extensions]):n})}static create(e={}){let t=To.resolve(e.extensions||[],new Map);let i=e.doc instanceof _r?e.doc:_r.of((e.doc||"").split(t.staticFacet(sl.lineSeparator)||eo));let n=!e.selection?fo.single(0):e.selection instanceof fo?e.selection:fo.single(e.selection.anchor,e.selection.head);uo(n,i.length);if(!t.staticFacet(Lo))n=n.asSingle();return new sl(t,i,n,t.dynamicSlots.map((()=>null)),((e,t)=>t.create(e)),null)}get tabSize(){return this.facet(sl.tabSize)}get lineBreak(){return this.facet(sl.lineSeparator)||"\n"}get readOnly(){return this.facet(Fo)}phrase(e,...t){for(let i of this.facet(sl.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}if(t.length)e=e.replace(/\$(\$|\d*)/g,((e,i)=>{if("$"==i)return"$";let n=+(i||1);return!n||n>t.length?e:t[n-1]}));return e}languageDataAt(e,t,i=-1){let n=[];for(let s of this.facet(Bo))for(let r of s(this,t,i))if(Object.prototype.hasOwnProperty.call(r,e))n.push(r[e]);return n}charCategorizer(e){return nl(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:n}=this.doc.lineAt(e);let s=this.charCategorizer(e);let r=e-i,o=e-i;while(r>0){let e=Ur(t,r,false);if(s(t.slice(e,r))!=Zo.Word)break;r=e}while(o<n){let e=Ur(t,o);if(s(t.slice(o,e))!=Zo.Word)break;o=e}return r==o?null:fo.range(r+i,o+i)}}sl.allowMultipleSelections=Lo;sl.tabSize=mo.define({combine:e=>e.length?e[0]:4});sl.lineSeparator=Po;sl.readOnly=Fo;sl.phrases=mo.define({compare(e,t){let i=Object.keys(e),n=Object.keys(t);return i.length==n.length&&i.every((i=>e[i]==t[i]))}});sl.languageData=Bo;sl.changeFilter=No;sl.transactionFilter=Io;sl.transactionExtender=Vo;Oo.reconfigure=qo.define();function rl(e,t,i={}){let n={};for(let s of e)for(let e of Object.keys(s)){let t=s[e],r=n[e];if(void 0===r)n[e]=t;else if(r===t||void 0===t);else if(Object.hasOwnProperty.call(i,e))n[e]=i[e](r,t);else throw new Error("Config merge conflict for field "+e)}for(let s in t)if(void 0===n[s])n[s]=t[s];return n}class ol{eq(e){return this==e}range(e,t=e){return ll.create(e,t,this)}}ol.prototype.startSide=ol.prototype.endSide=0;ol.prototype.point=false;ol.prototype.mapMode=to.TrackDel;class ll{constructor(e,t,i){this.from=e;this.to=t;this.value=i}static create(e,t,i){return new ll(e,t,i)}}function al(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class hl{constructor(e,t,i,n){this.from=e;this.to=t;this.value=i;this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,n=0){let s=i?this.to:this.from;for(let r=n,o=s.length;;){if(r==o)return r;let n=r+o>>1;let l=s[n]-e||(i?this.value[n].endSide:this.value[n].startSide)-t;if(n==r)return l>=0?r:o;if(l>=0)o=n;else r=n+1}}between(e,t,i,n){for(let s=this.findIndex(t,-1e9,true),r=this.findIndex(i,1e9,false,s);s<r;s++)if(false===n(this.from[s]+e,this.to[s]+e,this.value[s]))return false}map(e,t){let i=[],n=[],s=[],r=-1,o=-1;for(let l=0;l<this.value.length;l++){let a=this.value[l],h=this.from[l]+e,c=this.to[l]+e,f,u;if(h==c){let e=t.mapPos(h,a.startSide,a.mapMode);if(null==e)continue;f=u=e;if(a.startSide!=a.endSide){u=t.mapPos(h,a.endSide);if(u<f)continue}}else{f=t.mapPos(h,a.startSide);u=t.mapPos(c,a.endSide);if(f>u||f==u&&a.startSide>0&&a.endSide<=0)continue}if((u-f||a.endSide-a.startSide)<0)continue;if(r<0)r=f;if(a.point)o=Math.max(o,u-f);i.push(a);n.push(f-r);s.push(u-r)}return{mapped:i.length?new hl(n,s,i,o):null,pos:r}}}class cl{constructor(e,t,i,n){this.chunkPos=e;this.chunk=t;this.nextLayer=i;this.maxPoint=n}static create(e,t,i,n){return new cl(e,t,i,n)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=false,filterFrom:n=0,filterTo:s=this.length}=e;let r=e.filter;if(0==t.length&&!r)return this;if(i)t=t.slice().sort(al);if(this.isEmpty)return t.length?cl.of(t):this;let o=new pl(this,null,-1).goto(0),l=0,a=[];let h=new ul;while(o.value||l<t.length)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let e=t[l++];if(!h.addInner(e.from,e.to,e.value))a.push(e)}else if(1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!r||n>this.chunkEnd(o.chunkIndex)||s<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex]))o.nextChunk();else{if(!r||n>o.to||s<o.from||r(o.from,o.to,o.value))if(!h.addInner(o.from,o.to,o.value))a.push(ll.create(o.from,o.to,o.value));o.next()}return h.finishInner(this.nextLayer.isEmpty&&!a.length?cl.empty:this.nextLayer.update({add:a,filter:r,filterFrom:n,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],n=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r];let l=e.touchesRange(s,s+o.length);if(false===l){n=Math.max(n,o.maxPoint);t.push(o);i.push(e.mapPos(s))}else if(true===l){let{mapped:r,pos:l}=o.map(s,e);if(r){n=Math.max(n,r.maxPoint);t.push(r);i.push(l)}}}let s=this.nextLayer.map(e);return 0==t.length?s:new cl(i,t,s||cl.empty,n)}between(e,t,i){if(this.isEmpty)return;for(let n=0;n<this.chunk.length;n++){let s=this.chunkPos[n],r=this.chunk[n];if(t>=s&&e<=s+r.length&&false===r.between(s,e-s,t-s,i))return}this.nextLayer.between(e,t,i)}iter(e=0){return ml.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return ml.from(e).goto(t)}static compare(e,t,i,n,s=-1){let r=e.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=s));let o=t.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=s));let l=dl(r,o,i);let a=new vl(r,l,s);let h=new vl(o,l,s);i.iterGaps(((e,t,i)=>wl(a,e,h,t,i,n)));if(i.empty&&0==i.length)wl(a,0,h,0,0,n)}static eq(e,t,i=0,n){if(null==n)n=1e9;let s=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));let r=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0));if(s.length!=r.length)return false;if(!s.length)return true;let o=dl(s,r);let l=new vl(s,o,0).goto(i),a=new vl(r,o,0).goto(i);for(;;){if(l.to!=a.to||!yl(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return false;if(l.to>n)return true;l.next();a.next()}}static spans(e,t,i,n,s=-1){let r=new vl(e,null,s).goto(t),o=t;let l=r.openStart;for(;;){let e=Math.min(r.to,i);if(r.point){n.point(o,e,r.point,r.activeForPoint(r.to),l,r.pointRank);l=r.openEnd(e)+(r.to>e?1:0)}else if(e>o){n.span(o,e,r.active,l);l=r.openEnd(e)}if(r.to>i)break;o=r.to;r.next()}return l}static of(e,t=false){let i=new ul;for(let n of e instanceof ll?[e]:t?fl(e):e)i.add(n.from,n.to,n.value);return i.finish()}}cl.empty=new cl([],[],null,-1);function fl(e){if(e.length>1)for(let t=e[0],i=1;i<e.length;i++){let n=e[i];if(al(t,n)>0)return e.slice().sort(al);t=n}return e}cl.empty.nextLayer=cl.empty;class ul{constructor(){this.chunks=[];this.chunkPos=[];this.chunkStart=-1;this.last=null;this.lastFrom=-1e9;this.lastTo=-1e9;this.from=[];this.to=[];this.value=[];this.maxPoint=-1;this.setMaxPoint=-1;this.nextLayer=null}finishChunk(e){this.chunks.push(new hl(this.from,this.to,this.value,this.maxPoint));this.chunkPos.push(this.chunkStart);this.chunkStart=-1;this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint);this.maxPoint=-1;if(e){this.from=[];this.to=[];this.value=[]}}add(e,t,i){if(!this.addInner(e,t,i))(this.nextLayer||(this.nextLayer=new ul)).add(e,t,i)}addInner(e,t,i){let n=e-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");if(n<0)return false;if(250==this.from.length)this.finishChunk(true);if(this.chunkStart<0)this.chunkStart=e;this.from.push(e-this.chunkStart);this.to.push(t-this.chunkStart);this.last=i;this.lastFrom=e;this.lastTo=t;this.value.push(i);if(i.point)this.maxPoint=Math.max(this.maxPoint,t-e);return true}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return false;if(this.from.length)this.finishChunk(true);this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint);this.chunks.push(t);this.chunkPos.push(e);let i=t.value.length-1;this.last=t.value[i];this.lastFrom=t.from[i]+e;this.lastTo=t.to[i]+e;return true}finish(){return this.finishInner(cl.empty)}finishInner(e){if(this.from.length)this.finishChunk(false);if(0==this.chunks.length)return e;let t=cl.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);this.from=null;return t}}function dl(e,t,i){let n=new Map;for(let r of e)for(let e=0;e<r.chunk.length;e++)if(r.chunk[e].maxPoint<=0)n.set(r.chunk[e],r.chunkPos[e]);let s=new Set;for(let r of t)for(let e=0;e<r.chunk.length;e++){let t=n.get(r.chunk[e]);if(null!=t&&(i?i.mapPos(t):t)==r.chunkPos[e]&&!(null===i||void 0===i?void 0:i.touchesRange(t,t+r.chunk[e].length)))s.add(r.chunk[e])}return s}class pl{constructor(e,t,i,n=0){this.layer=e;this.skip=t;this.minPoint=i;this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){this.chunkIndex=this.rangeIndex=0;this.gotoInner(e,t,false);return this}gotoInner(e,t,i){while(this.chunkIndex<this.layer.chunk.length){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++;i=false}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,true);if(!i||this.rangeIndex<n)this.setRangeIndex(n)}this.next()}forward(e,t){if((this.to-e||this.endSide-t)<0)this.gotoInner(e,t,true)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9;this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex];let i=e+t.from[this.rangeIndex];this.from=i;this.to=e+t.to[this.rangeIndex];this.value=t.value[this.rangeIndex];this.setRangeIndex(this.rangeIndex+1);if(this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){this.chunkIndex++;if(this.skip)while(this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]))this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++;this.rangeIndex=0;this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class ml{constructor(e){this.heap=e}static from(e,t=null,i=-1){let n=[];for(let s=0;s<e.length;s++)for(let r=e[s];!r.isEmpty;r=r.nextLayer)if(r.maxPoint>=i)n.push(new pl(r,t,i,s));return 1==n.length?n[0]:new ml(n)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)gl(this.heap,i);this.next();return this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)gl(this.heap,i);if((this.to-e||this.value.endSide-t)<0)this.next()}next(){if(0==this.heap.length){this.from=this.to=1e9;this.value=null;this.rank=-1}else{let e=this.heap[0];this.from=e.from;this.to=e.to;this.value=e.value;this.rank=e.rank;if(e.value)e.next();gl(this.heap,0)}}}function gl(e,t){for(let i=e[t];;){let n=(t<<1)+1;if(n>=e.length)break;let s=e[n];if(n+1<e.length&&s.compare(e[n+1])>=0){s=e[n+1];n++}if(i.compare(s)<0)break;e[n]=i;e[t]=s;t=n}}class vl{constructor(e,t,i){this.minPoint=i;this.active=[];this.activeTo=[];this.activeRank=[];this.minActive=-1;this.point=null;this.pointFrom=0;this.pointRank=0;this.to=-1e9;this.endSide=0;this.openStart=-1;this.cursor=ml.from(e,t,i)}goto(e,t=-1e9){this.cursor.goto(e,t);this.active.length=this.activeTo.length=this.activeRank.length=0;this.minActive=-1;this.to=e;this.endSide=t;this.openStart=-1;this.next();return this}forward(e,t){while(this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){bl(this.active,e);bl(this.activeTo,e);bl(this.activeRank,e);this.minActive=kl(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:n,rank:s}=this.cursor;while(t<this.activeRank.length&&this.activeRank[t]<=s)t++;xl(this.active,t,i);xl(this.activeTo,t,n);xl(this.activeRank,t,s);if(e)xl(e,t,this.cursor.from);this.minActive=kl(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null,n=0;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s];this.endSide=this.active[s].endSide;break}this.removeActive(s);if(i)bl(i,s)}else if(!this.cursor.value){this.to=this.endSide=1e9;break}else if(this.cursor.from>e){this.to=this.cursor.from;this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point){this.addActive(i);if(this.cursor.from<e&&this.cursor.to>e)n++;this.cursor.next()}else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s;this.pointFrom=this.cursor.from;this.pointRank=this.cursor.rank;this.to=this.cursor.to;this.endSide=s.endSide;if(this.cursor.from<e)n=1;this.cursor.next();this.forward(this.to,this.endSide);break}}}if(i){let t=0;while(t<i.length&&i[t]<e)t++;this.openStart=t+n}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0;i--){if(this.activeRank[i]<this.pointRank)break;if(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)t.push(this.active[i])}return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function wl(e,t,i,n,s,r){e.goto(t);i.goto(n);let o=n+s;let l=n,a=n-t;for(;;){let t=e.to+a-i.to||e.endSide-i.endSide;let n=t<0?e.to+a:i.to,s=Math.min(n,o);if(e.point||i.point){if(!(e.point&&i.point&&(e.point==i.point||e.point.eq(i.point))&&yl(e.activeForPoint(e.to+a),i.activeForPoint(i.to))))r.comparePoint(l,s,e.point,i.point)}else if(s>l&&!yl(e.active,i.active))r.compareRange(l,s,e.active,i.active);if(n>o)break;l=n;if(t<=0)e.next();if(t>=0)i.next()}}function yl(e,t){if(e.length!=t.length)return false;for(let i=0;i<e.length;i++)if(e[i]!=t[i]&&!e[i].eq(t[i]))return false;return true}function bl(e,t){for(let i=t,n=e.length-1;i<n;i++)e[i]=e[i+1];e.pop()}function xl(e,t,i){for(let n=e.length-1;n>=t;n--)e[n+1]=e[n];e[t]=i}function kl(e,t){let i=-1,n=1e9;for(let s=0;s<t.length;s++)if((t[s]-n||e[s].endSide-e[i].endSide)<0){i=s;n=t[s]}return i}function Sl(e,t,i=e.length){let n=0;for(let s=0;s<i;)if(9==e.charCodeAt(s)){n+=t-n%t;s++}else{n++;s=Ur(e,s)}return n}function Cl(e,t,i,n){for(let s=0,r=0;;){if(r>=t)return s;if(s==e.length)break;r+=9==e.charCodeAt(s)?i-r%i:1;s=Ur(e,s)}return true===n?-1:e.length}const Al="ͼ";const Ml="undefined"==typeof Symbol?"__"+Al:Symbol.for(Al);const Ol="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet");const Dl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class Tl{constructor(e,t){this.rules=[];let{finish:i}=t||{};function n(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}function s(e,t,r,o){let l=[],a=/^@(\w+)\b/.exec(e[0]),h=a&&"keyframes"==a[1];if(a&&null==t)return r.push(e[0]+";");for(let i in t){let o=t[i];if(/&/.test(i))s(i.split(/,\s*/).map((t=>e.map((e=>t.replace(/&/,e))))).reduce(((e,t)=>e.concat(t))),o,r);else if(o&&"object"==typeof o){if(!a)throw new RangeError("The value of a property ("+i+") should be a primitive value.");s(n(i),o,l,h)}else if(null!=o)l.push(i.replace(/_.*/,"").replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))+": "+o+";")}if(l.length||h)r.push((i&&!a&&!o?e.map(i):e).join(", ")+" {"+l.join(" ")+"}")}for(let r in e)s(n(r),e[r],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=Dl[Ml]||1;Dl[Ml]=e+1;return Al+e.toString(36)}static mount(e,t){(e[Ol]||new Rl(e)).mount(Array.isArray(t)?t:[t])}}let El=null;class Rl{constructor(e){if(!e.head&&e.adoptedStyleSheets&&"undefined"!=typeof CSSStyleSheet){if(El){e.adoptedStyleSheets=[El.sheet].concat(e.adoptedStyleSheets);return e[Ol]=El}this.sheet=new CSSStyleSheet;e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets);El=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[];e[Ol]=this}mount(e){let t=this.sheet;let i=0,n=0;for(let s=0;s<e.length;s++){let r=e[s],o=this.modules.indexOf(r);if(o<n&&o>-1){this.modules.splice(o,1);n--;o=-1}if(-1==o){this.modules.splice(n++,0,r);if(t)for(let e=0;e<r.rules.length;e++)t.insertRule(r.rules[e],i++)}else{while(n<o)i+=this.modules[n++].rules.length;i+=r.rules.length;n++}}if(!t){let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e}}}var _l={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"};var Bl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};var Ll="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent);"undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent);var Pl="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);var Nl="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var Il=Pl||Ll&&+Ll[1]<57;for(var Vl=0;Vl<10;Vl++)_l[48+Vl]=_l[96+Vl]=String(Vl);for(var Vl=1;Vl<=24;Vl++)_l[Vl+111]="F"+Vl;for(var Vl=65;Vl<=90;Vl++){_l[Vl]=String.fromCharCode(Vl+32);Bl[Vl]=String.fromCharCode(Vl)}for(var Fl in _l)if(!Bl.hasOwnProperty(Fl))Bl[Fl]=_l[Fl];function Hl(e){var t=Il&&(e.ctrlKey||e.altKey||e.metaKey)||Nl&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key;var i=!t&&e.key||(e.shiftKey?Bl:_l)[e.keyCode]||e.key||"Unidentified";if("Esc"==i)i="Escape";if("Del"==i)i="Delete";if("Left"==i)i="ArrowLeft";if("Up"==i)i="ArrowUp";if("Right"==i)i="ArrowRight";if("Down"==i)i="ArrowDown";return i}function Wl(e){let t;if(11==e.nodeType)t=e.getSelection?e:e.ownerDocument;else t=e;return t.getSelection()}function zl(e,t){return t?e==t||e.contains(1!=t.nodeType?t.parentNode:t):false}function ql(e){let t=e.activeElement;while(t&&t.shadowRoot)t=t.shadowRoot.activeElement;return t}function jl(e,t){if(!t.anchorNode)return false;try{return zl(e,t.anchorNode)}catch(ek){return false}}function $l(e){if(3==e.nodeType)return sa(e,0,e.nodeValue.length).getClientRects();else if(1==e.nodeType)return e.getClientRects();else return[]}function Ul(e,t,i,n){return i?Gl(e,t,i,n,-1)||Gl(e,t,i,n,1):false}function Kl(e){for(var t=0;;t++){e=e.previousSibling;if(!e)return t}}function Gl(e,t,i,n,s){for(;;){if(e==i&&t==n)return true;if(t==(s<0?0:Jl(e))){if("DIV"==e.nodeName)return false;let i=e.parentNode;if(!i||1!=i.nodeType)return false;t=Kl(e)+(s<0?0:1);e=i}else if(1==e.nodeType){e=e.childNodes[t+(s<0?-1:0)];if(1==e.nodeType&&"false"==e.contentEditable)return false;t=s<0?Jl(e):0}else return false}}function Jl(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}const Xl={left:0,right:0,top:0,bottom:0};function Yl(e,t){let i=t?e.left:e.right;return{left:i,right:i,top:e.top,bottom:e.bottom}}function Ql(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}function Zl(e,t,i,n,s,r,o,l){let a=e.ownerDocument,h=a.defaultView;for(let c=e;c;)if(1==c.nodeType){let e,f=c==a.body;if(f)e=Ql(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let t=c.getBoundingClientRect();e={left:t.left,right:t.left+c.clientWidth,top:t.top,bottom:t.top+c.clientHeight}}let u=0,d=0;if("nearest"==s){if(t.top<e.top){d=-(e.top-t.top+o);if(i>0&&t.bottom>e.bottom+d)d=t.bottom-e.bottom+d+o}else if(t.bottom>e.bottom){d=t.bottom-e.bottom+o;if(i<0&&t.top-d<e.top)d=-(e.top+d-t.top+o)}}else{let n=t.bottom-t.top,r=e.bottom-e.top;let l="center"==s&&n<=r?t.top+n/2-r/2:"start"==s||"center"==s&&i<0?t.top-o:t.bottom-r+o;d=l-e.top}if("nearest"==n){if(t.left<e.left){u=-(e.left-t.left+r);if(i>0&&t.right>e.right+u)u=t.right-e.right+u+r}else if(t.right>e.right){u=t.right-e.right+r;if(i<0&&t.left<e.left+u)u=-(e.left+u-t.left+r)}}else{let i="center"==n?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==n==l?t.left-r:t.right-(e.right-e.left)+r;u=i-e.left}if(u||d)if(f)h.scrollBy(u,d);else{if(d){let e=c.scrollTop;c.scrollTop+=d;d=c.scrollTop-e}if(u){let e=c.scrollLeft;c.scrollLeft+=u;u=c.scrollLeft-e}t={left:t.left-u,top:t.top-d,right:t.right-u,bottom:t.bottom-d}}if(f)break;c=c.assignedSlot||c.parentNode;n=s="nearest"}else if(11==c.nodeType)c=c.host;else break}class ea{constructor(){this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,i,n){this.anchorNode=e;this.anchorOffset=t;this.focusNode=i;this.focusOffset=n}}let ta=null;function ia(e){if(e.setActive)return e.setActive();if(ta)return e.focus(ta);let t=[];for(let i=e;i;i=i.parentNode){t.push(i,i.scrollTop,i.scrollLeft);if(i==i.ownerDocument)break}e.focus(null==ta?{get preventScroll(){ta={preventScroll:true};return true}}:void 0);if(!ta){ta=false;for(let e=0;e<t.length;){let i=t[e++],n=t[e++],s=t[e++];if(i.scrollTop!=n)i.scrollTop=n;if(i.scrollLeft!=s)i.scrollLeft=s}}}let na;function sa(e,t,i=t){let n=na||(na=document.createRange());n.setEnd(e,i);n.setStart(e,t);return n}function ra(e,t,i){let n={key:t,code:t,keyCode:i,which:i,cancelable:true};let s=new KeyboardEvent("keydown",n);s.synthetic=true;e.dispatchEvent(s);let r=new KeyboardEvent("keyup",n);r.synthetic=true;e.dispatchEvent(r);return s.defaultPrevented||r.defaultPrevented}function oa(e){while(e){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}function la(e){while(e.attributes.length)e.removeAttributeNode(e.attributes[0])}function aa(e,t){let i=t.focusNode,n=t.focusOffset;if(!i||t.anchorNode!=i||t.anchorOffset!=n)return false;for(;;)if(n){if(1!=i.nodeType)return false;let e=i.childNodes[n-1];if("false"==e.contentEditable)n--;else{i=e;n=Jl(i)}}else if(i==e)return true;else{n=Kl(i);i=i.parentNode}}class ha{constructor(e,t,i=true){this.node=e;this.offset=t;this.precise=i}static before(e,t){return new ha(e.parentNode,Kl(e),t)}static after(e,t){return new ha(e.parentNode,Kl(e)+1,t)}}const ca=[];class fa{constructor(){this.parent=null;this.dom=null;this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(2&this.dirty){let t=this.dom;let i=null,n;for(let s of this.children){if(s.dirty){if(!s.dom&&(n=i?i.nextSibling:t.firstChild)){let e=fa.get(n);if(!e||!e.parent&&e.constructor==s.constructor)s.reuseDOM(n)}s.sync(e);s.dirty=0}n=i?i.nextSibling:t.firstChild;if(e&&!e.written&&e.node==t&&n!=s.dom)e.written=true;if(s.dom.parentNode==t)while(n&&n!=s.dom)n=ua(n);else t.insertBefore(s.dom,n);i=s.dom}n=i?i.nextSibling:t.firstChild;if(n&&e&&e.node==t)e.written=true;while(n)n=ua(n)}else if(1&this.dirty)for(let t of this.children)if(t.dirty){t.sync(e);t.dirty=0}}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let n=0==Jl(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==this.dom)break;if(0==n&&t.firstChild!=t.lastChild)if(e==t.firstChild)n=-1;else n=1;e=t}if(n<0)i=e;else i=e.nextSibling}if(i==this.dom.firstChild)return 0;while(i&&!fa.get(i))i=i.nextSibling;if(!i)return this.length;for(let n=0,s=0;;n++){let e=this.children[n];if(e.dom==i)return s;s+=e.length+e.breakAfter}}domBoundsAround(e,t,i=0){let n=-1,s=-1,r=-1,o=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<e&&c>t)return i.domBoundsAround(e,t,a);if(c>=e&&-1==n){n=l;s=a}if(a>t&&i.dom.parentNode==this.dom){r=l;o=h;break}h=c;a=c+i.breakAfter}return{from:s,to:o<0?i+this.length:o,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:r<this.children.length&&r>=0?this.children[r].dom:null}}markDirty(e=false){this.dirty|=2;this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e)t.dirty|=2;if(1&t.dirty)return;t.dirty|=1;e=false}}setParent(e){if(this.parent!=e){this.parent=e;if(this.dirty)this.markParentsDirty(true)}}setDOM(e){if(this.dom)this.dom.cmView=null;this.dom=e;e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=ca){this.markDirty();for(let n=e;n<t;n++){let e=this.children[n];if(e.parent==this)e.destroy()}this.children.splice(e,t-e,...i);for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(e){return false}ignoreEvent(e){return false}childCursor(e=this.length){return new da(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return true}merge(e,t,i,n,s,r){return false}become(e){return false}getSide(){return 0}destroy(){this.parent=null}}fa.prototype.breakAfter=0;function ua(e){let t=e.nextSibling;e.parentNode.removeChild(e);return t}class da{constructor(e,t,i){this.children=e;this.pos=t;this.i=i;this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter)){this.off=e-this.pos;return this}let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function pa(e,t,i,n,s,r,o,l,a){let{children:h}=e;let c=h.length?h[t]:null;let f=r.length?r[r.length-1]:null;let u=f?f.breakAfter:o;if(t==n&&c&&!o&&!u&&r.length<2&&c.merge(i,s,r.length?f:null,0==i,l,a))return;if(n<h.length){let e=h[n];if(e&&s<e.length){if(t==n){e=e.split(s);s=0}if(!u&&f&&e.merge(0,s,f,true,0,a))r[r.length-1]=e;else{if(s)e.merge(0,s,null,false,0,a);r.push(e)}}else if(null===e||void 0===e?void 0:e.breakAfter)if(f)f.breakAfter=1;else o=1;n++}if(c){c.breakAfter=o;if(i>0){if(!o&&r.length&&c.merge(i,c.length,r[0],false,l,0))c.breakAfter=r.shift().breakAfter;else if(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)c.merge(i,c.length,null,false,l,0);t++}}while(t<n&&r.length)if(h[n-1].become(r[r.length-1])){n--;r.pop();a=r.length?0:l}else if(h[t].become(r[0])){t++;r.shift();l=r.length?0:a}else break;if(!r.length&&t&&n<h.length&&!h[t-1].breakAfter&&h[n].merge(0,0,h[t-1],false,l,a))t--;if(t<n||r.length)e.replaceChildren(t,n,r)}function ma(e,t,i,n,s,r){let o=e.childCursor();let{i:l,off:a}=o.findPos(i,1);let{i:h,off:c}=o.findPos(t,-1);let f=t-i;for(let u of n)f+=u.length;e.length+=f;pa(e,h,c,l,a,n,0,s,r)}let ga="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""};let va="undefined"!=typeof document?document:{documentElement:{style:{}}};const wa=/Edge\/(\d+)/.exec(ga.userAgent);const ya=/MSIE \d/.test(ga.userAgent);const ba=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ga.userAgent);const xa=!!(ya||ba||wa);const ka=!xa&&/gecko\/(\d+)/i.test(ga.userAgent);const Sa=!xa&&/Chrome\/(\d+)/.exec(ga.userAgent);const Ca="webkitFontSmoothing"in va.documentElement.style;const Aa=!xa&&/Apple Computer/.test(ga.vendor);const Ma=Aa&&(/Mobile\/\w+/.test(ga.userAgent)||ga.maxTouchPoints>2);var Oa={mac:Ma||/Mac/.test(ga.platform),windows:/Win/.test(ga.platform),linux:/Linux|X11/.test(ga.platform),ie:xa,ie_version:ya?va.documentMode||6:ba?+ba[1]:wa?+wa[1]:0,gecko:ka,gecko_version:ka?+(/Firefox\/(\d+)/.exec(ga.userAgent)||[0,0])[1]:0,chrome:!!Sa,chrome_version:Sa?+Sa[1]:0,ios:Ma,android:/Android\b/.test(ga.userAgent),webkit:Ca,safari:Aa,webkit_version:Ca?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=va.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};const Da=256;class Ta extends fa{constructor(e){super();this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){if(!this.dom)this.createDOM();if(this.dom.nodeValue!=this.text){if(e&&e.node==this.dom)e.written=true;this.dom.nodeValue=this.text}}reuseDOM(e){if(3==e.nodeType)this.createDOM(e)}merge(e,t,i){if(i&&(!(i instanceof Ta)||this.length-(t-e)+i.length>Da))return false;this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t);this.markDirty();return true}split(e){let t=new Ta(this.text.slice(e));this.text=this.text.slice(0,e);this.markDirty();return t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new ha(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Ra(this.dom,e,t)}}class Ea extends fa{constructor(e,t=[],i=0){super();this.mark=e;this.children=t;this.length=i;for(let n of t)n.setParent(this)}setAttrs(e){la(e);if(this.mark.class)e.className=this.mark.class;if(this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){if(e.nodeName==this.mark.tagName.toUpperCase()){this.setDOM(e);this.dirty|=4|2}}sync(e){if(!this.dom)this.setDOM(this.setAttrs(document.createElement(this.mark.tagName)));else if(4&this.dirty)this.setAttrs(this.dom);super.sync(e)}merge(e,t,i,n,s,r){if(i&&(!(i instanceof Ea&&i.mark.eq(this.mark))||e&&s<=0||t<this.length&&r<=0))return false;ma(this,e,t,i?i.children:[],s-1,r-1);this.markDirty();return true}split(e){let t=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;if(r>e)t.push(i<e?o.split(e-i):o);if(n<0&&i>=e)n=s;i=r;s++}let r=this.length-e;this.length=e;if(n>-1){this.children.length=n;this.markDirty()}return new Ea(this.mark,t,r)}domAtPos(e){return Va(this,e)}coordsAt(e,t){return Ha(this,e,t)}}function Ra(e,t,i){let n=e.nodeValue.length;if(t>n)t=n;let s=t,r=t,o=0;if(0==t&&i<0||t==n&&i>=0){if(!(Oa.chrome||Oa.gecko))if(t){s--;o=1}else if(r<n){r++;o=-1}}else if(i<0)s--;else if(r<n)r++;let l=sa(e,s,r).getClientRects();if(!l.length)return Xl;let a=l[(o?o<0:i>=0)?0:l.length-1];if(Oa.safari&&!o&&0==a.width)a=Array.prototype.find.call(l,(e=>e.width))||a;return o?Yl(a,o<0):a||null}class _a extends fa{constructor(e,t,i){super();this.widget=e;this.length=t;this.side=i;this.prevWidget=null}static create(e,t,i){return new(e.customView||_a)(e,t,i)}split(e){let t=_a.create(this.widget,this.length-e,this.side);this.length-=e;return t}sync(){if(!this.dom||!this.widget.updateDOM(this.dom)){if(this.dom&&this.prevWidget)this.prevWidget.destroy(this.dom);this.prevWidget=null;this.setDOM(this.widget.toDOM(this.editorView));this.dom.contentEditable="false"}}getSide(){return this.side}merge(e,t,i,n,s,r){if(i&&(!(i instanceof _a)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&r<=0))return false;this.length=e+(i?i.length:0)+(this.length-t);return true}become(e){if(e.length==this.length&&e instanceof _a&&e.side==this.side)if(this.widget.constructor==e.widget.constructor){if(!this.widget.eq(e.widget))this.markDirty(true);if(this.dom&&!this.prevWidget)this.prevWidget=this.widget;this.widget=e.widget;return true}return false}ignoreMutation(){return true}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return _r.empty;let e=this;while(e.parent)e=e.parent;let t=e.editorView,i=t&&t.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):_r.empty}domAtPos(e){return 0==e?ha.before(this.dom):ha.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),n=null;if(!i.length)return Xl;for(let s=e>0?i.length-1:0;;s+=e>0?-1:1){n=i[s];if(e>0?0==s:s==i.length-1||n.top<n.bottom)break}return 0==e&&t>0||e==this.length&&t<=0?n:Yl(n,0==e)}get isEditable(){return false}destroy(){super.destroy();if(this.dom)this.widget.destroy(this.dom)}}class Ba extends _a{domAtPos(e){let{topView:t,text:i}=this.widget;if(!t)return new ha(i,Math.min(e,i.nodeValue.length));return La(e,0,t,i,((e,t)=>e.domAtPos(t)),(e=>new ha(i,Math.min(e,i.nodeValue.length))))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:i,text:n}=this.widget;if(!i)return Math.min(t,this.length);return Pa(e,t,i,n)}ignoreMutation(){return false}get overrideDOMText(){return null}coordsAt(e,t){let{topView:i,text:n}=this.widget;if(!i)return Ra(n,e,t);return La(e,t,i,n,((e,t,i)=>e.coordsAt(t,i)),((e,t)=>Ra(n,e,t)))}destroy(){var e;super.destroy();null===(e=this.widget.topView)||void 0===e?void 0:e.destroy()}get isEditable(){return true}}function La(e,t,i,n,s,r){if(i instanceof Ea){for(let o=i.dom.firstChild;o;o=o.nextSibling){let i=fa.get(o);if(!i)return r(e,t);let l=zl(o,n);let a=i.length+(l?n.nodeValue.length:0);if(e<a||e==a&&i.getSide()<=0)return l?La(e,t,i,n,s,r):s(i,e,t);e-=a}return s(i,i.length,-1)}else if(i.dom==n)return r(e,t);else return s(i,e,t)}function Pa(e,t,i,n){if(i instanceof Ea)for(let s of i.children){let i=0,r=zl(s.dom,n);if(zl(s.dom,e))return i+(r?Pa(e,t,s,n):s.localPosFromDOM(e,t));i+=r?n.nodeValue.length:s.length}else if(i.dom==n)return Math.min(t,n.nodeValue.length);return i.localPosFromDOM(e,t)}class Na extends fa{constructor(e){super();this.side=e}get length(){return 0}merge(){return false}become(e){return e instanceof Na&&e.side==this.side}split(){return new Na(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer";e.setAttribute("aria-hidden","true");this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return ha.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect();let i=Ia(this,this.side>0?-1:1);return i&&i.top<t.bottom&&i.bottom>t.top?{left:t.left,right:t.right,top:i.top,bottom:i.bottom}:t}get overrideDOMText(){return _r.empty}}Ta.prototype.children=_a.prototype.children=Na.prototype.children=ca;function Ia(e,t){let i=e.parent,n=i?i.children.indexOf(e):-1;while(i&&n>=0)if(t<0?n>0:n<i.children.length){let e=i.children[n+t];if(e instanceof Ta){let i=e.coordsAt(t<0?e.length:0,t);if(i)return i}n+=t}else if(i instanceof Ea&&i.parent){n=i.parent.children.indexOf(i)+(t<0?0:1);i=i.parent}else{let e=i.dom.lastChild;if(e&&"BR"==e.nodeName)return e.getClientRects()[0];break}return}function Va(e,t){let i=e.dom,{children:n}=e,s=0;for(let r=0;s<n.length;s++){let e=n[s],o=r+e.length;if(o==r&&e.getSide()<=0)continue;if(t>r&&t<o&&e.dom.parentNode==i)return e.domAtPos(t-r);if(t<=r)break;r=o}for(let r=s;r>0;r--){let e=n[r-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let r=s;r<n.length;r++){let e=n[r];if(e.dom.parentNode==i)return e.domAtPos(0)}return new ha(i,0)}function Fa(e,t,i){let n,{children:s}=e;if(i>0&&t instanceof Ea&&s.length&&(n=s[s.length-1])instanceof Ea&&n.mark.eq(t.mark))Fa(n,t.children[0],i-1);else{s.push(t);t.setParent(e)}e.length+=t.length}function Ha(e,t,i){for(let r=0,o=0;o<e.children.length;o++){let n=e.children[o],s=r+n.length,l;if((i<=0||s==e.length||n.getSide()>0?s>=t:s>t)&&(t<s||o+1==e.children.length||(l=e.children[o+1]).length||l.getSide()>0)){let e=0;if(s==r){if(n.getSide()<=0)continue;e=i=-n.getSide()}let o=n.coordsAt(Math.max(0,t-r),i);return e&&o?Yl(o,i<0):o}r=s}let n=e.dom.lastChild;if(!n)return e.dom.getBoundingClientRect();let s=$l(n);return s[s.length-1]||null}function Wa(e,t){for(let i in e)if("class"==i&&t.class)t.class+=" "+e.class;else if("style"==i&&t.style)t.style+=";"+e.style;else t[i]=e[i];return t}function za(e,t){if(e==t)return true;if(!e||!t)return false;let i=Object.keys(e),n=Object.keys(t);if(i.length!=n.length)return false;for(let s of i)if(-1==n.indexOf(s)||e[s]!==t[s])return false;return true}function qa(e,t,i){let n=null;if(t)for(let s in t)if(!(i&&s in i))e.removeAttribute(n=s);if(i)for(let s in i)if(!(t&&t[s]==i[s]))e.setAttribute(n=s,i[s]);return!!n}class ja{eq(e){return false}updateDOM(e){return false}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return true}get customView(){return null}destroy(e){}}var $a=function(e){e[e["Text"]=0]="Text";e[e["WidgetBefore"]=1]="WidgetBefore";e[e["WidgetAfter"]=2]="WidgetAfter";e[e["WidgetRange"]=3]="WidgetRange";return e}($a||($a={}));class Ua extends ol{constructor(e,t,i,n){super();this.startSide=e;this.endSide=t;this.widget=i;this.spec=n}get heightRelevant(){return false}static mark(e){return new Ka(e)}static widget(e){let t=e.side||0,i=!!e.block;t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8;return new Ja(e,t,t,i,e.widget||null,false)}static replace(e){let t=!!e.block,i,n;if(e.isBlockGap){i=-5e8;n=4e8}else{let{start:s,end:r}=Xa(e,t);i=(s?t?-3e8:-1:5e8)-1;n=(r?t?2e8:1:-6e8)+1}return new Ja(e,i,n,t,e.widget||null,true)}static line(e){return new Ga(e)}static set(e,t=false){return cl.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:false}}Ua.none=cl.empty;class Ka extends Ua{constructor(e){let{start:t,end:i}=Xa(e);super(t?-1:5e8,i?1:-6e8,null,e);this.tagName=e.tagName||"span";this.class=e.class||"";this.attrs=e.attributes||null}eq(e){return this==e||e instanceof Ka&&this.tagName==e.tagName&&this.class==e.class&&za(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Ka.prototype.point=false;class Ga extends Ua{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Ga&&za(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Ga.prototype.mapMode=to.TrackBefore;Ga.prototype.point=true;class Ja extends Ua{constructor(e,t,i,n,s,r){super(t,i,s,e);this.block=n;this.isReplace=r;this.mapMode=!n?to.TrackDel:t<=0?to.TrackBefore:to.TrackAfter}get type(){return this.startSide<this.endSide?$a.WidgetRange:this.startSide<=0?$a.WidgetBefore:$a.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Ja&&Ya(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Ja.prototype.point=true;function Xa(e,t=false){let{inclusiveStart:i,inclusiveEnd:n}=e;if(null==i)i=e.inclusive;if(null==n)n=e.inclusive;return{start:null!==i&&void 0!==i?i:t,end:null!==n&&void 0!==n?n:t}}function Ya(e,t){return e==t||!!(e&&t&&e.compare(t))}function Qa(e,t,i,n=0){let s=i.length-1;if(s>=0&&i[s]+n>=e)i[s]=Math.max(i[s],t);else i.push(e,t)}class Za extends fa{constructor(){super(...arguments);this.children=[];this.length=0;this.prevAttrs=void 0;this.attrs=null;this.breakAfter=0}merge(e,t,i,n,s,r){if(i){if(!(i instanceof Za))return false;if(!this.dom)i.transferDOM(this)}if(n)this.setDeco(i?i.attrs:null);ma(this,e,t,i?i.children:[],s,r);return true}split(e){let t=new Za;t.breakAfter=this.breakAfter;if(0==this.length)return t;let{i,off:n}=this.childPos(e);if(n){t.append(this.children[i].split(n),0);this.children[i].merge(n,this.children[i].length,null,false,0,0);i++}for(let s=i;s<this.children.length;s++)t.append(this.children[s],0);while(i>0&&0==this.children[i-1].length)this.children[--i].destroy();this.children.length=i;this.markDirty();this.length=e;return t}transferDOM(e){if(!this.dom)return;this.markDirty();e.setDOM(this.dom);e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs;this.prevAttrs=void 0;this.dom=null}setDeco(e){if(!za(this.attrs,e)){if(this.dom){this.prevAttrs=this.attrs;this.markDirty()}this.attrs=e}}append(e,t){Fa(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;if(t)this.attrs=Wa(t,this.attrs||{});if(i)this.attrs=Wa({class:i},this.attrs||{})}domAtPos(e){return Va(this,e)}reuseDOM(e){if("DIV"==e.nodeName){this.setDOM(e);this.dirty|=4|2}}sync(e){var t;if(!this.dom){this.setDOM(document.createElement("div"));this.dom.className="cm-line";this.prevAttrs=this.attrs?null:void 0}else if(4&this.dirty){la(this.dom);this.dom.className="cm-line";this.prevAttrs=this.attrs?null:void 0}if(void 0!==this.prevAttrs){qa(this.dom,this.prevAttrs,this.attrs);this.dom.classList.add("cm-line");this.prevAttrs=void 0}super.sync(e);let i=this.dom.lastChild;while(i&&fa.get(i)instanceof Ea)i=i.lastChild;if(!i||!this.length||"BR"!=i.nodeName&&false==(null===(t=fa.get(i))||void 0===t?void 0:t.isEditable)&&(!Oa.ios||!this.children.some((e=>e instanceof Ta)))){let e=document.createElement("BR");e.cmIgnore=true;this.dom.appendChild(e)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof Ta)||/[^ -~]/.test(t.text))return null;let i=$l(t.dom);if(1!=i.length)return null;e+=i[0].width}return!e?null:{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}}coordsAt(e,t){return Ha(this,e,t)}become(e){return false}get type(){return $a.Text}static find(e,t){for(let i=0,n=0;i<e.children.length;i++){let s=e.children[i],r=n+s.length;if(r>=t){if(s instanceof Za)return s;if(r>t)break}n=r+s.breakAfter}return null}}class eh extends fa{constructor(e,t,i){super();this.widget=e;this.length=t;this.type=i;this.breakAfter=0;this.prevWidget=null}merge(e,t,i,n,s,r){if(i&&(!(i instanceof eh)||!this.widget.compare(i.widget)||e>0&&s<=0||t<this.length&&r<=0))return false;this.length=e+(i?i.length:0)+(this.length-t);return true}domAtPos(e){return 0==e?ha.before(this.dom):ha.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new eh(this.widget,t,this.type);i.breakAfter=this.breakAfter;return i}get children(){return ca}sync(){if(!this.dom||!this.widget.updateDOM(this.dom)){if(this.dom&&this.prevWidget)this.prevWidget.destroy(this.dom);this.prevWidget=null;this.setDOM(this.widget.toDOM(this.editorView));this.dom.contentEditable="false"}}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):_r.empty}domBoundsAround(){return null}become(e){if(e instanceof eh&&e.type==this.type&&e.widget.constructor==this.widget.constructor){if(!e.widget.eq(this.widget))this.markDirty(true);if(this.dom&&!this.prevWidget)this.prevWidget=this.widget;this.widget=e.widget;this.length=e.length;this.breakAfter=e.breakAfter;return true}return false}ignoreMutation(){return true}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy();if(this.dom)this.widget.destroy(this.dom)}}class th{constructor(e,t,i,n){this.doc=e;this.pos=t;this.end=i;this.disallowBlockEffectsFor=n;this.content=[];this.curLine=null;this.breakAtStart=0;this.pendingBuffer=0;this.atCursorPos=true;this.openStart=-1;this.openEnd=-1;this.text="";this.textOff=0;this.cursor=e.iter();this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof eh&&e.type==$a.WidgetBefore)}getLine(){if(!this.curLine){this.content.push(this.curLine=new Za);this.atCursorPos=true}return this.curLine}flushBuffer(e){if(this.pendingBuffer){this.curLine.append(ih(new Na(-1),e),e.length);this.pendingBuffer=0}}addBlockWidget(e){this.flushBuffer([]);this.curLine=null;this.content.push(e)}finish(e){if(!e)this.flushBuffer([]);else this.pendingBuffer=0;if(!this.posCovered())this.getLine()}buildText(e,t,i){while(e>0){if(this.textOff==this.text.length){let{value:t,lineBreak:i,done:n}=this.cursor.next(this.skip);this.skip=0;if(n)throw new Error("Ran out of text content when drawing inline views");if(i){if(!this.posCovered())this.getLine();if(this.content.length)this.content[this.content.length-1].breakAfter=1;else this.breakAtStart=1;this.flushBuffer([]);this.curLine=null;e--;continue}else{this.text=t;this.textOff=0}}let n=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(0,i));this.getLine().append(ih(new Ta(this.text.slice(this.textOff,this.textOff+n)),t),i);this.atCursorPos=true;this.textOff+=n;e-=n;i=0}}span(e,t,i,n){this.buildText(t-e,i,n);this.pos=t;if(this.openStart<0)this.openStart=n}point(e,t,i,n,s,r){if(this.disallowBlockEffectsFor[r]&&i instanceof Ja){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(i instanceof Ja)if(i.block){let{type:e}=i;if(e==$a.WidgetAfter&&!this.posCovered())this.getLine();this.addBlockWidget(new eh(i.widget||new nh("div"),o,e))}else{let r=_a.create(i.widget||new nh("span"),o,i.startSide);let l=this.atCursorPos&&!r.isEditable&&s<=n.length&&(e<t||i.startSide>0);let a=!r.isEditable&&(e<t||i.startSide<=0);let h=this.getLine();if(2==this.pendingBuffer&&!l)this.pendingBuffer=0;this.flushBuffer(n);if(l){h.append(ih(new Na(1),n),s);s=n.length+Math.max(0,s-n.length)}h.append(ih(r,n),s);this.atCursorPos=a;this.pendingBuffer=!a?0:e<t?1:2}else if(this.doc.lineAt(this.pos).from==this.pos)this.getLine().addLineDeco(i);if(o){if(this.textOff+o<=this.text.length)this.textOff+=o;else{this.skip+=o-(this.text.length-this.textOff);this.text="";this.textOff=0}this.pos=t}if(this.openStart<0)this.openStart=s}static build(e,t,i,n,s){let r=new th(e,t,i,s);r.openEnd=cl.spans(n,t,i,r);if(r.openStart<0)r.openStart=r.openEnd;r.finish(r.openEnd);return r}}function ih(e,t){for(let i of t)e=new Ea(i,[e],e.length);return e}class nh extends ja{constructor(e){super();this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const sh=mo.define();const rh=mo.define();const oh=mo.define();const lh=mo.define();const ah=mo.define();const hh=mo.define();const ch=mo.define({combine:e=>e.some((e=>e))});class fh{constructor(e,t="nearest",i="nearest",n=5,s=5){this.range=e;this.y=t;this.x=i;this.yMargin=n;this.xMargin=s}map(e){return e.empty?this:new fh(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const uh=qo.define({map:(e,t)=>e.map(t)});function dh(e,t,i){let n=e.facet(lh);if(n.length)n[0](t);else if(window.onerror)window.onerror(String(t),i,void 0,void 0,t);else if(i)void 0;else void 0}const ph=mo.define({combine:e=>e.length?e[0]:true});let mh=0;const gh=mo.define();class vh{constructor(e,t,i,n){this.id=e;this.create=t;this.domEventHandlers=i;this.extension=n(this)}static define(e,t){const{eventHandlers:i,provide:n,decorations:s}=t||{};return new vh(mh++,e,i,(e=>{let t=[gh.of(e)];if(s)t.push(xh.of((t=>{let i=t.plugin(e);return i?s(i):Ua.none})));if(n)t.push(n(e));return t}))}static fromClass(e,t){return vh.define((t=>new e(t)),t)}}class wh{constructor(e){this.spec=e;this.mustUpdate=null;this.value=null}update(e){if(!this.value){if(this.spec)try{this.value=this.spec.create(e)}catch(t){dh(e.state,t,"CodeMirror plugin crashed");this.deactivate()}}else if(this.mustUpdate){let e=this.mustUpdate;this.mustUpdate=null;if(this.value.update)try{this.value.update(e)}catch(t){dh(e.state,t,"CodeMirror plugin crashed");if(this.value.destroy)try{this.value.destroy()}catch(ek){}this.deactivate()}}return this}destroy(e){var t;if(null===(t=this.value)||void 0===t?void 0:t.destroy)try{this.value.destroy()}catch(i){dh(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const yh=mo.define();const bh=mo.define();const xh=mo.define();const kh=mo.define();const Sh=mo.define();const Ch=mo.define();class Ah{constructor(e,t,i,n){this.fromA=e;this.toA=t;this.fromB=i;this.toB=n}join(e){return new Ah(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let n=e[t-1];if(n.fromA>i.toA)continue;if(n.toA<i.fromA)break;i=i.join(n);e.splice(t-1,1)}e.splice(t,0,i);return e}static extendWithRanges(e,t){if(0==t.length)return e;let i=[];for(let n=0,s=0,r=0,o=0;;n++){let l=n==e.length?null:e[n],a=r-o;let h=l?l.fromB:1e9;while(s<t.length&&t[s]<h){let e=t[s],n=t[s+1];let r=Math.max(o,e),l=Math.min(h,n);if(r<=l)new Ah(r+a,l+a,r,l).addToSet(i);if(n>h)break;else s+=2}if(!l)return i;new Ah(l.fromA,l.toA,l.fromB,l.toB).addToSet(i);r=l.toA;o=l.toB}}}class Mh{constructor(e,t,i){this.view=e;this.state=t;this.transactions=i;this.flags=0;this.startState=e.state;this.changes=no.empty(this.startState.doc.length);for(let r of i)this.changes=this.changes.compose(r.changes);let n=[];this.changes.iterChangedRanges(((e,t,i,s)=>n.push(new Ah(e,t,i,s))));this.changedRanges=n;let s=e.hasFocus;if(s!=e.inputState.notifiedFocused){e.inputState.notifiedFocused=s;this.flags|=1}}static create(e,t,i){return new Mh(e,t,i)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(this.flags&(8|2))>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((e=>e.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}var Oh=function(e){e[e["LTR"]=0]="LTR";e[e["RTL"]=1]="RTL";return e}(Oh||(Oh={}));const Dh=Oh.LTR,Th=Oh.RTL;function Eh(e){let t=[];for(let i=0;i<e.length;i++)t.push(1<<+e[i]);return t}const Rh=Eh("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008");const _h=Eh("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333");const Bh=Object.create(null),Lh=[];for(let tk of["()","[]","{}"]){let e=tk.charCodeAt(0),t=tk.charCodeAt(1);Bh[e]=t;Bh[t]=-e}function Ph(e){return e<=247?Rh[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?_h[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8203?256:64336<=e&&e<=65023?4:8204==e?256:1}const Nh=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ih{constructor(e,t,i){this.from=e;this.to=t;this.level=i}get dir(){return this.level%2?Th:Dh}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,i,n){let s=-1;for(let r=0;r<e.length;r++){let o=e[r];if(o.from<=t&&o.to>=t){if(o.level==i)return r;if(s<0||(0!=n?n<0?o.from<t:o.to>t:e[s].level>o.level))s=r}}if(s<0)throw new RangeError("Index out of range");return s}}const Vh=[];function Fh(e,t){let i=e.length,n=t==Dh?1:2,s=t==Dh?2:1;if(!e||1==n&&!Nh.test(e))return Hh(i);for(let o=0,l=n,a=n;o<i;o++){let t=Ph(e.charCodeAt(o));if(512==t)t=l;else if(8==t&&4==a)t=16;Vh[o]=4==t?2:t;if(7&t)a=t;l=t}for(let o=0,l=n,a=n;o<i;o++){let e=Vh[o];if(128==e)if(o<i-1&&l==Vh[o+1]&&24&l)e=Vh[o]=l;else Vh[o]=256;else if(64==e){let e=o+1;while(e<i&&64==Vh[e])e++;let t=o&&8==l||e<i&&8==Vh[e]?1==a?1:8:256;for(let i=o;i<e;i++)Vh[i]=t;o=e-1}else if(8==e&&1==a)Vh[o]=1;l=e;if(7&e)a=e}for(let o=0,l=0,a=0,h,c,f;o<i;o++)if(c=Bh[h=e.charCodeAt(o)])if(c<0){for(let e=l-3;e>=0;e-=3)if(Lh[e+1]==-c){let t=Lh[e+2];let i=2&t?n:!(4&t)?0:1&t?s:n;if(i)Vh[o]=Vh[Lh[e]]=i;l=e;break}}else if(189==Lh.length)break;else{Lh[l++]=o;Lh[l++]=h;Lh[l++]=a}else if(2==(f=Vh[o])||1==f){let e=f==n;a=e?0:1;for(let t=l-3;t>=0;t-=3){let i=Lh[t+2];if(2&i)break;if(e)Lh[t+2]|=2;else{if(4&i)break;Lh[t+2]|=4}}}for(let o=0;o<i;o++)if(256==Vh[o]){let e=o+1;while(e<i&&256==Vh[e])e++;let t=1==(o?Vh[o-1]:n);let s=1==(e<i?Vh[e]:n);let r=t==s?t?1:2:n;for(let i=o;i<e;i++)Vh[i]=r;o=e-1}let r=[];if(1==n)for(let o=0;o<i;){let e=o,t=1!=Vh[o++];while(o<i&&t==(1!=Vh[o]))o++;if(t)for(let i=o;i>e;){let t=i,n=2!=Vh[--i];while(i>e&&n==(2!=Vh[i-1]))i--;r.push(new Ih(i,t,n?2:1))}else r.push(new Ih(e,o,0))}else for(let o=0;o<i;){let e=o,t=2==Vh[o++];while(o<i&&t==(2==Vh[o]))o++;r.push(new Ih(e,o,t?1:2))}return r}function Hh(e){return[new Ih(0,e,0)]}let Wh="";function zh(e,t,i,n,s){var r;let o=n.head-e.from,l=-1;if(0==o){if(!s||!e.length)return null;if(t[0].level!=i){o=t[0].side(false,i);l=0}}else if(o==e.length){if(s)return null;let e=t[t.length-1];if(e.level!=i){o=e.side(true,i);l=t.length-1}}if(l<0)l=Ih.find(t,o,null!==(r=n.bidiLevel)&&void 0!==r?r:-1,n.assoc);let a=t[l];if(o==a.side(s,i)){a=t[l+=s?1:-1];o=a.side(!s,i)}let h=s==(a.dir==i);let c=Ur(e.text,o,h);Wh=e.text.slice(Math.min(o,c),Math.max(o,c));if(c!=a.side(s,i))return fo.cursor(c+e.from,h?-1:1,a.level);let f=l==(s?t.length-1:0)?null:t[l+(s?1:-1)];if(!f&&a.level!=i)return fo.cursor(s?e.to:e.from,s?-1:1,i);if(f&&f.level<a.level)return fo.cursor(f.side(!s,i)+e.from,s?1:-1,f.level);return fo.cursor(c+e.from,s?-1:1,a.level)}const qh="￿";class jh{constructor(e,t){this.points=e;this.text="";this.lineSeparator=t.facet(sl.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=qh}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let n=e;;){this.findPointBefore(i,n);this.readNode(n);let e=n.nextSibling;if(e==t)break;let s=fa.get(n),r=fa.get(e);if(s&&r?s.breakAfter:(s?s.breakAfter:$h(n))||$h(e)&&("BR"!=n.nodeName||n.cmIgnore))this.lineBreak();n=e}this.findPointBefore(i,t);return this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)if(i.node==e)i.pos=this.text.length+Math.min(i.offset,t.length);for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,r=1,o;if(this.lineSeparator){s=t.indexOf(this.lineSeparator,i);r=this.lineSeparator.length}else if(o=n.exec(t)){s=o.index;r=o[0].length}this.append(t.slice(i,s<0?t.length:s));if(s<0)break;this.lineBreak();if(r>1)for(let t of this.points)if(t.node==e&&t.pos>this.text.length)t.pos-=r-1;i=s+r}}readNode(e){if(e.cmIgnore)return;let t=fa.get(e);let i=t&&t.overrideDOMText;if(null!=i){this.findPointInside(e,i.length);for(let e=i.iter();!e.next().done;)if(e.lineBreak)this.lineBreak();else this.append(e.value)}else if(3==e.nodeType)this.readTextNode(e);else if("BR"==e.nodeName){if(e.nextSibling)this.lineBreak()}else if(1==e.nodeType)this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)if(i.node==e&&e.childNodes[i.offset]==t)i.pos=this.text.length}findPointInside(e,t){for(let i of this.points)if(3==e.nodeType?i.node==e:e.contains(i.node))i.pos=this.text.length+Math.min(t,i.offset)}}function $h(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}class Uh{constructor(e,t){this.node=e;this.offset=t;this.pos=-1}}class Kh extends fa{constructor(e){super();this.view=e;this.compositionDeco=Ua.none;this.decorations=[];this.dynamicDecorationMap=[];this.minWidth=0;this.minWidthFrom=0;this.minWidthTo=0;this.impreciseAnchor=null;this.impreciseHead=null;this.forceSelection=false;this.lastUpdate=Date.now();this.setDOM(e.contentDOM);this.children=[new Za];this.children[0].setParent(this);this.updateDeco();this.updateInner([new Ah(0,0,0,e.state.doc.length)],0)}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;if(this.minWidth>0&&t.length)if(!t.every((({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo)))this.minWidth=this.minWidthFrom=this.minWidthTo=0;else{this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1);this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)}if(this.view.inputState.composing<0)this.compositionDeco=Ua.none;else if(e.transactions.length||this.dirty)this.compositionDeco=Yh(this.view,e.changes);if((Oa.ie||Oa.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines)this.forceSelection=true;let i=this.decorations,n=this.updateDeco();let s=ic(i,n,e.changes);t=Ah.extendWithRanges(t,s);if(0==this.dirty&&0==t.length)return false;else{this.updateInner(t,e.startState.doc.length);if(e.transactions.length)this.lastUpdate=Date.now();return true}}updateInner(e,t){this.view.viewState.mustMeasureContent=true;this.updateChildren(e,t);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight+"px";this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let e=Oa.chrome||Oa.ios?{node:i.selectionRange.focusNode,written:false}:void 0;this.sync(e);this.dirty=0;if(e&&(e.written||i.selectionRange.focusNode!=e.node))this.forceSelection=true;this.dom.style.height=""}));let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)if(s instanceof eh&&s.widget instanceof Jh)n.push(s.dom);i.updateGaps(n)}updateChildren(e,t){let i=this.childCursor(t);for(let n=e.length-1;;n--){let t=n>=0?e[n]:null;if(!t)break;let{fromA:s,toA:r,fromB:o,toB:l}=t;let{content:a,breakAtStart:h,openStart:c,openEnd:f}=th.build(this.view.state.doc,o,l,this.decorations,this.dynamicDecorationMap);let{i:u,off:d}=i.findPos(r,1);let{i:p,off:m}=i.findPos(s,-1);pa(this,p,m,u,d,a,h,c,f)}}updateSelection(e=false,t=false){if(e||!this.view.observer.selectionRange.focusNode)this.view.observer.readSelectionRange();if(!(t||this.mayControlSelection())||Oa.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=false;let n=this.view.state.selection.main;let s=this.domAtPos(n.anchor);let r=n.empty?s:this.domAtPos(n.head);if(Oa.gecko&&n.empty&&Gh(s)){let e=document.createTextNode("");this.view.observer.ignore((()=>s.node.insertBefore(e,s.node.childNodes[s.offset]||null)));s=r=new ha(e,0);i=true}let o=this.view.observer.selectionRange;if(i||!o.focusNode||!Ul(s.node,s.offset,o.anchorNode,o.anchorOffset)||!Ul(r.node,r.offset,o.focusNode,o.focusOffset)){this.view.observer.ignore((()=>{if(Oa.android&&Oa.chrome&&this.dom.contains(o.focusNode)&&nc(o.focusNode,this.dom)){this.dom.blur();this.dom.focus({preventScroll:true})}let e=Wl(this.view.root);if(!e);else if(n.empty){if(Oa.gecko){let e=ec(s.node,s.offset);if(e&&e!=(1|2)){let t=Zh(s.node,s.offset,1==e?1:-1);if(t)s=new ha(t,1==e?0:t.nodeValue.length)}}e.collapse(s.node,s.offset);if(null!=n.bidiLevel&&null!=o.cursorBidiLevel)o.cursorBidiLevel=n.bidiLevel}else if(e.extend){e.collapse(s.node,s.offset);e.extend(r.node,r.offset)}else{let t=document.createRange();if(n.anchor>n.head)[s,r]=[r,s];t.setEnd(r.node,r.offset);t.setStart(s.node,s.offset);e.removeAllRanges();e.addRange(t)}}));this.view.observer.setSelectionRange(s,r)}this.impreciseAnchor=s.precise?null:new ha(o.anchorNode,o.anchorOffset);this.impreciseHead=r.precise?null:new ha(o.focusNode,o.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main;let t=Wl(this.view.root);if(!t||!e.empty||!e.assoc||!t.modify)return;let i=Za.find(this,e.head);if(!i)return;let n=i.posAtStart;if(e.head==n||e.head==n+i.length)return;let s=this.coordsAt(e.head,-1),r=this.coordsAt(e.head,1);if(!s||!r||s.bottom>r.top)return;let o=this.domAtPos(e.head+e.assoc);t.collapse(o.node,o.offset);t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||jl(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let t=e;t;){let e=fa.get(t);if(e&&e.rootView==this)return e;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let e=this.children[t];if(i<e.length||e instanceof Za)break;t++;i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){for(let i=this.length,n=this.children.length-1;;n--){let s=this.children[n],r=i-s.breakAfter-s.length;if(e>r||e==r&&s.type!=$a.WidgetBefore&&s.type!=$a.WidgetAfter&&(!n||2==t||this.children[n-1].breakAfter||this.children[n-1].type==$a.WidgetBefore&&t>-2))return s.coordsAt(e-r,t);i=r}}measureVisibleLineHeights(e){let t=[],{from:i,to:n}=e;let s=this.view.contentDOM.clientWidth;let r=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1;let o=-1,l=this.view.textDirection==Oh.LTR;for(let a=0,h=0;h<this.children.length;h++){let e=this.children[h],c=a+e.length;if(c>n)break;if(a>=i){let i=e.dom.getBoundingClientRect();t.push(i.height);if(r){let t=e.dom.lastChild;let n=t?$l(t):[];if(n.length){let e=n[n.length-1];let t=l?e.right-i.left:i.right-e.left;if(t>o){o=t;this.minWidth=s;this.minWidthFrom=a;this.minWidthTo=c}}}}a=c+e.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return"rtl"==getComputedStyle(this.children[t].dom).direction?Oh.RTL:Oh.LTR}measureTextSize(){for(let n of this.children)if(n instanceof Za){let e=n.measureTextSize();if(e)return e}let e=document.createElement("div"),t,i;e.className="cm-line";e.style.width="99999px";e.textContent="abc def ghi jkl mno pqr stu";this.view.observer.ignore((()=>{this.dom.appendChild(e);let n=$l(e.firstChild)[0];t=e.getBoundingClientRect().height;i=n?n.width/27:7;e.remove()}));return{lineHeight:t,charWidth:i}}childCursor(e=this.length){let t=this.children.length;if(t)e-=this.children[--t].length;return new da(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,n=0;;n++){let s=n==t.viewports.length?null:t.viewports[n];let r=s?s.from-1:this.length;if(r>i){let n=t.lineBlockAt(r).bottom-t.lineBlockAt(i).top;e.push(Ua.replace({widget:new Jh(n),block:true,inclusive:true,isBlockGap:true}).range(i,r))}if(!s)break;i=s.to+1}return Ua.set(e)}updateDeco(){let e=this.view.state.facet(xh).map(((e,t)=>{let i=this.dynamicDecorationMap[t]="function"==typeof e;return i?e(this.view):e}));for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=false;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e;let i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),n;if(!i)return;if(!t.empty&&(n=this.coordsAt(t.anchor,t.anchor>t.head?-1:1)))i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)};let s=0,r=0,o=0,l=0;for(let h of this.view.state.facet(Sh).map((e=>e(this.view))))if(h){let{left:e,right:t,top:i,bottom:n}=h;if(null!=e)s=Math.max(s,e);if(null!=t)r=Math.max(r,t);if(null!=i)o=Math.max(o,i);if(null!=n)l=Math.max(l,n)}let a={left:i.left-s,top:i.top-o,right:i.right+r,bottom:i.bottom+l};Zl(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==Oh.LTR)}}function Gh(e){return 1==e.node.nodeType&&e.node.firstChild&&(0==e.offset||"false"==e.node.childNodes[e.offset-1].contentEditable)&&(e.offset==e.node.childNodes.length||"false"==e.node.childNodes[e.offset].contentEditable)}class Jh extends ja{constructor(e){super();this.height=e}toDOM(){let e=document.createElement("div");this.updateDOM(e);return e}eq(e){return e.height==this.height}updateDOM(e){e.style.height=this.height+"px";return true}get estimatedHeight(){return this.height}}function Xh(e){let t=e.observer.selectionRange;let i=t.focusNode&&Zh(t.focusNode,t.focusOffset,0);if(!i)return null;let n=e.docView.nearest(i);if(!n)return null;if(n instanceof Za){let e=i;while(e.parentNode!=n.dom)e=e.parentNode;let t=e.previousSibling;while(t&&!fa.get(t))t=t.previousSibling;let s=t?fa.get(t).posAtEnd:n.posAtStart;return{from:s,to:s,node:e,text:i}}else{for(;;){let{parent:e}=n;if(!e)return null;if(e instanceof Za)break;n=e}let e=n.posAtStart;return{from:e,to:e+n.length,node:n.dom,text:i}}}function Yh(e,t){let i=Xh(e);if(!i)return Ua.none;let{from:n,to:s,node:r,text:o}=i;let l=t.mapPos(n,1),a=Math.max(l,t.mapPos(s,-1));let{state:h}=e,c=3==r.nodeType?r.nodeValue:new jh([],h).readRange(r.firstChild,null).text;if(a-l<c.length)if(h.doc.sliceString(l,Math.min(h.doc.length,l+c.length),qh)==c)a=l+c.length;else if(h.doc.sliceString(Math.max(0,a-c.length),a,qh)==c)l=a-c.length;else return Ua.none;else if(h.doc.sliceString(l,a,qh)!=c)return Ua.none;let f=fa.get(r);if(f instanceof Ba)f=f.widget.topView;else if(f)f.parent=null;return Ua.set(Ua.replace({widget:new Qh(r,o,f),inclusive:true}).range(l,a))}class Qh extends ja{constructor(e,t,i){super();this.top=e;this.text=t;this.topView=i}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return false}get customView(){return Ba}}function Zh(e,t,i){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0&&i<=0){e=e.childNodes[t-1];t=Jl(e)}else if(1==e.nodeType&&t<e.childNodes.length&&i>=0){e=e.childNodes[t];t=0}else return null}}function ec(e,t){if(1!=e.nodeType)return 0;return(t&&"false"==e.childNodes[t-1].contentEditable?1:0)|(t<e.childNodes.length&&"false"==e.childNodes[t].contentEditable?2:0)}class tc{constructor(){this.changes=[]}compareRange(e,t){Qa(e,t,this.changes)}comparePoint(e,t){Qa(e,t,this.changes)}}function ic(e,t,i){let n=new tc;cl.compare(e,t,i,n);return n.changes}function nc(e,t){for(let i=e;i&&i!=t;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return true;return false}function sc(e,t,i=1){let n=e.charCategorizer(t);let s=e.doc.lineAt(t),r=t-s.from;if(0==s.length)return fo.cursor(t);if(0==r)i=1;else if(r==s.length)i=-1;let o=r,l=r;if(i<0)o=Ur(s.text,r,false);else l=Ur(s.text,r);let a=n(s.text.slice(o,l));while(o>0){let e=Ur(s.text,o,false);if(n(s.text.slice(e,o))!=a)break;o=e}while(l<s.length){let e=Ur(s.text,l);if(n(s.text.slice(l,e))!=a)break;l=e}return fo.range(o+s.from,l+s.from)}function rc(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function oc(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function lc(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function ac(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function hc(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function cc(e,t,i){let n,s,r,o,l=false;let a,h,c,f;for(let p=e.firstChild;p;p=p.nextSibling){let e=$l(p);for(let u=0;u<e.length;u++){let d=e[u];if(s&&lc(s,d))d=ac(hc(d,s.bottom),s.top);let m=rc(t,d),g=oc(i,d);if(0==m&&0==g)return 3==p.nodeType?fc(p,t,i):cc(p,t,i);if(!n||o>g||o==g&&r>m){n=p;s=d;r=m;o=g;l=!m||(m>0?u<e.length-1:u>0)}if(0==m){if(i>d.bottom&&(!c||c.bottom<d.bottom)){a=p;c=d}else if(i<d.top&&(!f||f.top>d.top)){h=p;f=d}}else if(c&&lc(c,d))c=hc(c,d.bottom);else if(f&&lc(f,d))f=ac(f,d.top)}}if(c&&c.bottom>=i){n=a;s=c}else if(f&&f.top<=i){n=h;s=f}if(!n)return{node:e,offset:0};let u=Math.max(s.left,Math.min(s.right,t));if(3==n.nodeType)return fc(n,u,i);if(l&&"false"!=n.contentEditable)return cc(n,u,i);let d=Array.prototype.indexOf.call(e.childNodes,n)+(t>=(s.left+s.right)/2?1:0);return{node:e,offset:d}}function fc(e,t,i){let n=e.nodeValue.length;let s=-1,r=1e9,o=0;for(let l=0;l<n;l++){let n=sa(e,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;if(!o)o=t-h.left;let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&c<r){let i=t>=(h.left+h.right)/2,n=i;if(Oa.chrome||Oa.gecko){let t=sa(e,l).getBoundingClientRect();if(t.left==h.right)n=!i}if(c<=0)return{node:e,offset:l+(n?1:0)};s=l+(n?1:0);r=c}}}return{node:e,offset:s>-1?s:o>0?e.nodeValue.length:0}}function uc(e,{x:t,y:i},n,s=-1){var r;let o=e.contentDOM.getBoundingClientRect(),l=o.top+e.viewState.paddingTop;let a,{docHeight:h}=e.viewState;let c=i-l;if(c<0)return 0;if(c>h)return e.state.doc.length;for(let v=e.defaultLineHeight/2,w=false;;){a=e.elementAtHeight(c);if(a.type==$a.Text)break;for(;;){c=s>0?a.bottom+v:a.top-v;if(c>=0&&c<=h)break;if(w)return n?null:0;w=true;s=-s}}i=l+c;let f=a.from;if(f<e.viewport.from)return 0==e.viewport.from?0:n?null:dc(e,o,a,t,i);if(f>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:n?null:dc(e,o,a,t,i);let u=e.dom.ownerDocument;let d=e.root.elementFromPoint?e.root:u;let p=d.elementFromPoint(t,i);if(p&&!e.contentDOM.contains(p))p=null;if(!p){t=Math.max(o.left+1,Math.min(o.right-1,t));p=d.elementFromPoint(t,i);if(p&&!e.contentDOM.contains(p))p=null}let m,g=-1;if(p&&false!=(null===(r=e.docView.nearest(p))||void 0===r?void 0:r.isEditable))if(u.caretPositionFromPoint){let e=u.caretPositionFromPoint(t,i);if(e)({offsetNode:m,offset:g}=e)}else if(u.caretRangeFromPoint){let n=u.caretRangeFromPoint(t,i);if(n){({startContainer:m,startOffset:g}=n);if(!e.contentDOM.contains(m)||Oa.safari&&pc(m,g,t)||Oa.chrome&&mc(m,g,t))m=void 0}}if(!m||!e.docView.dom.contains(m)){let n=Za.find(e.docView,f);if(!n)return c>a.top+a.height/2?a.to:a.from;({node:m,offset:g}=cc(n.dom,t,i))}return e.docView.posFromDOM(m,g)}function dc(e,t,i,n,s){let r=Math.round((n-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&i.height>1.5*e.defaultLineHeight){let t=Math.floor((s-i.top)/e.defaultLineHeight);r+=t*e.viewState.heightOracle.lineLength}let o=e.state.sliceDoc(i.from,i.to);return i.from+Cl(o,r,e.state.tabSize)}function pc(e,t,i){let n;if(3!=e.nodeType||t!=(n=e.nodeValue.length))return false;for(let s=e.nextSibling;s;s=s.nextSibling)if(1!=s.nodeType||"BR"!=s.nodeName)return false;return sa(e,n-1,n).getBoundingClientRect().left>i}function mc(e,t,i){if(0!=t)return false;for(let s=e;;){let e=s.parentNode;if(!e||1!=e.nodeType||e.firstChild!=s)return false;if(e.classList.contains("cm-line"))break;s=e}let n=1==e.nodeType?e.getBoundingClientRect():sa(e,0,Math.max(e.nodeValue.length,1)).getBoundingClientRect();return i-n.left>5}function gc(e,t,i,n){let s=e.state.doc.lineAt(t.head);let r=!n||!e.lineWrapping?null:e.coordsAtPos(t.assoc<0&&t.head>s.from?t.head-1:t.head);if(r){let t=e.dom.getBoundingClientRect();let n=e.textDirectionAt(s.from);let o=e.posAtCoords({x:i==(n==Oh.LTR)?t.right-1:t.left+1,y:(r.top+r.bottom)/2});if(null!=o)return fo.cursor(o,i?-1:1)}let o=Za.find(e.docView,t.head);let l=o?i?o.posAtEnd:o.posAtStart:i?s.to:s.from;return fo.cursor(l,i?-1:1)}function vc(e,t,i,n){let s=e.state.doc.lineAt(t.head),r=e.bidiSpans(s);let o=e.textDirectionAt(s.from);for(let l=t,a=null;;){let t=zh(s,r,o,l,i),h=Wh;if(!t){if(s.number==(i?e.state.doc.lines:1))return l;h="\n";s=e.state.doc.line(s.number+(i?1:-1));r=e.bidiSpans(s);t=fo.cursor(i?s.from:s.to)}if(!a){if(!n)return t;a=n(h)}else if(!a(h))return l;l=t}}function wc(e,t,i){let n=e.state.charCategorizer(t);let s=n(i);return e=>{let t=n(e);if(s==Zo.Space)s=t;return s==t}}function yc(e,t,i,n){let s=t.head,r=i?1:-1;if(s==(i?e.state.doc.length:0))return fo.cursor(s,t.assoc);let o=t.goalColumn,l;let a=e.contentDOM.getBoundingClientRect();let h=e.coordsAtPos(s),c=e.documentTop;if(h){if(null==o)o=h.left-a.left;l=r<0?h.top:h.bottom}else{let t=e.viewState.lineBlockAt(s);if(null==o)o=Math.min(a.right-a.left,e.defaultCharacterWidth*(s-t.from));l=(r<0?t.top:t.bottom)+c}let f=a.left+o;let u=null!==n&&void 0!==n?n:e.defaultLineHeight>>1;for(let d=0;;d+=10){let i=l+(u+d)*r;let n=uc(e,{x:f,y:i},false,r);if(i<a.top||i>a.bottom||(r<0?n<s:n>s))return fo.cursor(n,t.assoc,void 0,o)}}function bc(e,t,i){let n=e.state.facet(kh).map((t=>t(e)));for(;;){let e=false;for(let s of n)s.between(i.from-1,i.from+1,((n,s,r)=>{if(i.from>n&&i.from<s){i=t.from>i.from?fo.cursor(n,1):fo.cursor(s,-1);e=true}}));if(!e)return i}}class xc{constructor(e){this.lastKeyCode=0;this.lastKeyTime=0;this.lastTouchTime=0;this.lastFocusTime=0;this.lastScrollTop=0;this.lastScrollLeft=0;this.chromeScrollHack=-1;this.pendingIOSKey=void 0;this.lastSelectionOrigin=null;this.lastSelectionTime=0;this.lastEscPress=0;this.lastContextMenu=0;this.scrollHandlers=[];this.registeredEvents=[];this.customHandlers=[];this.composing=-1;this.compositionFirstChange=null;this.compositionEndedAt=0;this.rapidCompositionStart=false;this.mouseSelection=null;for(let t in Ec){let i=Ec[t];e.contentDOM.addEventListener(t,(n=>{if(!Tc(e,n)||this.ignoreDuringComposition(n))return;if("keydown"==t&&this.keydown(e,n))return;if(this.mustFlushObserver(n))e.observer.forceFlush();if(this.runCustomHandlers(t,e,n))n.preventDefault();else i(e,n)}),Rc[t]);this.registeredEvents.push(t)}if(Oa.chrome&&102==Oa.chrome_version)e.scrollDOM.addEventListener("wheel",(()=>{if(this.chromeScrollHack<0)e.contentDOM.style.pointerEvents="none";else window.clearTimeout(this.chromeScrollHack);this.chromeScrollHack=setTimeout((()=>{this.chromeScrollHack=-1;e.contentDOM.style.pointerEvents=""}),100)}),{passive:true});this.notifiedFocused=e.hasFocus;if(Oa.safari)e.contentDOM.addEventListener("input",(()=>null))}setSelectionOrigin(e){this.lastSelectionOrigin=e;this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var i;let n;this.customHandlers=[];for(let s of t)if(n=null===(i=s.update(e).spec)||void 0===i?void 0:i.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:n});for(let t in n)if(this.registeredEvents.indexOf(t)<0&&"scroll"!=t){this.registeredEvents.push(t);e.contentDOM.addEventListener(t,(i=>{if(!Tc(e,i))return;if(this.runCustomHandlers(t,e,i))i.preventDefault()}))}}}runCustomHandlers(e,t,i){for(let s of this.customHandlers){let r=s.handlers[e];if(r)try{if(r.call(s.plugin,i,t)||i.defaultPrevented)return true}catch(n){dh(t.state,n)}}return false}runScrollHandlers(e,t){this.lastScrollTop=e.scrollDOM.scrollTop;this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let n of this.customHandlers){let s=n.handlers.scroll;if(s)try{s.call(n.plugin,t,e)}catch(i){dh(e.state,i)}}}keydown(e,t){this.lastKeyCode=t.keyCode;this.lastKeyTime=Date.now();if(9==t.keyCode&&Date.now()<this.lastEscPress+2e3)return true;if(Oa.android&&Oa.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode)){e.observer.delayAndroidKey(t.key,t.keyCode);return true}let i;if(Oa.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=kc.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||Sc.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)){this.pendingIOSKey=i||t;setTimeout((()=>this.flushIOSKey(e)),250);return true}return false}flushIOSKey(e){let t=this.pendingIOSKey;if(!t)return false;this.pendingIOSKey=void 0;return ra(e.contentDOM,t.key,t.keyCode)}ignoreDuringComposition(e){if(!/^key/.test(e.type))return false;if(this.composing>0)return true;if(Oa.safari&&!Oa.ios&&Date.now()-this.compositionEndedAt<100){this.compositionEndedAt=0;return true}return false}mustFlushObserver(e){return"keydown"==e.type&&229!=e.keyCode||"compositionend"==e.type&&!Oa.ios}startMouseSelection(e){if(this.mouseSelection)this.mouseSelection.destroy();this.mouseSelection=e}update(e){if(this.mouseSelection)this.mouseSelection.update(e);if(e.transactions.length)this.lastKeyCode=this.lastSelectionTime=0}destroy(){if(this.mouseSelection)this.mouseSelection.destroy()}}const kc=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}];const Sc="dthko";const Cc=[16,17,18,20,91,92,224,225];class Ac{constructor(e,t,i,n){this.view=e;this.style=i;this.mustSelect=n;this.lastEvent=t;let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this));s.addEventListener("mouseup",this.up=this.up.bind(this));this.extend=t.shiftKey;this.multiple=e.state.facet(sl.allowMultipleSelections)&&Mc(e,t);this.dragMove=Oc(e,t);this.dragging=Dc(e,t)&&1==jc(t)?null:false;if(false===this.dragging){t.preventDefault();this.select(t)}}move(e){if(0==e.buttons)return this.destroy();if(false!==this.dragging)return;this.select(this.lastEvent=e)}up(e){if(null==this.dragging)this.select(this.lastEvent);if(!this.dragging)e.preventDefault();this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move);e.removeEventListener("mouseup",this.up);this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);if(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:true});this.mustSelect=false}update(e){if(e.docChanged&&this.dragging)this.dragging=this.dragging.map(e.changes);if(this.style.update(e))setTimeout((()=>this.select(this.lastEvent)),20)}}function Mc(e,t){let i=e.state.facet(sh);return i.length?i[0](t):Oa.mac?t.metaKey:t.ctrlKey}function Oc(e,t){let i=e.state.facet(rh);return i.length?i[0](t):Oa.mac?!t.altKey:!t.ctrlKey}function Dc(e,t){let{main:i}=e.state.selection;if(i.empty)return false;let n=Wl(e.root);if(!n||0==n.rangeCount)return true;let s=n.getRangeAt(0).getClientRects();for(let r=0;r<s.length;r++){let e=s[r];if(e.left<=t.clientX&&e.right>=t.clientX&&e.top<=t.clientY&&e.bottom>=t.clientY)return true}return false}function Tc(e,t){if(!t.bubbles)return true;if(t.defaultPrevented)return false;for(let i=t.target,n;i!=e.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(n=fa.get(i))&&n.ignoreEvent(t))return false;return true}const Ec=Object.create(null);const Rc=Object.create(null);const _c=Oa.ie&&Oa.ie_version<15||Oa.ios&&Oa.webkit_version<604;function Bc(e){let t=e.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px";i.focus();setTimeout((()=>{e.focus();i.remove();Lc(e,i.value)}),50)}function Lc(e,t){let{state:i}=e,n,s=1,r=i.toText(t);let o=r.lines==i.selection.ranges.length;let l=null!=Xc&&i.selection.ranges.every((e=>e.empty))&&Xc==r.toString();if(l){let e=-1;n=i.changeByRange((n=>{let l=i.doc.lineAt(n.from);if(l.from==e)return{range:n};e=l.from;let a=i.toText((o?r.line(s++).text:t)+i.lineBreak);return{changes:{from:l.from,insert:a},range:fo.cursor(n.from+a.length)}}))}else if(o)n=i.changeByRange((e=>{let t=r.line(s++);return{changes:{from:e.from,to:e.to,insert:t.text},range:fo.cursor(e.from+t.length)}}));else n=i.replaceSelection(r);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:true})}Ec.keydown=(e,t)=>{e.inputState.setSelectionOrigin("select");if(27==t.keyCode)e.inputState.lastEscPress=Date.now();else if(Cc.indexOf(t.keyCode)<0)e.inputState.lastEscPress=0};Ec.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now();e.inputState.setSelectionOrigin("select.pointer")};Ec.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")};Rc.touchstart=Rc.touchmove={passive:true};Ec.mousedown=(e,t)=>{e.observer.flush();if(e.inputState.lastTouchTime>Date.now()-2e3&&1==jc(t))return;let i=null;for(let n of e.state.facet(oh)){i=n(e,t);if(i)break}if(!i&&0==t.button)i=$c(e,t);if(i){let n=e.root.activeElement!=e.contentDOM;if(n)e.observer.ignore((()=>ia(e.contentDOM)));e.inputState.startMouseSelection(new Ac(e,t,i,n))}};function Pc(e,t,i,n){if(1==n)return fo.cursor(t,i);else if(2==n)return sc(e.state,t,i);else{let i=Za.find(e.docView,t),n=e.state.doc.lineAt(i?i.posAtEnd:t);let s=i?i.posAtStart:n.from,r=i?i.posAtEnd:n.to;if(r<e.state.doc.length&&r==n.to)r++;return fo.range(s,r)}}let Nc=(e,t)=>e>=t.top&&e<=t.bottom;let Ic=(e,t,i)=>Nc(t,i)&&e>=i.left&&e<=i.right;function Vc(e,t,i,n){let s=Za.find(e.docView,t);if(!s)return 1;let r=t-s.posAtStart;if(0==r)return 1;if(r==s.length)return-1;let o=s.coordsAt(r,-1);if(o&&Ic(i,n,o))return-1;let l=s.coordsAt(r,1);if(l&&Ic(i,n,l))return 1;return o&&Nc(n,o)?-1:1}function Fc(e,t){let i=e.posAtCoords({x:t.clientX,y:t.clientY},false);return{pos:i,bias:Vc(e,i,t.clientX,t.clientY)}}const Hc=Oa.ie&&Oa.ie_version<=11;let Wc=null,zc=0,qc=0;function jc(e){if(!Hc)return e.detail;let t=Wc,i=qc;Wc=e;qc=Date.now();return zc=!t||i>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(zc+1)%3:1}function $c(e,t){let i=Fc(e,t),n=jc(t);let s=e.state.selection;let r=i,o=t;return{update(e){if(e.docChanged){if(i)i.pos=e.changes.mapPos(i.pos);s=s.map(e.changes);o=null}},get(t,l,a){let h;if(o&&t.clientX==o.clientX&&t.clientY==o.clientY)h=r;else{h=r=Fc(e,t);o=t}if(!h||!i)return s;let c=Pc(e,h.pos,h.bias,n);if(i.pos!=h.pos&&!l){let t=Pc(e,i.pos,i.bias,n);let s=Math.min(t.from,c.from),r=Math.max(t.to,c.to);c=s<c.from?fo.range(s,r):fo.range(r,s)}if(l)return s.replaceRange(s.main.extend(c.from,c.to));else if(a&&s.ranges.length>1&&s.ranges.some((e=>e.eq(c))))return Uc(s,c);else if(a)return s.addRange(c);else return fo.create([c])}}}function Uc(e,t){for(let i=0;;i++)if(e.ranges[i].eq(t))return fo.create(e.ranges.slice(0,i).concat(e.ranges.slice(i+1)),e.mainIndex==i?0:e.mainIndex-(e.mainIndex>i?1:0))}Ec.dragstart=(e,t)=>{let{selection:{main:i}}=e.state;let{mouseSelection:n}=e.inputState;if(n)n.dragging=i;if(t.dataTransfer){t.dataTransfer.setData("Text",e.state.sliceDoc(i.from,i.to));t.dataTransfer.effectAllowed="copyMove"}};function Kc(e,t,i,n){if(!i)return;let s=e.posAtCoords({x:t.clientX,y:t.clientY},false);t.preventDefault();let{mouseSelection:r}=e.inputState;let o=n&&r&&r.dragging&&r.dragMove?{from:r.dragging.from,to:r.dragging.to}:null;let l={from:s,insert:i};let a=e.state.changes(o?[o,l]:l);e.focus();e.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"})}Ec.drop=(e,t)=>{if(!t.dataTransfer)return;if(e.state.readOnly)return t.preventDefault();let i=t.dataTransfer.files;if(i&&i.length){t.preventDefault();let n=Array(i.length),s=0;let r=()=>{if(++s==i.length)Kc(e,t,n.filter((e=>null!=e)).join(e.state.lineBreak),false)};for(let e=0;e<i.length;e++){let t=new FileReader;t.onerror=r;t.onload=()=>{if(!/[\x00-\x08\x0e-\x1f]{2}/.test(t.result))n[e]=t.result;r()};t.readAsText(i[e])}}else Kc(e,t,t.dataTransfer.getData("Text"),true)};Ec.paste=(e,t)=>{if(e.state.readOnly)return t.preventDefault();e.observer.flush();let i=_c?null:t.clipboardData;if(i){Lc(e,i.getData("text/plain"));t.preventDefault()}else Bc(e)};function Gc(e,t){let i=e.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px";n.value=t;n.focus();n.selectionEnd=t.length;n.selectionStart=0;setTimeout((()=>{n.remove();e.focus()}),50)}function Jc(e){let t=[],i=[],n=false;for(let s of e.selection.ranges)if(!s.empty){t.push(e.sliceDoc(s.from,s.to));i.push(s)}if(!t.length){let s=-1;for(let{from:n}of e.selection.ranges){let r=e.doc.lineAt(n);if(r.number>s){t.push(r.text);i.push({from:r.from,to:Math.min(e.doc.length,r.to+1)})}s=r.number}n=true}return{text:t.join(e.lineBreak),ranges:i,linewise:n}}let Xc=null;Ec.copy=Ec.cut=(e,t)=>{let{text:i,ranges:n,linewise:s}=Jc(e.state);if(!i&&!s)return;Xc=s?i:null;let r=_c?null:t.clipboardData;if(r){t.preventDefault();r.clearData();r.setData("text/plain",i)}else Gc(e,i);if("cut"==t.type&&!e.state.readOnly)e.dispatch({changes:n,scrollIntoView:true,userEvent:"delete.cut"})};function Yc(e){setTimeout((()=>{if(e.hasFocus!=e.inputState.notifiedFocused)e.update([])}),10)}Ec.focus=e=>{e.inputState.lastFocusTime=Date.now();if(!e.scrollDOM.scrollTop&&(e.inputState.lastScrollTop||e.inputState.lastScrollLeft)){e.scrollDOM.scrollTop=e.inputState.lastScrollTop;e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft}Yc(e)};Ec.blur=e=>{e.observer.clearSelectionRange();Yc(e)};function Qc(e,t){if(e.docView.compositionDeco.size){e.inputState.rapidCompositionStart=t;try{e.update([])}finally{e.inputState.rapidCompositionStart=false}}}Ec.compositionstart=Ec.compositionupdate=e=>{if(null==e.inputState.compositionFirstChange)e.inputState.compositionFirstChange=true;if(e.inputState.composing<0){e.inputState.composing=0;if(e.docView.compositionDeco.size){e.observer.flush();Qc(e,true)}}};Ec.compositionend=e=>{e.inputState.composing=-1;e.inputState.compositionEndedAt=Date.now();e.inputState.compositionFirstChange=null;setTimeout((()=>{if(e.inputState.composing<0)Qc(e,false)}),50)};Ec.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()};Ec.beforeinput=(e,t)=>{var i;let n;if(Oa.chrome&&Oa.android&&(n=kc.find((e=>e.inputType==t.inputType)))){e.observer.delayAndroidKey(n.key,n.keyCode);if("Backspace"==n.key||"Delete"==n.key){let t=(null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0;setTimeout((()=>{var i;if(((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>t+10&&e.hasFocus){e.contentDOM.blur();e.focus()}}),100)}}};const Zc=["pre-wrap","normal","pre-line","break-spaces"];class ef{constructor(){this.doc=_r.empty;this.lineWrapping=false;this.heightSamples={};this.lineHeight=14;this.charWidth=7;this.lineLength=30;this.heightChanged=false}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;if(this.lineWrapping)i+=Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength);return this.lineHeight*i}heightForLine(e){if(!this.lineWrapping)return this.lineHeight;let t=1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5)));return t*this.lineHeight}setDoc(e){this.doc=e;return this}mustRefreshForWrapping(e){return Zc.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=false;for(let i=0;i<e.length;i++){let n=e[i];if(n<0)i++;else if(!this.heightSamples[Math.floor(10*n)]){t=true;this.heightSamples[Math.floor(10*n)]=true}}return t}refresh(e,t,i,n,s){let r=Zc.indexOf(e)>-1;let o=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=r;this.lineWrapping=r;this.lineHeight=t;this.charWidth=i;this.lineLength=n;if(o){this.heightSamples={};for(let e=0;e<s.length;e++){let t=s[e];if(t<0)e++;else this.heightSamples[Math.floor(10*t)]=true}}return o}}class tf{constructor(e,t){this.from=e;this.heights=t;this.index=0}get more(){return this.index<this.heights.length}}class nf{constructor(e,t,i,n,s){this.from=e;this.length=t;this.top=i;this.height=n;this.type=s}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new nf(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var sf=function(e){e[e["ByPos"]=0]="ByPos";e[e["ByHeight"]=1]="ByHeight";e[e["ByPosNoHeight"]=2]="ByPosNoHeight";return e}(sf||(sf={}));const rf=.001;class of{constructor(e,t,i=2){this.length=e;this.height=t;this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|~2&this.flags}setHeight(e,t){if(this.height!=t){if(Math.abs(this.height-t)>rf)e.heightChanged=true;this.height=t}}replace(e,t,i){return of.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,n){let s=this;for(let r=n.length-1;r>=0;r--){let{fromA:o,toA:l,fromB:a,toB:h}=n[r];let c=s.lineAt(o,sf.ByPosNoHeight,t,0,0);let f=c.to>=l?c:s.lineAt(l,sf.ByPosNoHeight,t,0,0);h+=f.to-l;l=f.to;while(r>0&&c.from<=n[r-1].toA){o=n[r-1].fromA;a=n[r-1].fromB;r--;if(o<c.from)c=s.lineAt(o,sf.ByPosNoHeight,t,0,0)}a+=c.from-o;o=c.from;let u=df.build(i,e,a,h);s=s.replace(o,l,u)}return s.updateHeight(i,0)}static empty(){return new af(0,0)}static of(e){if(1==e.length)return e[0];let t=0,i=e.length,n=0,s=0;for(;;)if(t==i)if(n>2*s){let s=e[t-1];if(s.break)e.splice(--t,1,s.left,null,s.right);else e.splice(--t,1,s.left,s.right);i+=1+s.break;n-=s.size}else if(s>2*n){let t=e[i];if(t.break)e.splice(i,1,t.left,null,t.right);else e.splice(i,1,t.left,t.right);i+=2+t.break;s-=t.size}else break;else if(n<s){let i=e[t++];if(i)n+=i.size}else{let t=e[--i];if(t)s+=t.size}let r=0;if(null==e[t-1]){r=1;t--}else if(null==e[t]){r=1;i++}return new cf(of.of(e.slice(0,t)),r,of.of(e.slice(i)))}}of.prototype.size=1;class lf extends of{constructor(e,t,i){super(e,t);this.type=i}blockAt(e,t,i,n){return new nf(n,this.length,i,this.height,this.type)}lineAt(e,t,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(e,t,i,n,s,r){if(e<=s+this.length&&t>=s)r(this.blockAt(0,i,n,s))}updateHeight(e,t=0,i=false,n){if(n&&n.from<=t&&n.more)this.setHeight(e,n.heights[n.index++]);this.outdated=false;return this}toString(){return`block(${this.length})`}}class af extends lf{constructor(e,t){super(e,t,$a.Text);this.collapsed=0;this.widgetHeight=0}replace(e,t,i){let n=i[0];if(1==i.length&&(n instanceof af||n instanceof hf&&4&n.flags)&&Math.abs(this.length-n.length)<10){if(n instanceof hf)n=new af(n.length,this.height);else n.height=this.height;if(!this.outdated)n.outdated=false;return n}else return of.of(i)}updateHeight(e,t=0,i=false,n){if(n&&n.from<=t&&n.more)this.setHeight(e,n.heights[n.index++]);else if(i||this.outdated)this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed)));this.outdated=false;return this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class hf extends of{constructor(e){super(e,0)}lines(e,t){let i=e.lineAt(t).number,n=e.lineAt(t+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(e,t,i,n){let{firstLine:s,lastLine:r,lineHeight:o}=this.lines(t,n);let l=Math.max(0,Math.min(r-s,Math.floor((e-i)/o)));let{from:a,length:h}=t.line(s+l);return new nf(a,h,i+o*l,o,$a.Text)}lineAt(e,t,i,n,s){if(t==sf.ByHeight)return this.blockAt(e,i,n,s);if(t==sf.ByPosNoHeight){let{from:t,to:n}=i.lineAt(e);return new nf(t,n-t,0,0,$a.Text)}let{firstLine:r,lineHeight:o}=this.lines(i,s);let{from:l,length:a,number:h}=i.lineAt(e);return new nf(l,a,n+o*(h-r),o,$a.Text)}forEachLine(e,t,i,n,s,r){let{firstLine:o,lineHeight:l}=this.lines(i,s);for(let a=Math.max(e,s),h=Math.min(s+this.length,t);a<=h;){let t=i.lineAt(a);if(a==e)n+=l*(t.number-o);r(new nf(t.from,t.length,n,l,$a.Text));n+=l;a=t.to+1}}replace(e,t,i){let n=this.length-t;if(n>0){let e=i[i.length-1];if(e instanceof hf)i[i.length-1]=new hf(e.length+n);else i.push(null,new hf(n-1))}if(e>0){let t=i[0];if(t instanceof hf)i[0]=new hf(e+t.length);else i.unshift(new hf(e-1),null)}return of.of(i)}decomposeLeft(e,t){t.push(new hf(e-1),null)}decomposeRight(e,t){t.push(null,new hf(this.length-e-1))}updateHeight(e,t=0,i=false,n){let s=t+this.length;if(n&&n.from<=t+this.length&&n.more){let i=[],r=Math.max(t,n.from),o=-1;let l=e.heightChanged;if(n.from>t)i.push(new hf(n.from-t-1).updateHeight(e,t));while(r<=s&&n.more){let t=e.doc.lineAt(r).length;if(i.length)i.push(null);let s=n.heights[n.index++];if(-1==o)o=s;else if(Math.abs(s-o)>=rf)o=-2;let l=new af(t,s);l.outdated=false;i.push(l);r+=t+1}if(r<=s)i.push(null,new hf(s-r).updateHeight(e,r));let a=of.of(i);e.heightChanged=l||o<0||Math.abs(a.height-this.height)>=rf||Math.abs(o-this.lines(e.doc,t).lineHeight)>=rf;return a}else if(i||this.outdated){this.setHeight(e,e.heightForGap(t,t+this.length));this.outdated=false}return this}toString(){return`gap(${this.length})`}}class cf extends of{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0));this.left=e;this.right=i;this.size=e.size+i.size}get break(){return 1&this.flags}blockAt(e,t,i,n){let s=i+this.left.height;return e<s?this.left.blockAt(e,t,i,n):this.right.blockAt(e,t,s,n+this.left.length+this.break)}lineAt(e,t,i,n,s){let r=n+this.left.height,o=s+this.left.length+this.break;let l=t==sf.ByHeight?e<r:e<o;let a=l?this.left.lineAt(e,t,i,n,s):this.right.lineAt(e,t,i,r,o);if(this.break||(l?a.to<o:a.from>o))return a;let h=t==sf.ByPosNoHeight?sf.ByPosNoHeight:sf.ByPos;if(l)return a.join(this.right.lineAt(o,h,i,r,o));else return this.left.lineAt(o,h,i,n,s).join(a)}forEachLine(e,t,i,n,s,r){let o=n+this.left.height,l=s+this.left.length+this.break;if(this.break){if(e<l)this.left.forEachLine(e,t,i,n,s,r);if(t>=l)this.right.forEachLine(e,t,i,o,l,r)}else{let a=this.lineAt(l,sf.ByPos,i,n,s);if(e<a.from)this.left.forEachLine(e,a.from-1,i,n,s,r);if(a.to>=e&&a.from<=t)r(a);if(t>a.to)this.right.forEachLine(a.to+1,t,i,o,l,r)}}replace(e,t,i){let n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,i));let s=[];if(e>0)this.decomposeLeft(e,s);let r=s.length;for(let o of i)s.push(o);if(e>0)ff(s,r-1);if(t<this.length){let e=s.length;this.decomposeRight(t,s);ff(s,e)}return of.of(s)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left);if(this.break){i++;if(e>=i)t.push(null)}if(e>i)this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,n=i+this.break;if(e>=n)return this.right.decomposeRight(e-n,t);if(e<i)this.left.decomposeRight(e,t);if(this.break&&e<n)t.push(null);t.push(this.right)}balanced(e,t){if(e.size>2*t.size||t.size>2*e.size)return of.of(this.break?[e,null,t]:[e,t]);this.left=e;this.right=t;this.height=e.height+t.height;this.outdated=e.outdated||t.outdated;this.size=e.size+t.size;this.length=e.length+this.break+t.length;return this}updateHeight(e,t=0,i=false,n){let{left:s,right:r}=this,o=t+s.length+this.break,l=null;if(n&&n.from<=t+s.length&&n.more)l=s=s.updateHeight(e,t,i,n);else s.updateHeight(e,t,i);if(n&&n.from<=o+r.length&&n.more)l=r=r.updateHeight(e,o,i,n);else r.updateHeight(e,o,i);if(l)return this.balanced(s,r);this.height=this.left.height+this.right.height;this.outdated=false;return this}toString(){return this.left+(this.break?" ":"-")+this.right}}function ff(e,t){let i,n;if(null==e[t]&&(i=e[t-1])instanceof hf&&(n=e[t+1])instanceof hf)e.splice(t-1,3,new hf(i.length+1+n.length))}const uf=5;class df{constructor(e,t){this.pos=e;this.oracle=t;this.nodes=[];this.lineStart=-1;this.lineEnd=-1;this.covering=null;this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];if(i instanceof af)i.length+=e-this.pos;else if(e>this.pos||!this.isCovered)this.nodes.push(new af(e-this.pos,-1));this.writtenTo=e;if(t>e){this.nodes.push(null);this.writtenTo++;this.lineStart=-1}}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;if(n<0)n=this.oracle.lineHeight;let s=t-e;if(i.block)this.addBlock(new lf(s,n,i.type));else if(s||n>=uf)this.addLineDeco(n,s)}else if(t>e)this.span(e,t);if(this.lineEnd>-1&&this.lineEnd<this.pos)this.lineEnd=this.oracle.doc.lineAt(this.pos).to}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e;this.lineEnd=t;if(this.writtenTo<e){if(this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])this.nodes.push(this.blankContent(this.writtenTo,e-1));this.nodes.push(null)}if(this.pos>e)this.nodes.push(new af(this.pos-e,-1));this.writtenTo=this.pos}blankContent(e,t){let i=new hf(t-e);if(this.oracle.doc.lineAt(e).to==t)i.flags|=4;return i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof af)return e;let t=new af(0,-1);this.nodes.push(t);return t}addBlock(e){this.enterLine();if(e.type==$a.WidgetAfter&&!this.isCovered)this.ensureLine();this.nodes.push(e);this.writtenTo=this.pos=this.pos+e.length;if(e.type!=$a.WidgetBefore)this.covering=e}addLineDeco(e,t){let i=this.ensureLine();i.length+=t;i.collapsed+=t;i.widgetHeight=Math.max(i.widgetHeight,e);this.writtenTo=this.pos=this.pos+t}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];if(this.lineStart>-1&&!(t instanceof af)&&!this.isCovered)this.nodes.push(new af(0,-1));else if(this.writtenTo<this.pos||null==t)this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let n of this.nodes){if(n instanceof af)n.updateHeight(this.oracle,i);i+=n?n.length:1}return this.nodes}static build(e,t,i,n){let s=new df(i,e);cl.spans(t,i,n,s,0);return s.finish(i)}}function pf(e,t,i){let n=new mf;cl.compare(e,t,i,n,0);return n.changes}class mf{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,n){if(e<t||i&&i.heightRelevant||n&&n.heightRelevant)Qa(e,t,this.changes,5)}}function gf(e,t){let i=e.getBoundingClientRect();let n=Math.max(0,i.left),s=Math.min(innerWidth,i.right);let r=Math.max(0,i.top),o=Math.min(innerHeight,i.bottom);let l=e.ownerDocument.body;for(let a=e.parentNode;a&&a!=l;)if(1==a.nodeType){let t=a;let i=window.getComputedStyle(t);if((t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)&&"visible"!=i.overflow){let i=t.getBoundingClientRect();n=Math.max(n,i.left);s=Math.min(s,i.right);r=Math.max(r,i.top);o=a==e.parentNode?i.bottom:Math.min(o,i.bottom)}a="absolute"==i.position||"fixed"==i.position?t.offsetParent:t.parentNode}else if(11==a.nodeType)a=a.host;else break;return{left:n-i.left,right:Math.max(n,s)-i.left,top:r-(i.top+t),bottom:Math.max(r,o)-(i.top+t)}}function vf(e,t){let i=e.getBoundingClientRect();return{left:0,right:i.right-i.left,top:t,bottom:i.bottom-(i.top+t)}}class wf{constructor(e,t,i){this.from=e;this.to=t;this.size=i}static same(e,t){if(e.length!=t.length)return false;for(let i=0;i<e.length;i++){let n=e[i],s=t[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return false}return true}draw(e){return Ua.replace({widget:new yf(this.size,e)}).range(this.from,this.to)}}class yf extends ja{constructor(e,t){super();this.size=e;this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");if(this.vertical)e.style.height=this.size+"px";else{e.style.width=this.size+"px";e.style.height="2px";e.style.display="inline-block"}return e}get estimatedHeight(){return this.vertical?this.size:-1}}class bf{constructor(e){this.state=e;this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0};this.inView=true;this.paddingTop=0;this.paddingBottom=0;this.contentDOMWidth=0;this.contentDOMHeight=0;this.editorHeight=0;this.editorWidth=0;this.heightOracle=new ef;this.scaler=Of;this.scrollTarget=null;this.printing=false;this.mustMeasureContent=true;this.defaultTextDirection=Oh.RTL;this.visibleRanges=[];this.mustEnforceCursorAssoc=false;this.stateDeco=e.facet(xh).filter((e=>"function"!=typeof e));this.heightMap=of.empty().applyChanges(this.stateDeco,_r.empty,this.heightOracle.setDoc(e.doc),[new Ah(0,0,0,e.doc.length)]);this.viewport=this.getViewport(0,null);this.updateViewportLines();this.updateForViewport();this.lineGaps=this.ensureLineGaps([]);this.lineGapDeco=Ua.set(this.lineGaps.map((e=>e.draw(false))));this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let n=i?t.head:t.anchor;if(!e.some((({from:e,to:t})=>n>=e&&n<=t))){let{from:t,to:i}=this.lineBlockAt(n);e.push(new xf(t,i))}}this.viewports=e.sort(((e,t)=>e.from-t.from));this.scaler=this.heightMap.height<=7e6?Of:new Df(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[];this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(e=>{this.viewportLines.push(1==this.scaler.scale?e:Tf(e,this.scaler))}))}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(xh).filter((e=>"function"!=typeof e));let n=e.changedRanges;let s=Ah.extendWithRanges(n,pf(i,this.stateDeco,e?e.changes:no.empty(this.state.doc.length)));let r=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s);if(this.heightMap.height!=r)e.flags|=2;let o=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;if(t&&(t.range.head<o.from||t.range.head>o.to)||!this.viewportIsAppropriate(o))o=this.getViewport(0,t);let l=!e.changes.empty||2&e.flags||o.from!=this.viewport.from||o.to!=this.viewport.to;this.viewport=o;this.updateForViewport();if(l)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes)));e.flags|=this.computeVisibleRanges();if(t)this.scrollTarget=t;if(!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc)this.mustEnforceCursorAssoc=true}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t);let n=this.heightOracle;let s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?Oh.RTL:Oh.LTR;let r=this.heightOracle.mustRefreshForWrapping(s);let o=r||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight;this.contentDOMHeight=t.clientHeight;this.mustMeasureContent=false;let l=0,a=0;let h=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;if(this.paddingTop!=h||this.paddingBottom!=c){this.paddingTop=h;this.paddingBottom=c;l|=8|2}if(this.editorWidth!=e.scrollDOM.clientWidth){if(n.lineWrapping)o=true;this.editorWidth=e.scrollDOM.clientWidth;l|=8}let f=(this.printing?vf:gf)(t,this.paddingTop);let u=f.top-this.pixelViewport.top,d=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView){this.inView=p;if(p)o=true}if(!this.inView)return 0;let m=t.clientWidth;if(this.contentDOMWidth!=m||this.editorHeight!=e.scrollDOM.clientHeight){this.contentDOMWidth=m;this.editorHeight=e.scrollDOM.clientHeight;l|=8}if(o){let t=e.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(t))r=true;if(r||n.lineWrapping&&Math.abs(m-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:o}=e.docView.measureTextSize();r=n.refresh(s,i,o,m/o,t);if(r){e.docView.minWidth=0;l|=8}}if(u>0&&d>0)a=Math.max(u,d);else if(u<0&&d<0)a=Math.min(u,d);n.heightChanged=false;for(let i of this.viewports){let s=i.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(i);this.heightMap=this.heightMap.updateHeight(n,0,r,new tf(i.from,s))}if(n.heightChanged)l|=2}let g=!this.viewportIsAppropriate(this.viewport,a)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);if(g)this.viewport=this.getViewport(a,this.scrollTarget);this.updateForViewport();if(2&l||g)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)this.updateLineGaps(this.ensureLineGaps(r?[]:this.lineGaps));l|=this.computeVisibleRanges();if(this.mustEnforceCursorAssoc){this.mustEnforceCursorAssoc=false;e.docView.enforceCursorAssoc()}return l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2));let n=this.heightMap,s=this.state.doc,{visibleTop:r,visibleBottom:o}=this;let l=new xf(n.lineAt(r-1e3*i,sf.ByHeight,s,0,0).from,n.lineAt(o+1e3*(1-i),sf.ByHeight,s,0,0).to);if(t){let{head:e}=t.range;if(e<l.from||e>l.to){let i=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top);let r=n.lineAt(e,sf.ByPos,s,0,0),o;if("center"==t.y)o=(r.top+r.bottom)/2-i/2;else if("start"==t.y||"nearest"==t.y&&e<l.from)o=r.top;else o=r.bottom-i;l=new xf(n.lineAt(o-1e3/2,sf.ByHeight,s,0,0).from,n.lineAt(o+i+1e3/2,sf.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let i=t.mapPos(e.from,-1),n=t.mapPos(e.to,1);return new xf(this.heightMap.lineAt(i,sf.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,sf.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return true;let{top:n}=this.heightMap.lineAt(e,sf.ByPos,this.state.doc,0,0);let{bottom:s}=this.heightMap.lineAt(t,sf.ByPos,this.state.doc,0,0);let{visibleTop:r,visibleBottom:o}=this;return(0==e||n<=r-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||s>=o+Math.max(10,Math.min(i,250)))&&n>r-2*1e3&&s<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let n of e)if(!t.touchesRange(n.from,n.to))i.push(new wf(t.mapPos(n.from),t.mapPos(n.to),n.size));return i}ensureLineGaps(e){let t=[];if(this.defaultTextDirection!=Oh.LTR)return t;for(let i of this.viewportLines){if(i.length<4e3)continue;let n=kf(i.from,i.to,this.stateDeco);if(n.total<4e3)continue;let s,r;if(this.heightOracle.lineWrapping){let e=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;s=Sf(n,(this.visibleTop-i.top-e)/i.height);r=Sf(n,(this.visibleBottom-i.top+e)/i.height)}else{let e=n.total*this.heightOracle.charWidth;let t=2e3*this.heightOracle.charWidth;s=Sf(n,(this.pixelViewport.left-t)/e);r=Sf(n,(this.pixelViewport.right+t)/e)}let o=[];if(s>i.from)o.push({from:i.from,to:s});if(r<i.to)o.push({from:r,to:i.to});let l=this.state.selection.main;if(l.from>=i.from&&l.from<=i.to)Af(o,l.from-10,l.from+10);if(!l.empty&&l.to>=i.from&&l.to<=i.to)Af(o,l.to-10,l.to+10);for(let{from:a,to:h}of o)if(h-a>1e3)t.push(Mf(e,(e=>e.from>=i.from&&e.to<=i.to&&Math.abs(e.from-a)<1e3&&Math.abs(e.to-h)<1e3))||new wf(a,h,this.gapSize(i,a,h,n)))}return t}gapSize(e,t,i,n){let s=Cf(n,i)-Cf(n,t);if(this.heightOracle.lineWrapping)return e.height*s;else return n.total*this.heightOracle.charWidth*s}updateLineGaps(e){if(!wf.same(e,this.lineGaps)){this.lineGaps=e;this.lineGapDeco=Ua.set(e.map((e=>e.draw(this.heightOracle.lineWrapping))))}}computeVisibleRanges(){let e=this.stateDeco;if(this.lineGaps.length)e=e.concat(this.lineGapDeco);let t=[];cl.spans(e,this.viewport.from,this.viewport.to,{span(e,i){t.push({from:e,to:i})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some(((e,i)=>e.from!=t[i].from||e.to!=t[i].to));this.visibleRanges=t;return i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find((t=>t.from<=e&&t.to>=e))||Tf(this.heightMap.lineAt(e,sf.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return Tf(this.heightMap.lineAt(this.scaler.fromDOM(e),sf.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return Tf(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class xf{constructor(e,t){this.from=e;this.to=t}}function kf(e,t,i){let n=[],s=e,r=0;cl.spans(i,e,t,{span(){},point(e,t){if(e>s){n.push({from:s,to:e});r+=e-s}s=t}},20);if(s<t){n.push({from:s,to:t});r+=t-s}return{total:r,ranges:n}}function Sf({total:e,ranges:t},i){if(i<=0)return t[0].from;if(i>=1)return t[t.length-1].to;let n=Math.floor(e*i);for(let s=0;;s++){let{from:e,to:i}=t[s],r=i-e;if(n<=r)return e+n;n-=r}}function Cf(e,t){let i=0;for(let{from:n,to:s}of e.ranges){if(t<=s){i+=t-n;break}i+=s-n}return i/e.total}function Af(e,t,i){for(let n=0;n<e.length;n++){let s=e[n];if(s.from<i&&s.to>t){let r=[];if(s.from<t)r.push({from:s.from,to:t});if(s.to>i)r.push({from:i,to:s.to});e.splice(n,1,...r);n+=r.length-1}}}function Mf(e,t){for(let i of e)if(t(i))return i;return}const Of={toDOM(e){return e},fromDOM(e){return e},scale:1};class Df{constructor(e,t,i){let n=0,s=0,r=0;this.viewports=i.map((({from:i,to:s})=>{let r=t.lineAt(i,sf.ByPos,e,0,0).top;let o=t.lineAt(s,sf.ByPos,e,0,0).bottom;n+=o-r;return{from:i,to:s,top:r,bottom:o,domTop:0,domBottom:0}}));this.scale=(7e6-n)/(t.height-n);for(let o of this.viewports){o.domTop=r+(o.top-s)*this.scale;r=o.domBottom=o.domTop+(o.bottom-o.top);s=o.bottom}}toDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return n+(e-i)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);i=s.bottom;n=s.domBottom}}fromDOM(e){for(let t=0,i=0,n=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return i+(e-n)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);i=s.bottom;n=s.domBottom}}}function Tf(e,t){if(1==t.scale)return e;let i=t.toDOM(e.top),n=t.toDOM(e.bottom);return new nf(e.from,e.length,i,n-i,Array.isArray(e.type)?e.type.map((e=>Tf(e,t))):e.type)}const Ef=mo.define({combine:e=>e.join(" ")});const Rf=mo.define({combine:e=>e.indexOf(true)>-1});const _f=Tl.newName(),Bf=Tl.newName(),Lf=Tl.newName();const Pf={"&light":"."+Bf,"&dark":"."+Lf};function Nf(e,t,i){return new Tl(t,{finish(t){return/&/.test(t)?t.replace(/&\w*/,(t=>{if("&"==t)return e;if(!i||!i[t])throw new RangeError(`Unsupported selector: ${t}`);return i[t]})):e+" "+t}})}const If=Nf("."+_f,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Pf);const Vf={childList:true,characterData:true,subtree:true,attributes:true,characterDataOldValue:true};const Ff=Oa.ie&&Oa.ie_version<=11;class Hf{constructor(e,t,i){this.view=e;this.onChange=t;this.onScrollChanged=i;this.active=false;this.selectionRange=new ea;this.selectionChanged=false;this.delayedFlush=-1;this.resizeTimeout=-1;this.queue=[];this.delayedAndroidKey=null;this.scrollTargets=[];this.intersection=null;this.resize=null;this.intersecting=false;this.gapIntersection=null;this.gaps=[];this.parentCheck=-1;this.dom=e.contentDOM;this.observer=new MutationObserver((t=>{for(let e of t)this.queue.push(e);if((Oa.ie&&Oa.ie_version<=11||Oa.ios&&e.composing)&&t.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)))this.flushSoon();else this.flush()}));if(Ff)this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue});this.flushSoon()};this.onSelectionChange=this.onSelectionChange.bind(this);this.onResize=this.onResize.bind(this);this.onPrint=this.onPrint.bind(this);this.onScroll=this.onScroll.bind(this);if("function"==typeof ResizeObserver){this.resize=new ResizeObserver((()=>{if(this.view.docView.lastUpdate<Date.now()-75)this.onResize()}));this.resize.observe(e.scrollDOM)}this.win=e.dom.ownerDocument.defaultView;this.addWindowListeners(this.win);this.start();if("function"==typeof IntersectionObserver){this.intersection=new IntersectionObserver((e=>{if(this.parentCheck<0)this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3);if(e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting){this.intersecting=!this.intersecting;if(this.intersecting!=this.view.inView)this.onScrollChanged(document.createEvent("Event"))}}),{});this.intersection.observe(this.dom);this.gapIntersection=new IntersectionObserver((e=>{if(e.length>0&&e[e.length-1].intersectionRatio>0)this.onScrollChanged(document.createEvent("Event"))}),{})}this.listenForScroll();this.readSelectionRange()}onScroll(e){if(this.intersecting)this.flush(false);this.onScrollChanged(e)}onResize(){if(this.resizeTimeout<0)this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1;this.view.requestMeasure()}),50)}onPrint(){this.view.viewState.printing=true;this.view.measure();setTimeout((()=>{this.view.viewState.printing=false;this.view.requestMeasure()}),500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some(((t,i)=>t!=e[i])))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:t}=this,i=this.selectionRange;if(t.state.facet(ph)?t.root.activeElement!=this.dom:!jl(t.dom,i))return;let n=i.anchorNode&&t.docView.nearest(i.anchorNode);if(n&&n.ignoreEvent(e))return;if((Oa.ie&&Oa.ie_version<=11||Oa.android&&Oa.chrome)&&!t.state.selection.main.empty&&i.focusNode&&Ul(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset))this.flushSoon();else this.flush(false)}readSelectionRange(){let{view:e}=this;let t=Oa.safari&&11==e.root.nodeType&&ql(this.dom.ownerDocument)==this.dom&&zf(this.view)||Wl(e.root);if(!t||this.selectionRange.eq(t))return false;let i=jl(this.dom,t);if(i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&aa(this.dom,t)){this.view.inputState.lastFocusTime=0;e.docView.updateSelection();return false}this.selectionRange.setRange(t);if(i)this.selectionChanged=true;return true}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset);this.selectionChanged=false}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(1==i.nodeType){if(!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i)e++;else if(!t)t=this.scrollTargets.slice(0,e);if(t)t.push(i);i=i.assignedSlot||i.parentNode}else if(11==i.nodeType)i=i.host;else break;if(e<this.scrollTargets.length&&!t)t=this.scrollTargets.slice(0,e);if(t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{this.stop();return e()}finally{this.start();this.clear()}}start(){if(this.active)return;this.observer.observe(this.dom,Vf);if(Ff)this.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.active=true}stop(){if(!this.active)return;this.active=false;this.observer.disconnect();if(Ff)this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)}clear(){this.processRecords();this.queue.length=0;this.selectionChanged=false}delayAndroidKey(e,t){if(!this.delayedAndroidKey)requestAnimationFrame((()=>{let e=this.delayedAndroidKey;this.delayedAndroidKey=null;this.delayedFlush=-1;if(!this.flush())ra(this.dom,e.key,e.keyCode)}));if(!this.delayedAndroidKey||"Enter"==e)this.delayedAndroidKey={key:e,keyCode:t}}flushSoon(){if(this.delayedFlush<0)this.delayedFlush=window.setTimeout((()=>{this.delayedFlush=-1;this.flush()}),20)}forceFlush(){if(this.delayedFlush>=0){window.clearTimeout(this.delayedFlush);this.delayedFlush=-1}this.flush()}processRecords(){let e=this.queue;for(let s of this.observer.takeRecords())e.push(s);if(e.length)this.queue=[];let t=-1,i=-1,n=false;for(let s of e){let e=this.readMutation(s);if(!e)continue;if(e.typeOver)n=true;if(-1==t)({from:t,to:i}=e);else{t=Math.min(e.from,t);i=Math.max(e.to,i)}}return{from:t,to:i,typeOver:n}}flush(e=true){if(this.delayedFlush>=0||this.delayedAndroidKey)return;if(e)this.readSelectionRange();let{from:t,to:i,typeOver:n}=this.processRecords();let s=this.selectionChanged&&jl(this.dom,this.selectionRange);if(t<0&&!s)return;this.view.inputState.lastFocusTime=0;this.selectionChanged=false;let r=this.view.state;let o=this.onChange(t,i,n);if(this.view.state==r)this.view.update([]);return o}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;t.markDirty("attributes"==e.type);if("attributes"==e.type)t.dirty|=4;if("childList"==e.type){let i=Wf(t,e.previousSibling||e.target.previousSibling,-1);let n=Wf(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:n?t.posBefore(n):t.posAtEnd,typeOver:false}}else if("characterData"==e.type)return{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue};else return null}setWindow(e){if(e!=this.win){this.removeWindowListeners(this.win);this.win=e;this.addWindowListeners(this.win)}}addWindowListeners(e){e.addEventListener("resize",this.onResize);e.addEventListener("beforeprint",this.onPrint);e.addEventListener("scroll",this.onScroll);e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll);e.removeEventListener("resize",this.onResize);e.removeEventListener("beforeprint",this.onPrint);e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,i;this.stop();null===(e=this.intersection)||void 0===e?void 0:e.disconnect();null===(t=this.gapIntersection)||void 0===t?void 0:t.disconnect();null===(i=this.resize)||void 0===i?void 0:i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win);clearTimeout(this.parentCheck);clearTimeout(this.resizeTimeout)}}function Wf(e,t,i){while(t){let n=fa.get(t);if(n&&n.parent==e)return n;let s=t.parentNode;t=s!=e.dom?s:i>0?t.nextSibling:t.previousSibling}return null}function zf(e){let t=null;function i(e){e.preventDefault();e.stopImmediatePropagation();t=e.getTargetRanges()[0]}e.contentDOM.addEventListener("beforeinput",i,true);e.dom.ownerDocument.execCommand("indent");e.contentDOM.removeEventListener("beforeinput",i,true);if(!t)return null;let n=t.startContainer,s=t.startOffset;let r=t.endContainer,o=t.endOffset;let l=e.docView.domAtPos(e.state.selection.main.anchor);if(Ul(l.node,l.offset,r,o))[n,s,r,o]=[r,o,n,s];return{anchorNode:n,anchorOffset:s,focusNode:r,focusOffset:o}}function qf(e,t,i,n){let s,r;let o=e.state.selection.main;if(t>-1){let n=e.docView.domBoundsAround(t,i,0);if(!n||e.state.readOnly)return false;let{from:l,to:a}=n;let h=e.docView.impreciseHead||e.docView.impreciseAnchor?[]:$f(e);let c=new jh(h,e.state);c.readRange(n.startDOM,n.endDOM);let f=o.from,u=null;if(8===e.inputState.lastKeyCode&&e.inputState.lastKeyTime>Date.now()-100||Oa.android&&c.text.length<a-l){f=o.to;u="end"}let d=jf(e.state.doc.sliceString(l,a,qh),c.text,f-l,u);if(d){if(Oa.chrome&&13==e.inputState.lastKeyCode&&d.toB==d.from+2&&c.text.slice(d.from,d.toB)==qh+qh)d.toB--;s={from:l+d.from,to:l+d.toA,insert:_r.of(c.text.slice(d.from,d.toB).split(qh))}}r=Uf(h,l)}else if(e.hasFocus||!e.state.facet(ph)){let t=e.observer.selectionRange;let{impreciseHead:i,impreciseAnchor:n}=e.docView;let s=i&&i.node==t.focusNode&&i.offset==t.focusOffset||!zl(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset);let l=n&&n.node==t.anchorNode&&n.offset==t.anchorOffset||!zl(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset);if(s!=o.head||l!=o.anchor)r=fo.single(l,s)}if(!s&&!r)return false;if(!s&&n&&!o.empty&&r&&r.main.empty)s={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,o.to)};else if(s&&s.from>=o.from&&s.to<=o.to&&(s.from!=o.from||s.to!=o.to)&&o.to-o.from-(s.to-s.from)<=4)s={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,s.from).append(s.insert).append(e.state.doc.slice(s.to,o.to))};else if((Oa.mac||Oa.android)&&s&&s.from==s.to&&s.from==o.head-1&&"."==s.insert.toString())s={from:o.from,to:o.to,insert:_r.of([" "])};if(s){let t=e.state;if(Oa.ios&&e.inputState.flushIOSKey(e))return true;if(Oa.android&&(s.from==o.from&&s.to==o.to&&1==s.insert.length&&2==s.insert.lines&&ra(e.contentDOM,"Enter",13)||s.from==o.from-1&&s.to==o.to&&0==s.insert.length&&ra(e.contentDOM,"Backspace",8)||s.from==o.from&&s.to==o.to+1&&0==s.insert.length&&ra(e.contentDOM,"Delete",46)))return true;let i=s.insert.toString();if(e.state.facet(hh).some((t=>t(e,s.from,s.to,i))))return true;if(e.inputState.composing>=0)e.inputState.composing++;let n;if(s.from>=o.from&&s.to<=o.to&&s.to-s.from>=(o.to-o.from)/3&&(!r||r.main.empty&&r.main.from==s.from+s.insert.length)&&e.inputState.composing<0){let i=o.from<s.from?t.sliceDoc(o.from,s.from):"";let r=o.to>s.to?t.sliceDoc(s.to,o.to):"";n=t.replaceSelection(e.state.toText(i+s.insert.sliceString(0,void 0,e.state.lineBreak)+r))}else{let i=t.changes(s);let l=r&&!t.selection.main.eq(r.main)&&r.main.to<=i.newLength?r.main:void 0;if(t.selection.ranges.length>1&&e.inputState.composing>=0&&s.to<=o.to&&s.to>=o.to-10){let r=e.state.sliceDoc(s.from,s.to);let a=Xh(e)||e.state.doc.lineAt(o.head);let h=o.to-s.to,c=o.to-o.from;n=t.changeByRange((n=>{if(n.from==o.from&&n.to==o.to)return{changes:i,range:l||n.map(i)};let f=n.to-h,u=f-r.length;if(n.to-n.from!=c||e.state.sliceDoc(u,f)!=r||a&&n.to>=a.from&&n.from<=a.to)return{range:n};let d=t.changes({from:u,to:f,insert:s.insert}),p=n.to-o.to;return{changes:d,range:!l?n.map(d):fo.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p))}}))}else n={changes:i,selection:l&&t.selection.replaceRange(l)}}let l="input.type";if(e.composing){l+=".compose";if(e.inputState.compositionFirstChange){l+=".start";e.inputState.compositionFirstChange=false}}e.dispatch(n,{scrollIntoView:true,userEvent:l});return true}else if(r&&!r.main.eq(o)){let t=false,i="select";if(e.inputState.lastSelectionTime>Date.now()-50){if("select"==e.inputState.lastSelectionOrigin)t=true;i=e.inputState.lastSelectionOrigin}e.dispatch({selection:r,scrollIntoView:t,userEvent:i});return true}else return false}function jf(e,t,i,n){let s=Math.min(e.length,t.length);let r=0;while(r<s&&e.charCodeAt(r)==t.charCodeAt(r))r++;if(r==s&&e.length==t.length)return null;let o=e.length,l=t.length;while(o>0&&l>0&&e.charCodeAt(o-1)==t.charCodeAt(l-1)){o--;l--}if("end"==n){let e=Math.max(0,r-Math.min(o,l));i-=o+e-r}if(o<r&&e.length<t.length){let e=i<=r&&i>=o?r-i:0;r-=e;l=r+(l-o);o=r}else if(l<r){let e=i<=r&&i>=l?r-i:0;r-=e;o=r+(o-l);l=r}return{from:r,toA:o,toB:l}}function $f(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:r}=e.observer.selectionRange;if(i){t.push(new Uh(i,n));if(s!=i||r!=n)t.push(new Uh(s,r))}return t}function Uf(e,t){if(0==e.length)return null;let i=e[0].pos,n=2==e.length?e[1].pos:i;return i>-1&&n>-1?fo.single(i+t,n+t):null}class Kf{constructor(e={}){this.plugins=[];this.pluginMap=new Map;this.editorAttrs={};this.contentAttrs={};this.bidiCache=[];this.destroyed=false;this.updateState=2;this.measureScheduled=-1;this.measureRequests=[];this.contentDOM=document.createElement("div");this.scrollDOM=document.createElement("div");this.scrollDOM.tabIndex=-1;this.scrollDOM.className="cm-scroller";this.scrollDOM.appendChild(this.contentDOM);this.announceDOM=document.createElement("div");this.announceDOM.style.cssText="position: absolute; top: -10000px";this.announceDOM.setAttribute("aria-live","polite");this.dom=document.createElement("div");this.dom.appendChild(this.announceDOM);this.dom.appendChild(this.scrollDOM);this._dispatch=e.dispatch||(e=>this.update([e]));this.dispatch=this.dispatch.bind(this);this._root=e.root||oa(e.parent)||document;this.viewState=new bf(e.state||sl.create(e));this.plugins=this.state.facet(gh).map((e=>new wh(e)));for(let t of this.plugins)t.update(this);this.observer=new Hf(this,((e,t,i)=>qf(this,e,t,i)),(e=>{this.inputState.runScrollHandlers(this,e);if(this.observer.intersecting)this.measure()}));this.inputState=new xc(this);this.inputState.ensureHandlers(this,this.plugins);this.docView=new Kh(this);this.mountStyles();this.updateAttrs();this.updateState=0;this.requestMeasure();if(e.parent)e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}dispatch(...e){this._dispatch(1==e.length&&e[0]instanceof jo?e[0]:this.state.update(...e))}update(e){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=false,i=false,n;let s=this.state;for(let o of e){if(o.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=o.state}if(this.destroyed){this.viewState.state=s;return}this.observer.clear();if(s.facet(sl.phrases)!=this.state.facet(sl.phrases))return this.setState(s);n=Mh.create(this,s,e);let r=this.viewState.scrollTarget;try{this.updateState=2;for(let t of e){if(r)r=r.map(t.changes);if(t.scrollIntoView){let{main:e}=t.state.selection;r=new fh(e.empty?e:fo.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)if(e.is(uh))r=e.value}this.viewState.update(n,r);this.bidiCache=Xf.update(this.bidiCache,n.changes);if(!n.empty){this.updatePlugins(n);this.inputState.update(n)}t=this.docView.update(n);if(this.state.facet(Ch)!=this.styleModules)this.mountStyles();i=this.updateAttrs();this.showAnnouncements(e);this.docView.updateSelection(t,e.some((e=>e.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(n.startState.facet(Ef)!=n.state.facet(Ef))this.viewState.mustMeasureContent=true;if(t||i||r||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)this.requestMeasure();if(!n.empty)for(let o of this.state.facet(ah))o(n)}setState(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);this.viewState=new bf(e);this.plugins=e.facet(gh).map((e=>new wh(e)));this.pluginMap.clear();for(let e of this.plugins)e.update(this);this.docView=new Kh(this);this.inputState.ensureHandlers(this,this.plugins);this.mountStyles();this.updateAttrs();this.bidiCache=[]}finally{this.updateState=0}if(t)this.focus();this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(gh),i=e.state.facet(gh);if(t!=i){let n=[];for(let s of i){let i=t.indexOf(s);if(i<0)n.push(new wh(s));else{let t=this.plugins[i];t.mustUpdate=e;n.push(t)}}for(let t of this.plugins)if(t.mustUpdate!=e)t.destroy(this);this.plugins=n;this.pluginMap.clear();this.inputState.ensureHandlers(this,this.plugins)}else for(let n of this.plugins)n.mustUpdate=e;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this)}measure(e=true){if(this.destroyed)return;if(this.measureScheduled>-1)cancelAnimationFrame(this.measureScheduled);this.measureScheduled=0;if(e)this.observer.forceFlush();let t=null;let{scrollHeight:i,scrollTop:n,clientHeight:s}=this.scrollDOM;let r=n>i-s-4?i:n;try{for(let e=0;;e++){this.updateState=1;let i=this.viewport;let n=this.viewState.lineBlockAtHeight(r);let s=this.viewState.measure(this);if(!s&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5){void 0;break}let l=[];if(!(4&s))[this.measureRequests,l]=[l,this.measureRequests];let a=l.map((e=>{try{return e.read(this)}catch(t){dh(this.state,t);return Jf}}));let h=Mh.create(this,this.state,[]),c=false,f=false;h.flags|=s;if(!t)t=h;else t.flags|=s;this.updateState=2;if(!h.empty){this.updatePlugins(h);this.inputState.update(h);this.updateAttrs();c=this.docView.update(h)}for(let e=0;e<l.length;e++)if(a[e]!=Jf)try{let t=l[e];if(t.write)t.write(a[e],this)}catch(o){dh(this.state,o)}if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget);this.viewState.scrollTarget=null;f=true}else{let e=this.viewState.lineBlockAt(n.from).top-n.top;if(e>1||e<-1){this.scrollDOM.scrollTop+=e;f=true}}if(c)this.docView.updateSelection(true);if(this.viewport.from==i.from&&this.viewport.to==i.to&&!f&&0==this.measureRequests.length)break}}finally{this.updateState=0;this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(ah))l(t)}get themeClasses(){return _f+" "+(this.state.facet(Rf)?Lf:Bf)+" "+this.state.facet(Ef)}updateAttrs(){let e=Yf(this,yh,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses});let t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:!this.state.facet(ph)?"false":"true",class:"cm-content",style:`${Oa.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};if(this.state.readOnly)t["aria-readonly"]="true";Yf(this,bh,t);let i=this.observer.ignore((()=>{let i=qa(this.contentDOM,this.contentAttrs,t);let n=qa(this.dom,this.editorAttrs,e);return i||n}));this.editorAttrs=e;this.contentAttrs=t;return i}showAnnouncements(e){let t=true;for(let i of e)for(let e of i.effects)if(e.is(Kf.announce)){if(t)this.announceDOM.textContent="";t=false;let i=this.announceDOM.appendChild(document.createElement("div"));i.textContent=e.value}}mountStyles(){this.styleModules=this.state.facet(Ch);Tl.mount(this.root,this.styleModules.concat(If).reverse())}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");if(0==this.updateState&&this.measureScheduled>-1)this.measure(false)}requestMeasure(e){if(this.measureScheduled<0)this.measureScheduled=requestAnimationFrame((()=>this.measure()));if(e){if(null!=e.key)for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);if(void 0===t||t&&t.spec!=e)this.pluginMap.set(e,t=this.plugins.find((t=>t.spec==e))||null);return t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){this.readMeasured();return this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){this.readMeasured();return this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return bc(this,e,vc(this,e,t,i))}moveByGroup(e,t){return bc(this,e,vc(this,e,t,(t=>wc(this,e.head,t))))}moveToLineBoundary(e,t,i=true){return gc(this,e,t,i)}moveVertically(e,t,i){return bc(this,e,yc(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=true){this.readMeasured();return uc(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(e),s=this.bidiSpans(n);let r=s[Ih.find(s,e-n.from,-1,t)];return Yl(i,r.dir==Oh.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){let t=this.state.facet(ch);if(!t||e<this.viewport.from||e>this.viewport.to)return this.textDirection;this.readMeasured();return this.docView.textDirectionAt(e)}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Gf)return Hh(e.length);let t=this.textDirectionAt(e.from);for(let n of this.bidiCache)if(n.from==e.from&&n.dir==t)return n.order;let i=Fh(e.text,t);this.bidiCache.push(new Xf(e.from,e.to,t,i));return i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Oa.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{ia(this.contentDOM);this.docView.updateSelection()}))}setRoot(e){if(this._root!=e){this._root=e;this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView);this.mountStyles()}}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[];this.inputState.destroy();this.dom.remove();this.observer.destroy();if(this.measureScheduled>-1)cancelAnimationFrame(this.measureScheduled);this.destroyed=true}static scrollIntoView(e,t={}){return uh.of(new fh("number"==typeof e?fo.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return vh.define((()=>({})),{eventHandlers:e})}static theme(e,t){let i=Tl.newName();let n=[Ef.of(i),Ch.of(Nf(`.${i}`,e))];if(t&&t.dark)n.push(Rf.of(true));return n}static baseTheme(e){return Ao.lowest(Ch.of(Nf("."+_f,e,Pf)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content");let n=i&&fa.get(i)||fa.get(e);return(null===(t=null===n||void 0===n?void 0:n.rootView)||void 0===t?void 0:t.view)||null}}Kf.styleModule=Ch;Kf.inputHandler=hh;Kf.perLineTextDirection=ch;Kf.exceptionSink=lh;Kf.updateListener=ah;Kf.editable=ph;Kf.mouseSelectionStyle=oh;Kf.dragMovesSelection=rh;Kf.clickAddsSelectionRange=sh;Kf.decorations=xh;Kf.atomicRanges=kh;Kf.scrollMargins=Sh;Kf.darkTheme=Rf;Kf.contentAttributes=bh;Kf.editorAttributes=yh;Kf.lineWrapping=Kf.contentAttributes.of({class:"cm-lineWrapping"});Kf.announce=qo.define();const Gf=4096;const Jf={};class Xf{constructor(e,t,i,n){this.from=e;this.to=t;this.dir=i;this.order=n}static update(e,t){if(t.empty)return e;let i=[],n=e.length?e[e.length-1].dir:Oh.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let r=e[s];if(r.dir==n&&!t.touchesRange(r.from,r.to))i.push(new Xf(t.mapPos(r.from,1),t.mapPos(r.to,-1),r.dir,r.order))}return i}}function Yf(e,t,i){for(let n=e.state.facet(t),s=n.length-1;s>=0;s--){let t=n[s],r="function"==typeof t?t(e):t;if(r)Wa(r,i)}return i}const Qf=Oa.mac?"mac":Oa.windows?"win":Oa.linux?"linux":"key";function Zf(e,t){const i=e.split(/-(?!$)/);let n=i[i.length-1];if("Space"==n)n=" ";let s,r,o,l;for(let a=0;a<i.length-1;++a){const e=i[a];if(/^(cmd|meta|m)$/i.test(e))l=true;else if(/^a(lt)?$/i.test(e))s=true;else if(/^(c|ctrl|control)$/i.test(e))r=true;else if(/^s(hift)?$/i.test(e))o=true;else if(/^mod$/i.test(e))if("mac"==t)l=true;else r=true;else throw new Error("Unrecognized modifier name: "+e)}if(s)n="Alt-"+n;if(r)n="Ctrl-"+n;if(l)n="Meta-"+n;if(o)n="Shift-"+n;return n}function eu(e,t,i){if(t.altKey)e="Alt-"+e;if(t.ctrlKey)e="Ctrl-"+e;if(t.metaKey)e="Meta-"+e;if(false!==i&&t.shiftKey)e="Shift-"+e;return e}const tu=Ao.default(Kf.domEventHandlers({keydown(e,t){return hu(su(t.state),e,t,"editor")}}));const iu=mo.define({enables:tu});const nu=new WeakMap;function su(e){let t=e.facet(iu);let i=nu.get(t);if(!i)nu.set(t,i=au(t.reduce(((e,t)=>e.concat(t)),[])));return i}function ru(e,t,i){return hu(su(e.state),t,e,i)}let ou=null;const lu=4e3;function au(e,t=Qf){let i=Object.create(null);let n=Object.create(null);let s=(e,t)=>{let i=n[e];if(null==i)n[e]=t;else if(i!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")};let r=(e,n,r,o)=>{let l=i[e]||(i[e]=Object.create(null));let a=n.split(/ (?!$)/).map((e=>Zf(e,t)));for(let t=1;t<a.length;t++){let i=a.slice(0,t).join(" ");s(i,true);if(!l[i])l[i]={preventDefault:true,commands:[t=>{let n=ou={view:t,prefix:i,scope:e};setTimeout((()=>{if(ou==n)ou=null}),lu);return true}]}}let h=a.join(" ");s(h,false);let c=l[h]||(l[h]={preventDefault:false,commands:[]});c.commands.push(r);if(o)c.preventDefault=true};for(let o of e){let e=o[t]||o.key;if(!e)continue;for(let t of o.scope?o.scope.split(" "):["editor"]){r(t,e,o.run,o.preventDefault);if(o.shift)r(t,"Shift-"+e,o.shift,o.preventDefault)}}return i}function hu(e,t,i,n){let s=Hl(t);let r=Yr(s,0),o=Zr(r)==s.length&&" "!=s;let l="",a=false;if(ou&&ou.view==i&&ou.scope==n){l=ou.prefix+" ";if(a=Cc.indexOf(t.keyCode)<0)ou=null}let h=e=>{if(e){for(let t of e.commands)if(t(i))return true;if(e.preventDefault)a=true}return false};let c=e[n],f,u;if(c){if(h(c[l+eu(s,t,!o)]))return true;if(o&&(t.shiftKey||t.altKey||t.metaKey||r>127)&&(f=_l[t.keyCode])&&f!=s){if(h(c[l+eu(f,t,true)]))return true;else if(t.shiftKey&&(u=Bl[t.keyCode])!=s&&u!=f&&h(c[l+eu(u,t,false)]))return true}else if(o&&t.shiftKey)if(h(c[l+eu(s,t,true)]))return true}return a}const cu=!Oa.ios;const fu=mo.define({combine(e){return rl(e,{cursorBlinkRate:1200,drawRangeCursor:true},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function uu(e={}){return[fu.of(e),pu,gu]}class du{constructor(e,t,i,n,s){this.left=e;this.top=t;this.width=i;this.height=n;this.className=s}draw(){let e=document.createElement("div");e.className=this.className;this.adjust(e);return e}adjust(e){e.style.left=this.left+"px";e.style.top=this.top+"px";if(this.width>=0)e.style.width=this.width+"px";e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}const pu=vh.fromClass(class{constructor(e){this.view=e;this.rangePieces=[];this.cursors=[];this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)};this.selectionLayer=e.scrollDOM.appendChild(document.createElement("div"));this.selectionLayer.className="cm-selectionLayer";this.selectionLayer.setAttribute("aria-hidden","true");this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div"));this.cursorLayer.className="cm-cursorLayer";this.cursorLayer.setAttribute("aria-hidden","true");e.requestMeasure(this.measureReq);this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(fu).cursorBlinkRate+"ms"}update(e){let t=e.startState.facet(fu)!=e.state.facet(fu);if(t||e.selectionSet||e.geometryChanged||e.viewportChanged)this.view.requestMeasure(this.measureReq);if(e.transactions.some((e=>e.scrollIntoView)))this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink";if(t)this.setBlinkRate()}readPos(){let{state:e}=this.view,t=e.facet(fu);let i=e.selection.ranges.map((e=>e.empty?[]:bu(this.view,e))).reduce(((e,t)=>e.concat(t)));let n=[];for(let s of e.selection.ranges){let i=s==e.selection.main;if(s.empty?!i||cu:t.drawRangeCursor){let e=xu(this.view,s,i);if(e)n.push(e)}}return{rangePieces:i,cursors:n}}drawSel({rangePieces:e,cursors:t}){if(e.length!=this.rangePieces.length||e.some(((e,t)=>!e.eq(this.rangePieces[t])))){this.selectionLayer.textContent="";for(let t of e)this.selectionLayer.appendChild(t.draw());this.rangePieces=e}if(t.length!=this.cursors.length||t.some(((e,t)=>!e.eq(this.cursors[t])))){let e=this.cursorLayer.children;if(e.length!==t.length){this.cursorLayer.textContent="";for(const e of t)this.cursorLayer.appendChild(e.draw())}else t.forEach(((t,i)=>t.adjust(e[i])));this.cursors=t}}destroy(){this.selectionLayer.remove();this.cursorLayer.remove()}});const mu={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};if(cu)mu[".cm-line"].caretColor="transparent !important";const gu=Ao.highest(Kf.theme(mu));function vu(e){let t=e.scrollDOM.getBoundingClientRect();let i=e.textDirection==Oh.LTR?t.left:t.right-e.scrollDOM.clientWidth;return{left:i-e.scrollDOM.scrollLeft,top:t.top-e.scrollDOM.scrollTop}}function wu(e,t,i){let n=fo.cursor(t);return{from:Math.max(i.from,e.moveToLineBoundary(n,false,true).from),to:Math.min(i.to,e.moveToLineBoundary(n,true,true).from),type:$a.Text}}function yu(e,t){let i=e.lineBlockAt(t);if(Array.isArray(i.type))for(let n of i.type)if(n.to>t||n.to==t&&(n.to==i.to||n.type==$a.Text))return n;return i}function bu(e,t){if(t.to<=e.viewport.from||t.from>=e.viewport.to)return[];let i=Math.max(t.from,e.viewport.from),n=Math.min(t.to,e.viewport.to);let s=e.textDirection==Oh.LTR;let r=e.contentDOM,o=r.getBoundingClientRect(),l=vu(e);let a=window.getComputedStyle(r.firstChild);let h=o.left+parseInt(a.paddingLeft)+Math.min(0,parseInt(a.textIndent));let c=o.right-parseInt(a.paddingRight);let f=yu(e,i),u=yu(e,n);let d=f.type==$a.Text?f:null;let p=u.type==$a.Text?u:null;if(e.lineWrapping){if(d)d=wu(e,i,d);if(p)p=wu(e,n,p)}if(d&&p&&d.from==p.from)return g(v(t.from,t.to,d));else{let i=d?v(t.from,null,d):w(f,false);let n=p?v(null,t.to,p):w(u,true);let s=[];if((d||f).to<(p||u).from-1)s.push(m(h,i.bottom,c,n.top));else if(i.bottom<n.top&&e.elementAtHeight((i.bottom+n.top)/2).type==$a.Text)i.bottom=n.top=(i.bottom+n.top)/2;return g(i).concat(s).concat(g(n))}function m(e,t,i,n){return new du(e-l.left,t-l.top-.01,i-e,n-t+.01,"cm-selectionBackground")}function g({top:e,bottom:t,horizontal:i}){let n=[];for(let s=0;s<i.length;s+=2)n.push(m(i[s],e,i[s+1],t));return n}function v(t,i,n){let r=1e9,o=-1e9,l=[];function a(t,i,a,f,u){let d=e.coordsAtPos(t,t==n.to?-2:2);let p=e.coordsAtPos(a,a==n.from?2:-2);r=Math.min(d.top,p.top,r);o=Math.max(d.bottom,p.bottom,o);if(u==Oh.LTR)l.push(s&&i?h:d.left,s&&f?c:p.right);else l.push(!s&&f?h:p.left,!s&&i?c:d.right)}let f=null!==t&&void 0!==t?t:n.from,u=null!==i&&void 0!==i?i:n.to;for(let s of e.visibleRanges)if(s.to>f&&s.from<u)for(let n=Math.max(s.from,f),r=Math.min(s.to,u);;){let s=e.state.doc.lineAt(n);for(let o of e.bidiSpans(s)){let e=o.from+s.from,l=o.to+s.from;if(e>=r)break;if(l>n)a(Math.max(e,n),null==t&&e<=f,Math.min(l,r),null==i&&l>=u,o.dir)}n=s.to+1;if(n>=r)break}if(0==l.length)a(f,null==t,u,null==i,e.textDirection);return{top:r,bottom:o,horizontal:l}}function w(e,t){let i=o.top+(t?e.top:e.bottom);return{top:i,bottom:i,horizontal:[]}}}function xu(e,t,i){let n=e.coordsAtPos(t.head,t.assoc||1);if(!n)return null;let s=vu(e);return new du(n.left-s.left,n.top-s.top,-1,n.bottom-n.top,i?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const ku=qo.define({map(e,t){return null==e?null:t.mapPos(e)}});const Su=ko.define({create(){return null},update(e,t){if(null!=e)e=t.changes.mapPos(e);return t.effects.reduce(((e,t)=>t.is(ku)?t.value:e),e)}});const Cu=vh.fromClass(class{constructor(e){this.view=e;this.cursor=null;this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let i=e.state.field(Su);if(null==i){if(null!=this.cursor){null===(t=this.cursor)||void 0===t?void 0:t.remove();this.cursor=null}}else{if(!this.cursor){this.cursor=this.view.scrollDOM.appendChild(document.createElement("div"));this.cursor.className="cm-dropCursor"}if(e.startState.field(Su)!=i||e.docChanged||e.geometryChanged)this.view.requestMeasure(this.measureReq)}}readPos(){let e=this.view.state.field(Su);let t=null!=e&&this.view.coordsAtPos(e);if(!t)return null;let i=this.view.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+this.view.scrollDOM.scrollLeft,top:t.top-i.top+this.view.scrollDOM.scrollTop,height:t.bottom-t.top}}drawCursor(e){if(this.cursor)if(e){this.cursor.style.left=e.left+"px";this.cursor.style.top=e.top+"px";this.cursor.style.height=e.height+"px"}else this.cursor.style.left="-100000px"}destroy(){if(this.cursor)this.cursor.remove()}setDropPos(e){if(this.view.state.field(Su)!=e)this.view.dispatch({effects:ku.of(e)})}},{eventHandlers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){if(e.target==this.view.contentDOM||!this.view.contentDOM.contains(e.relatedTarget))this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Au(){return[Su,Cu]}function Mu(e,t,i,n,s){t.lastIndex=0;for(let r=e.iterRange(i,n),o=i,l;!r.next().done;o+=r.value.length)if(!r.lineBreak)while(l=t.exec(r.value))s(o+l.index,l)}function Ou(e,t){let i=e.visibleRanges;if(1==i.length&&i[0].from==e.viewport.from&&i[0].to==e.viewport.to)return i;let n=[];for(let{from:s,to:r}of i){s=Math.max(e.state.doc.lineAt(s).from,s-t);r=Math.min(e.state.doc.lineAt(r).to,r+t);if(n.length&&n[n.length-1].to>=s)n[n.length-1].to=r;else n.push({from:s,to:r})}return n}class Du{constructor(e){const{regexp:t,decoration:i,decorate:n,boundary:s,maxLength:r=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=t;if(n)this.addMatch=(e,t,i,s)=>n(s,i,i+e[0].length,e,t);else if(i){let e="function"==typeof i?i:()=>i;this.addMatch=(t,i,n,s)=>s(n,n+t[0].length,e(t,i,n))}else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s;this.maxLength=r}createDeco(e){let t=new ul,i=t.add.bind(t);for(let{from:n,to:s}of Ou(e,this.maxLength))Mu(e.state.doc,this.regexp,n,s,((t,n)=>this.addMatch(n,e,t,i)));return t.finish()}updateDeco(e,t){let i=1e9,n=-1;if(e.docChanged)e.changes.iterChanges(((t,s,r,o)=>{if(o>e.view.viewport.from&&r<e.view.viewport.to){i=Math.min(r,i);n=Math.max(o,n)}}));if(e.viewportChanged||n-i>1e3)return this.createDeco(e.view);if(n>-1)return this.updateRange(e.view,t.map(e.changes),i,n);return t}updateRange(e,t,i,n){for(let s of e.visibleRanges){let r=Math.max(s.from,i),o=Math.min(s.to,n);if(o>r){let i=e.state.doc.lineAt(r),n=i.to<o?e.state.doc.lineAt(o):i;let l=Math.max(s.from,i.from),a=Math.min(s.to,n.to);if(this.boundary){for(;r>i.from;r--)if(this.boundary.test(i.text[r-1-i.from])){l=r;break}for(;o<n.to;o++)if(this.boundary.test(n.text[o-n.from])){a=o;break}}let h=[],c;let f=(e,t,i)=>h.push(i.range(e,t));if(i==n){this.regexp.lastIndex=l-i.from;while((c=this.regexp.exec(i.text))&&c.index<a-i.from)this.addMatch(c,e,c.index+i.from,f)}else Mu(e.state.doc,this.regexp,l,a,((t,i)=>this.addMatch(i,e,t,f)));t=t.update({filterFrom:l,filterTo:a,filter:(e,t)=>e<l||t>a,add:h})}}return t}}const Tu=null!=/x/.unicode?"gu":"g";const Eu=new RegExp("[\0-\b\n--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\ufeff￹-￼]",Tu);const Ru={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _u=null;function Bu(){var e;if(null==_u&&"undefined"!=typeof document&&document.body){let t=document.body.style;_u=null!=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize)}return _u||false}const Lu=mo.define({combine(e){let t=rl(e,{render:null,specialChars:Eu,addSpecialChars:null});if(t.replaceTabs=!Bu())t.specialChars=new RegExp("\t|"+t.specialChars.source,Tu);if(t.addSpecialChars)t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Tu);return t}});function Pu(e={}){return[Lu.of(e),Iu()]}let Nu=null;function Iu(){return Nu||(Nu=vh.fromClass(class{constructor(e){this.view=e;this.decorations=Ua.none;this.decorationCache=Object.create(null);this.decorator=this.makeDecorator(e.state.facet(Lu));this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new Du({regexp:e.specialChars,decoration:(t,i,n)=>{let{doc:s}=i.state;let r=Yr(t[0],0);if(9==r){let e=s.lineAt(n);let t=i.state.tabSize,r=Sl(e.text,t,n-e.from);return Ua.replace({widget:new Wu((t-r%t)*this.view.defaultCharacterWidth)})}return this.decorationCache[r]||(this.decorationCache[r]=Ua.replace({widget:new Hu(e,r)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(Lu);if(e.startState.facet(Lu)!=t){this.decorator=this.makeDecorator(t);this.decorations=this.decorator.createDeco(e.view)}else this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))}const Vu="•";function Fu(e){if(e>=32)return Vu;if(10==e)return"␤";return String.fromCharCode(9216+e)}class Hu extends ja{constructor(e,t){super();this.options=e;this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Fu(this.code);let i=e.state.phrase("Control character")+" "+(Ru[this.code]||"0x"+this.code.toString(16));let n=this.options.render&&this.options.render(this.code,i,t);if(n)return n;let s=document.createElement("span");s.textContent=t;s.title=i;s.setAttribute("aria-label",i);s.className="cm-specialChar";return s}ignoreEvent(){return false}}class Wu extends ja{constructor(e){super();this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");e.textContent="\t";e.className="cm-tab";e.style.width=this.width+"px";return e}ignoreEvent(){return false}}function zu(){return ju}const qu=Ua.line({class:"cm-activeLine"});const ju=vh.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){if(e.docChanged||e.selectionSet)this.decorations=this.getDeco(e.view)}getDeco(e){let t=-1,i=[];for(let n of e.state.selection.ranges){if(!n.empty)return Ua.none;let s=e.lineBlockAt(n.head);if(s.from>t){i.push(qu.range(s.from));t=s.from}}return Ua.set(i)}},{decorations:e=>e.decorations});const $u=2e3;function Uu(e,t,i){let n=Math.min(t.line,i.line),s=Math.max(t.line,i.line);let r=[];if(t.off>$u||i.off>$u||t.col<0||i.col<0){let o=Math.min(t.off,i.off),l=Math.max(t.off,i.off);for(let t=n;t<=s;t++){let i=e.doc.line(t);if(i.length<=l)r.push(fo.range(i.from+o,i.to+l))}}else{let o=Math.min(t.col,i.col),l=Math.max(t.col,i.col);for(let t=n;t<=s;t++){let i=e.doc.line(t);let n=Cl(i.text,o,e.tabSize,true);if(n>-1){let t=Cl(i.text,l,e.tabSize);r.push(fo.range(i.from+n,i.from+t))}}}return r}function Ku(e,t){let i=e.coordsAtPos(e.viewport.from);return i?Math.round(Math.abs((i.left-t)/e.defaultCharacterWidth)):-1}function Gu(e,t){let i=e.posAtCoords({x:t.clientX,y:t.clientY},false);let n=e.state.doc.lineAt(i),s=i-n.from;let r=s>$u?-1:s==n.length?Ku(e,t.clientX):Sl(n.text,e.state.tabSize,i-n.from);return{line:n.number,col:r,off:s}}function Ju(e,t){let i=Gu(e,t),n=e.state.selection;if(!i)return null;return{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(i.line).from);let s=e.state.doc.lineAt(t);i={line:s.number,col:i.col,off:Math.min(i.off,s.length)};n=n.map(e.changes)}},get(t,s,r){let o=Gu(e,t);if(!o)return n;let l=Uu(e.state,i,o);if(!l.length)return n;if(r)return fo.create(l.concat(n.ranges));else return fo.create(l)}}}function Xu(e){let t=(null===e||void 0===e?void 0:e.eventFilter)||(e=>e.altKey&&0==e.button);return Kf.mouseSelectionStyle.of(((e,i)=>t(i)?Ju(e,i):null))}const Yu={Alt:[18,e=>e.altKey],Control:[17,e=>e.ctrlKey],Shift:[16,e=>e.shiftKey],Meta:[91,e=>e.metaKey]};const Qu={style:"cursor: crosshair"};function Zu(e={}){let[t,i]=Yu[e.key||"Alt"];let n=vh.fromClass(class{constructor(e){this.view=e;this.isDown=false}set(e){if(this.isDown!=e){this.isDown=e;this.view.update([])}}},{eventHandlers:{keydown(e){this.set(e.keyCode==t||i(e))},keyup(e){if(e.keyCode==t||!i(e))this.set(false)}}});return[n,Kf.contentAttributes.of((e=>{var t;return(null===(t=e.plugin(n))||void 0===t?void 0:t.isDown)?Qu:null}))]}const ed="-10000px";class td{constructor(e,t,i){this.facet=t;this.createTooltipView=i;this.input=e.state.facet(t);this.tooltips=this.input.filter((e=>e));this.tooltipViews=this.tooltips.map(i)}update(e){let t=e.state.facet(this.facet);let i=t.filter((e=>e));if(t===this.input){for(let t of this.tooltipViews)if(t.update)t.update(e);return false}let n=[];for(let s=0;s<i.length;s++){let t=i[s],r=-1;if(!t)continue;for(let e=0;e<this.tooltips.length;e++){let i=this.tooltips[e];if(i&&i.create==t.create)r=e}if(r<0)n[s]=this.createTooltipView(t);else{let t=n[s]=this.tooltipViews[r];if(t.update)t.update(e)}}for(let s of this.tooltipViews)if(n.indexOf(s)<0)s.dom.remove();this.input=t;this.tooltips=i;this.tooltipViews=n;return true}}function id(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const nd=mo.define({combine:e=>{var t,i,n;return{position:Oa.ios?"absolute":(null===(t=e.find((e=>e.position)))||void 0===t?void 0:t.position)||"fixed",parent:(null===(i=e.find((e=>e.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=e.find((e=>e.tooltipSpace)))||void 0===n?void 0:n.tooltipSpace)||id}}});const sd=vh.fromClass(class{constructor(e){var t;this.view=e;this.inView=true;this.lastTransaction=0;this.measureTimeout=-1;let i=e.state.facet(nd);this.position=i.position;this.parent=i.parent;this.classes=e.themeClasses;this.createContainer();this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this};this.manager=new td(e,ld,(e=>this.createTooltip(e)));this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((e=>{if(Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1)this.measureSoon()}),{threshold:[1]}):null;this.observeIntersection();null===(t=e.dom.ownerDocument.defaultView)||void 0===t?void 0:t.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this));this.maybeMeasure()}createContainer(){if(this.parent){this.container=document.createElement("div");this.container.style.position="relative";this.container.className=this.view.themeClasses;this.parent.appendChild(this.container)}else this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}measureSoon(){if(this.measureTimeout<0)this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1;this.maybeMeasure()}),50)}update(e){if(e.transactions.length)this.lastTransaction=Date.now();let t=this.manager.update(e);if(t)this.observeIntersection();let i=t||e.geometryChanged;let n=e.state.facet(nd);if(n.position!=this.position){this.position=n.position;for(let e of this.manager.tooltipViews)e.dom.style.position=this.position;i=true}if(n.parent!=this.parent){if(this.parent)this.container.remove();this.parent=n.parent;this.createContainer();for(let e of this.manager.tooltipViews)this.container.appendChild(e.dom);i=true}else if(this.parent&&this.view.themeClasses!=this.classes)this.classes=this.container.className=this.view.themeClasses;if(i)this.maybeMeasure()}createTooltip(e){let t=e.create(this.view);t.dom.classList.add("cm-tooltip");if(e.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow";t.dom.appendChild(e)}t.dom.style.position=this.position;t.dom.style.top=ed;this.container.appendChild(t.dom);if(t.mount)t.mount(this.view);return t}destroy(){var e,t;null===(e=this.view.dom.ownerDocument.defaultView)||void 0===e?void 0:e.removeEventListener("resize",this.measureSoon);for(let{dom:i}of this.manager.tooltipViews)i.remove();null===(t=this.intersectionObserver)||void 0===t?void 0:t.disconnect();clearTimeout(this.measureTimeout)}readMeasure(){let e=this.view.dom.getBoundingClientRect();return{editor:e,parent:this.parent?this.container.getBoundingClientRect():e,pos:this.manager.tooltips.map(((e,t)=>{let i=this.manager.tooltipViews[t];return i.getCoords?i.getCoords(e.pos):this.view.coordsAtPos(e.pos)})),size:this.manager.tooltipViews.map((({dom:e})=>e.getBoundingClientRect())),space:this.view.state.facet(nd).tooltipSpace(this.view)}}writeMeasure(e){let{editor:t,space:i}=e;let n=[];for(let s=0;s<this.manager.tooltips.length;s++){let r=this.manager.tooltips[s],o=this.manager.tooltipViews[s],{dom:l}=o;let a=e.pos[s],h=e.size[s];if(!a||a.bottom<=Math.max(t.top,i.top)||a.top>=Math.min(t.bottom,i.bottom)||a.right<Math.max(t.left,i.left)-.1||a.left>Math.min(t.right,i.right)+.1){l.style.top=ed;continue}let c=r.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null;let f=c?7:0;let u=h.right-h.left,d=h.bottom-h.top;let p=o.offset||od,m=this.view.textDirection==Oh.LTR;let g=h.width>i.right-i.left?m?i.left:i.right-h.width:m?Math.min(a.left-(c?14:0)+p.x,i.right-u):Math.max(i.left,a.left-u+(c?14:0)-p.x);let v=!!r.above;if(!r.strictSide&&(v?a.top-(h.bottom-h.top)-p.y<i.top:a.bottom+(h.bottom-h.top)+p.y>i.bottom)&&v==i.bottom-a.bottom>a.top-i.top)v=!v;let w=v?a.top-d-f-p.y:a.bottom+f+p.y;let y=g+u;if(true!==o.overlap)for(let e of n)if(e.left<y&&e.right>g&&e.top<w+d&&e.bottom>w)w=v?e.top-d-2-f:e.bottom+f+2;if("absolute"==this.position){l.style.top=w-e.parent.top+"px";l.style.left=g-e.parent.left+"px"}else{l.style.top=w+"px";l.style.left=g+"px"}if(c)c.style.left=`${a.left+(m?p.x:-p.x)-(g+14-7)}px`;if(true!==o.overlap)n.push({left:g,top:w,right:y,bottom:w+d});l.classList.toggle("cm-tooltip-above",v);l.classList.toggle("cm-tooltip-below",!v);if(o.positioned)o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length){if(this.view.inView)this.view.requestMeasure(this.measureReq);if(this.inView!=this.view.inView){this.inView=this.view.inView;if(!this.inView)for(let e of this.manager.tooltipViews)e.dom.style.top=ed}}}},{eventHandlers:{scroll(){this.maybeMeasure()}}});const rd=Kf.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}});const od={x:0,y:0};const ld=mo.define({enables:[sd,rd]});const ad=mo.define();class hd{constructor(e){this.view=e;this.mounted=false;this.dom=document.createElement("div");this.dom.classList.add("cm-tooltip-hover");this.manager=new td(e,ad,(e=>this.createHostedView(e)))}static create(e){return new hd(e)}createHostedView(e){let t=e.create(this.view);t.dom.classList.add("cm-tooltip-section");this.dom.appendChild(t.dom);if(this.mounted&&t.mount)t.mount(this.view);return t}mount(e){for(let t of this.manager.tooltipViews)if(t.mount)t.mount(e);this.mounted=true}positioned(){for(let e of this.manager.tooltipViews)if(e.positioned)e.positioned()}update(e){this.manager.update(e)}}const cd=ld.compute([ad],(e=>{let t=e.facet(ad).filter((e=>e));if(0===t.length)return null;return{pos:Math.min(...t.map((e=>e.pos))),end:Math.max(...t.filter((e=>null!=e.end)).map((e=>e.end))),create:hd.create,above:t[0].above,arrow:t.some((e=>e.arrow))}}));class fd{constructor(e,t,i,n,s){this.view=e;this.source=t;this.field=i;this.setHover=n;this.hoverTime=s;this.hoverTimeout=-1;this.restartTimeout=-1;this.pending=null;this.lastMove={x:0,y:0,target:e.dom,time:0};this.checkHover=this.checkHover.bind(this);e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this));e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){if(this.pending){this.pending=null;clearTimeout(this.restartTimeout);this.restartTimeout=setTimeout((()=>this.startHover()),20)}}get active(){return this.view.state.field(this.field)}checkHover(){this.hoverTimeout=-1;if(this.active)return;let e=Date.now()-this.lastMove.time;if(e<this.hoverTime)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e);else this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this;let t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(null==t)return;let i=this.view.coordsAtPos(t);if(null==i||e.y<i.top||e.y>i.bottom||e.x<i.left-this.view.defaultCharacterWidth||e.x>i.right+this.view.defaultCharacterWidth)return;let n=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find((e=>e.from<=t&&e.to>=t));let s=n&&n.dir==Oh.RTL?-1:1;let r=this.source(this.view,t,e.x<i.left?-s:s);if(null===r||void 0===r?void 0:r.then){let e=this.pending={pos:t};r.then((t=>{if(this.pending==e){this.pending=null;if(t)this.view.dispatch({effects:this.setHover.of(t)})}}),(e=>dh(this.view.state,e,"hover tooltip")))}else if(r)this.view.dispatch({effects:this.setHover.of(r)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()};if(this.hoverTimeout<0)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime);let i=this.active;if(i&&!ud(this.lastMove.target)||this.pending){let{pos:n}=i||this.pending,s=null!==(t=null===i||void 0===i?void 0:i.end)&&void 0!==t?t:n;if(n==s?this.view.posAtCoords(this.lastMove)!=n:!dd(this.view,n,s,e.clientX,e.clientY,6)){this.view.dispatch({effects:this.setHover.of(null)});this.pending=null}}}mouseleave(){clearTimeout(this.hoverTimeout);this.hoverTimeout=-1;if(this.active)this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout);this.view.dom.removeEventListener("mouseleave",this.mouseleave);this.view.dom.removeEventListener("mousemove",this.mousemove)}}function ud(e){for(let t=e;t;t=t.parentNode)if(1==t.nodeType&&t.classList.contains("cm-tooltip"))return true;return false}function dd(e,t,i,n,s,r){let o=document.createRange();let l=e.domAtPos(t),a=e.domAtPos(i);o.setEnd(a.node,a.offset);o.setStart(l.node,l.offset);let h=o.getClientRects();o.detach();for(let c=0;c<h.length;c++){let e=h[c];let t=Math.max(e.top-s,s-e.bottom,e.left-n,n-e.right);if(t<=r)return true}return false}function pd(e,t={}){let i=qo.define();let n=ko.define({create(){return null},update(e,n){if(e&&(t.hideOnChange&&(n.docChanged||n.selection)||t.hideOn&&t.hideOn(n,e)))return null;if(e&&n.docChanged){let t=n.changes.mapPos(e.pos,-1,to.TrackDel);if(null==t)return null;let i=Object.assign(Object.create(null),e);i.pos=t;if(null!=e.end)i.end=n.changes.mapPos(e.end);e=i}for(let t of n.effects){if(t.is(i))e=t.value;if(t.is(gd))e=null}return e},provide:e=>ad.from(e)});return[n,vh.define((s=>new fd(s,e,n,i,t.hoverTime||300))),cd]}function md(e,t){let i=e.plugin(sd);if(!i)return null;let n=i.manager.tooltips.indexOf(t);return n<0?null:i.manager.tooltipViews[n]}const gd=qo.define();const vd=mo.define({combine(e){let t,i;for(let n of e){t=t||n.topContainer;i=i||n.bottomContainer}return{topContainer:t,bottomContainer:i}}});function wd(e,t){let i=e.plugin(yd);let n=i?i.specs.indexOf(t):-1;return n>-1?i.panels[n]:null}const yd=vh.fromClass(class{constructor(e){this.input=e.state.facet(kd);this.specs=this.input.filter((e=>e));this.panels=this.specs.map((t=>t(e)));let t=e.state.facet(vd);this.top=new bd(e,true,t.topContainer);this.bottom=new bd(e,false,t.bottomContainer);this.top.sync(this.panels.filter((e=>e.top)));this.bottom.sync(this.panels.filter((e=>!e.top)));for(let i of this.panels){i.dom.classList.add("cm-panel");if(i.mount)i.mount()}}update(e){let t=e.state.facet(vd);if(this.top.container!=t.topContainer){this.top.sync([]);this.top=new bd(e.view,true,t.topContainer)}if(this.bottom.container!=t.bottomContainer){this.bottom.sync([]);this.bottom=new bd(e.view,false,t.bottomContainer)}this.top.syncClasses();this.bottom.syncClasses();let i=e.state.facet(kd);if(i!=this.input){let t=i.filter((e=>e));let n=[],s=[],r=[],o=[];for(let i of t){let t=this.specs.indexOf(i),l;if(t<0){l=i(e.view);o.push(l)}else{l=this.panels[t];if(l.update)l.update(e)}n.push(l);(l.top?s:r).push(l)}this.specs=t;this.panels=n;this.top.sync(s);this.bottom.sync(r);for(let e of o){e.dom.classList.add("cm-panel");if(e.mount)e.mount()}}else for(let n of this.panels)if(n.update)n.update(e)}destroy(){this.top.sync([]);this.bottom.sync([])}},{provide:e=>Kf.scrollMargins.of((t=>{let i=t.plugin(e);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}}))});class bd{constructor(e,t,i){this.view=e;this.top=t;this.container=i;this.dom=void 0;this.classes="";this.panels=[];this.syncClasses()}sync(e){for(let t of this.panels)if(t.destroy&&e.indexOf(t)<0)t.destroy();this.panels=e;this.syncDOM()}syncDOM(){if(0==this.panels.length){if(this.dom){this.dom.remove();this.dom=void 0}return}if(!this.dom){this.dom=document.createElement("div");this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom";this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){while(e!=t.dom)e=xd(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);while(e)e=xd(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!this.container||this.classes==this.view.themeClasses)return;for(let e of this.classes.split(" "))if(e)this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))if(e)this.container.classList.add(e)}}function xd(e){let t=e.nextSibling;e.remove();return t}const kd=mo.define({enables:yd});class Sd extends ol{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return false}destroy(e){}}Sd.prototype.elementClass="";Sd.prototype.toDOM=void 0;Sd.prototype.mapMode=to.TrackBefore;Sd.prototype.startSide=Sd.prototype.endSide=-1;Sd.prototype.point=true;const Cd=mo.define();const Ad={class:"",renderEmptyElements:false,elementStyle:"",markers:()=>cl.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}};const Md=mo.define();function Od(e){return[Td(),Md.of(Object.assign(Object.assign({},Ad),e))]}const Dd=mo.define({combine:e=>e.some((e=>e))});function Td(e){let t=[Ed];if(e&&false===e.fixed)t.push(Dd.of(true));return t}const Ed=vh.fromClass(class{constructor(e){this.view=e;this.prevViewport=e.viewport;this.dom=document.createElement("div");this.dom.className="cm-gutters";this.dom.setAttribute("aria-hidden","true");this.dom.style.minHeight=this.view.contentHeight+"px";this.gutters=e.state.facet(Md).map((t=>new Ld(e,t)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!e.state.facet(Dd);if(this.fixed)this.dom.style.position="sticky";this.syncGutters(false);e.scrollDOM.insertBefore(this.dom,e.contentDOM)}update(e){if(this.updateGutters(e)){let t=this.prevViewport,i=e.view.viewport;let n=Math.min(t.to,i.to)-Math.max(t.from,i.from);this.syncGutters(n<.8*(i.to-i.from))}if(e.geometryChanged)this.dom.style.minHeight=this.view.contentHeight+"px";if(this.view.state.facet(Dd)!=!this.fixed){this.fixed=!this.fixed;this.dom.style.position=this.fixed?"sticky":""}this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;if(e)this.dom.remove();let i=cl.iter(this.view.state.facet(Cd),this.view.viewport.from);let n=[];let s=this.gutters.map((e=>new Bd(e,this.view.viewport,-this.view.documentPadding.top)));for(let r of this.view.viewportLineBlocks){let e;if(Array.isArray(r.type)){for(let t of r.type)if(t.type==$a.Text){e=t;break}}else e=r.type==$a.Text?r:void 0;if(!e)continue;if(n.length)n=[];_d(i,n,r.from);for(let t of s)t.line(this.view,e,n)}for(let r of s)r.finish();if(e)this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){let t=e.startState.facet(Md),i=e.state.facet(Md);let n=e.docChanged||e.heightChanged||e.viewportChanged||!cl.eq(e.startState.facet(Cd),e.state.facet(Cd),e.view.viewport.from,e.view.viewport.to);if(t==i){for(let s of this.gutters)if(s.update(e))n=true}else{n=true;let s=[];for(let n of i){let i=t.indexOf(n);if(i<0)s.push(new Ld(this.view,n));else{this.gutters[i].update(e);s.push(this.gutters[i])}}for(let e of this.gutters){e.dom.remove();if(s.indexOf(e)<0)e.destroy()}for(let e of s)this.dom.appendChild(e.dom);this.gutters=s}return n}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove()}},{provide:e=>Kf.scrollMargins.of((t=>{let i=t.plugin(e);if(!i||0==i.gutters.length||!i.fixed)return null;return t.textDirection==Oh.LTR?{left:i.dom.offsetWidth}:{right:i.dom.offsetWidth}}))});function Rd(e){return Array.isArray(e)?e:[e]}function _d(e,t,i){while(e.value&&e.from<=i){if(e.from==i)t.push(e.value);e.next()}}class Bd{constructor(e,t,i){this.gutter=e;this.height=i;this.localMarkers=[];this.i=0;this.cursor=cl.iter(e.markers,t.from)}line(e,t,i){if(this.localMarkers.length)this.localMarkers=[];_d(this.cursor,this.localMarkers,t.from);let n=i.length?this.localMarkers.concat(i):this.localMarkers;let s=this.gutter.config.lineMarker(e,t,n);if(s)n.unshift(s);let r=this.gutter;if(0==n.length&&!r.config.renderEmptyElements)return;let o=t.top-this.height;if(this.i==r.elements.length){let i=new Pd(e,t.height,o,n);r.elements.push(i);r.dom.appendChild(i.dom)}else r.elements[this.i].update(e,t.height,o,n);this.height=t.bottom;this.i++}finish(){let e=this.gutter;while(e.elements.length>this.i){let t=e.elements.pop();e.dom.removeChild(t.dom);t.destroy()}}}class Ld{constructor(e,t){this.view=e;this.config=t;this.elements=[];this.spacer=null;this.dom=document.createElement("div");this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,(n=>{let s=e.lineBlockAtHeight(n.clientY-e.documentTop);if(t.domEventHandlers[i](e,s,n))n.preventDefault()}));this.markers=Rd(t.markers(e));if(t.initialSpacer){this.spacer=new Pd(e,0,0,[t.initialSpacer(e)]);this.dom.appendChild(this.spacer.dom);this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none"}}update(e){let t=this.markers;this.markers=Rd(this.config.markers(e.view));if(this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);if(t!=this.spacer.markers[0])this.spacer.update(e.view,0,0,[t])}let i=e.view.viewport;return!cl.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):false)}destroy(){for(let e of this.elements)e.destroy()}}class Pd{constructor(e,t,i,n){this.height=-1;this.above=0;this.markers=[];this.dom=document.createElement("div");this.dom.className="cm-gutterElement";this.update(e,t,i,n)}update(e,t,i,n){if(this.height!=t)this.dom.style.height=(this.height=t)+"px";if(this.above!=i)this.dom.style.marginTop=(this.above=i)?i+"px":"";if(!Nd(this.markers,n))this.setMarkers(e,n)}setMarkers(e,t){let i="cm-gutterElement",n=this.dom.firstChild;for(let s=0,r=0;;){let o=r,l=s<t.length?t[s++]:null,a=false;if(l){let e=l.elementClass;if(e)i+=" "+e;for(let t=r;t<this.markers.length;t++)if(this.markers[t].compare(l)){o=t;a=true;break}}else o=this.markers.length;while(r<o){let e=this.markers[r++];if(e.toDOM){e.destroy(n);let t=n.nextSibling;n.remove();n=t}}if(!l)break;if(l.toDOM)if(a)n=n.nextSibling;else this.dom.insertBefore(l.toDOM(e),n);if(a)r++}this.dom.className=i;this.markers=t}destroy(){this.setMarkers(null,[])}}function Nd(e,t){if(e.length!=t.length)return false;for(let i=0;i<e.length;i++)if(!e[i].compare(t[i]))return false;return true}const Id=mo.define();const Vd=mo.define({combine(e){return rl(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let n in t){let e=i[n],s=t[n];i[n]=e?(t,i,n)=>e(t,i,n)||s(t,i,n):s}return i}})}});class Fd extends Sd{constructor(e){super();this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Hd(e,t){return e.state.facet(Vd).formatNumber(t,e.state)}const Wd=Md.compute([Vd],(e=>({class:"cm-lineNumbers",renderEmptyElements:false,markers(e){return e.state.facet(Id)},lineMarker(e,t,i){if(i.some((e=>e.toDOM)))return null;return new Fd(Hd(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(Vd)!=e.state.facet(Vd),initialSpacer(e){return new Fd(Hd(e,qd(e.state.doc.lines)))},updateSpacer(e,t){let i=Hd(t.view,qd(t.view.state.doc.lines));return i==e.number?e:new Fd(i)},domEventHandlers:e.facet(Vd).domEventHandlers})));function zd(e={}){return[Vd.of(e),Td(),Wd]}function qd(e){let t=9;while(t<e)t=10*t+9;return t}const jd=new class extends Sd{constructor(){super(...arguments);this.elementClass="cm-activeLineGutter"}};const $d=Cd.compute(["selection"],(e=>{let t=[],i=-1;for(let n of e.selection.ranges)if(n.empty){let s=e.doc.lineAt(n.head).from;if(s>i){i=s;t.push(jd.range(s))}}return cl.of(t)}));function Ud(){return $d}const Kd=1024;let Gd=0;class Jd{constructor(e,t){this.from=e;this.to=t}}class Xd{constructor(e={}){this.id=Gd++;this.perNode=!!e.perNode;this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");if("function"!=typeof e)e=Qd.match(e);return t=>{let i=e(t);return void 0===i?null:[this,i]}}}Xd.closedBy=new Xd({deserialize:e=>e.split(" ")});Xd.openedBy=new Xd({deserialize:e=>e.split(" ")});Xd.group=new Xd({deserialize:e=>e.split(" ")});Xd.contextHash=new Xd({perNode:true});Xd.lookAhead=new Xd({perNode:true});Xd.mounted=new Xd({perNode:true});const Yd=Object.create(null);class Qd{constructor(e,t,i,n=0){this.name=e;this.props=t;this.id=i;this.flags=n}static define(e){let t=e.props&&e.props.length?Object.create(null):Yd;let i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0);let n=new Qd(e.name||"",t,e.id,i);if(e.props)for(let s of e.props){if(!Array.isArray(s))s=s(n);if(s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return n}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return true;let t=this.prop(Xd.group);return t?t.indexOf(e)>-1:false}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let n of i.split(" "))t[n]=e[i];return e=>{for(let i=e.prop(Xd.group),n=-1;n<(i?i.length:0);n++){let s=t[n<0?e.name:i[n]];if(s)return s}}}}Qd.none=new Qd("",Object.create(null),0,8);const Zd=new WeakMap,ep=new WeakMap;var tp;(function(e){e[e["ExcludeBuffers"]=1]="ExcludeBuffers";e[e["IncludeAnonymous"]=2]="IncludeAnonymous";e[e["IgnoreMounts"]=4]="IgnoreMounts";e[e["IgnoreOverlays"]=8]="IgnoreOverlays"})(tp||(tp={}));class ip{constructor(e,t,i,n,s){this.type=e;this.children=t;this.positions=i;this.length=n;this.props=null;if(s&&s.length){this.props=Object.create(null);for(let[e,t]of s)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=this.prop(Xd.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let e=i.toString();if(e){if(t)t+=",";t+=e}}return!this.type.name?t:(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":"")}cursor(e=0){return new dp(this.topNode,e)}cursorAt(e,t=0,i=0){let n=Zd.get(this)||this.topNode;let s=new dp(n);s.moveTo(e,t);Zd.set(this,s._tree);return s}get topNode(){return new ap(this,0,0,null)}resolve(e,t=0){let i=lp(Zd.get(this)||this.topNode,e,t,false);Zd.set(this,i);return i}resolveInner(e,t=0){let i=lp(ep.get(this)||this.topNode,e,t,true);ep.set(this,i);return i}iterate(e){let{enter:t,leave:i,from:n=0,to:s=this.length}=e;for(let r=this.cursor((e.mode||0)|tp.IncludeAnonymous);;){let e=false;if(r.from<=s&&r.to>=n&&(r.type.isAnonymous||false!==t(r))){if(r.firstChild())continue;e=true}for(;;){if(e&&i&&!r.type.isAnonymous)i(r);if(r.nextSibling())break;if(!r.parent())return;e=true}}}prop(e){return!e.perNode?this.type.prop(e):this.props?this.props[e.id]:void 0}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:wp(Qd.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,i)=>new ip(this.type,e,t,i,this.propValues)),e.makeTree||((e,t,i)=>new ip(Qd.none,e,t,i)))}static build(e){return mp(e)}}ip.empty=new ip(Qd.none,[],[],0);class np{constructor(e,t){this.buffer=e;this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new np(this.buffer,this.index)}}class sp{constructor(e,t,i){this.buffer=e;this.length=t;this.set=i}get type(){return Qd.none}toString(){let e=[];for(let t=0;t<this.buffer.length;){e.push(this.childString(t));t=this.buffer[t+3]}return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3];let n=this.set.types[t],s=n.name;if(/\W/.test(s)&&!n.isError)s=JSON.stringify(s);e+=4;if(i==e)return s;let r=[];while(e<i){r.push(this.childString(e));e=this.buffer[e+3]}return s+"("+r.join(",")+")"}findChild(e,t,i,n,s){let{buffer:r}=this,o=-1;for(let l=e;l!=t;l=r[l+3])if(rp(s,n,r[l+1],r[l+2])){o=l;if(i>0)break}return o}slice(e,t,i,n){let s=this.buffer;let r=new Uint16Array(t-e);for(let o=e,l=0;o<t;){r[l++]=s[o++];r[l++]=s[o++]-i;r[l++]=s[o++]-i;r[l++]=s[o++]-e}return new sp(r,n-i,this.set)}}function rp(e,t,i,n){switch(e){case-2:return i<t;case-1:return n>=t&&i<t;case 0:return i<t&&n>t;case 1:return i<=t&&n>t;case 2:return n>t;case 4:return true}}function op(e,t){let i=e.childBefore(t);while(i){let t=i.lastChild;if(!t||t.to!=i.to)break;if(t.type.isError&&t.from==t.to){e=i;i=t.prevSibling}else i=t}return e}function lp(e,t,i,n){var s;while(e.from==e.to||(i<1?e.from>=t:e.from>t)||(i>-1?e.to<=t:e.to<t)){let t=!n&&e instanceof ap&&e.index<0?null:e.parent;if(!t)return e;e=t}let r=n?0:tp.IgnoreOverlays;if(n)for(let o=e,l=o.parent;l;o=l,l=o.parent)if(o instanceof ap&&o.index<0&&(null===(s=l.enter(t,i,r))||void 0===s?void 0:s.from)!=o.from)e=l;for(;;){let n=e.enter(t,i,r);if(!n)return e;e=n}}class ap{constructor(e,t,i,n){this._tree=e;this.from=t;this.index=i;this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,n,s=0){for(let r=this;;){for(let{children:o,positions:l}=r._tree,a=t>0?o.length:-1;e!=a;e+=t){let a=o[e],h=l[e]+r.from;if(!rp(n,i,h,h+a.length))continue;if(a instanceof sp){if(s&tp.ExcludeBuffers)continue;let o=a.findChild(0,a.buffer.length,t,i-h,n);if(o>-1)return new up(new fp(r,a,e,h),null,o)}else if(s&tp.IncludeAnonymous||!a.type.isAnonymous||pp(a)){let o;if(!(s&tp.IgnoreMounts)&&a.props&&(o=a.prop(Xd.mounted))&&!o.overlay)return new ap(o.tree,h,e,r);let l=new ap(a,h,e,r);return s&tp.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(t<0?a.children.length-1:0,t,i,n)}}if(s&tp.IncludeAnonymous||!r.type.isAnonymous)return null;if(r.index>=0)e=r.index+t;else e=t<0?-1:r._parent._tree.children.length;r=r._parent;if(!r)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let n;if(!(i&tp.IgnoreOverlays)&&(n=this._tree.prop(Xd.mounted))&&n.overlay){let i=e-this.from;for(let{from:e,to:s}of n.overlay)if((t>0?e<=i:e<i)&&(t<0?s>=i:s>i))return new ap(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;while(e.type.isAnonymous&&e._parent)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new dp(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return lp(this,e,t,false)}resolveInner(e,t=0){return lp(this,e,t,true)}enterUnfinishedNodesBefore(e){return op(this,e)}getChild(e,t=null,i=null){let n=hp(this,e,t,i);return n.length?n[0]:null}getChildren(e,t=null,i=null){return hp(this,e,t,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return cp(this,e)}}function hp(e,t,i,n){let s=e.cursor(),r=[];if(!s.firstChild())return r;if(null!=i)while(!s.type.is(i))if(!s.nextSibling())return r;for(;;){if(null!=n&&s.type.is(n))return r;if(s.type.is(t))r.push(s.node);if(!s.nextSibling())return null==n?r:[]}}function cp(e,t,i=t.length-1){for(let n=e.parent;i>=0;n=n.parent){if(!n)return false;if(!n.type.isAnonymous){if(t[i]&&t[i]!=n.name)return false;i--}}return true}class fp{constructor(e,t,i,n){this.parent=e;this.buffer=t;this.index=i;this.start=n}}class up{constructor(e,t,i){this.context=e;this._parent=t;this.index=i;this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:n}=this.context;let s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,i);return s<0?null:new up(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&tp.ExcludeBuffers)return null;let{buffer:n}=this.context;let s=n.findChild(this.index+4,n.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new up(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context;let t=e.buffer[this.index+3];if(t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length))return new up(this.context,this._parent,t);return this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context;let t=this._parent?this._parent.index+4:0;if(this.index==t)return this.externalSibling(-1);return new up(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new dp(this,e)}get tree(){return null}toTree(){let e=[],t=[];let{buffer:i}=this.context;let n=this.index+4,s=i.buffer[this.index+3];if(s>n){let r=i.buffer[this.index+1],o=i.buffer[this.index+2];e.push(i.slice(n,s,r,o));t.push(0)}return new ip(this.type,e,t,this.to-this.from)}resolve(e,t=0){return lp(this,e,t,false)}resolveInner(e,t=0){return lp(this,e,t,true)}enterUnfinishedNodesBefore(e){return op(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let n=hp(this,e,t,i);return n.length?n[0]:null}getChildren(e,t=null,i=null){return hp(this,e,t,i)}get node(){return this}matchContext(e){return cp(this,e)}}class dp{constructor(e,t=0){this.mode=t;this.buffer=null;this.stack=[];this.index=0;this.bufferNode=null;if(e instanceof ap)this.yieldNode(e);else{this._tree=e.context.parent;this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e;this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){if(!e)return false;this._tree=e;this.type=e.type;this.from=e.from;this.to=e.to;return true}yieldBuf(e,t){this.index=e;let{start:i,buffer:n}=this.buffer;this.type=t||n.set.types[n.buffer[e]];this.from=i+n.buffer[e+1];this.to=i+n.buffer[e+2];return true}yield(e){if(!e)return false;if(e instanceof ap){this.buffer=null;return this.yieldNode(e)}this.buffer=e.context;return this.yieldBuf(e.index,e.type)}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:n}=this.buffer;let s=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,i);if(s<0)return false;this.stack.push(this.index);return this.yieldBuf(s)}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){if(!this.buffer)return this.yield(this._tree.enter(e,t,i));return i&tp.ExcludeBuffers?false:this.enterChild(1,e,t)}parent(){if(!this.buffer)return this.yieldNode(this.mode&tp.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&tp.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();this.buffer=null;return this.yieldNode(e)}sibling(e){if(!this.buffer)return!this._tree._parent?false:this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let e=i<0?0:this.stack[i]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(e)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):false}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:n}=this;if(n){if(e>0){if(this.index<n.buffer.buffer.length)return false}else for(let e=0;e<this.index;e++)if(n.buffer.buffer[e+3]<this.index)return false;({index:t,parent:i}=n)}else({index:t,_parent:i}=this._tree);for(;i;({index:t,_parent:i}=i))if(t>-1)for(let n=t+e,s=e<0?-1:i._tree.children.length;n!=s;n+=e){let e=i._tree.children[n];if(this.mode&tp.IncludeAnonymous||e instanceof sp||!e.type.isAnonymous||pp(e))return false}return true}move(e,t){if(t&&this.enterChild(e,0,4))return true;for(;;){if(this.sibling(e))return true;if(this.atLastNode(e)||!this.parent())return false}}next(e=true){return this.move(1,e)}prev(e=true){return this.move(-1,e)}moveTo(e,t=0){while(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))if(!this.parent())break;while(this.enterChild(1,e,t));return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let n=this.index,s=this.stack.length;s>=0;){for(let r=e;r;r=r._parent)if(r.index==n){if(n==this.index)return r;t=r;i=s+1;break e}n=this.stack[--s]}for(let n=i;n<this.stack.length;n++)t=new up(this.buffer,t,this.stack[n]);return this.bufferNode=new up(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let n=false;if(this.type.isAnonymous||false!==e(this)){if(this.firstChild()){i++;continue}if(!this.type.isAnonymous)n=true}for(;;){if(n&&t)t(this);n=this.type.isAnonymous;if(this.nextSibling())break;if(!i)return;this.parent();i--;n=true}}}matchContext(e){if(!this.buffer)return cp(this.node,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let n=e.length-1,s=this.stack.length-1;n>=0;s--){if(s<0)return cp(this.node,e,n);let r=i[t.buffer[this.stack[s]]];if(!r.isAnonymous){if(e[n]&&e[n]!=r.name)return false;n--}}return true}}function pp(e){return e.children.some((e=>e instanceof sp||!e.type.isAnonymous||pp(e)))}function mp(e){var t;let{buffer:i,nodeSet:n,maxBufferLength:s=Kd,reused:r=[],minRepeatType:o=n.types.length}=e;let l=Array.isArray(i)?new np(i,i.length):i;let a=n.types;let h=0,c=0;function f(e,t,i,v,w){let{id:y,start:b,end:x,size:k}=l;let S=c;while(k<0){l.next();if(-1==k){let t=r[y];i.push(t);v.push(b-e);return}else if(-3==k){h=y;return}else if(-4==k){c=y;return}else throw new RangeError(`Unrecognized record size: ${k}`)}let C=a[y],A,M;let O=b-e;if(x-b<=s&&(M=m(l.pos-t,w))){let t=new Uint16Array(M.size-M.skip);let i=l.pos-M.size,s=t.length;while(l.pos>i)s=g(M.start,t,s);A=new sp(t,x-M.start,n);O=M.start-e}else{let e=l.pos-k;l.next();let t=[],i=[];let n=y>=o?y:-1;let r=0,a=x;while(l.pos>e)if(n>=0&&l.id==n&&l.size>=0){if(l.end<=a-s){d(t,i,b,r,l.end,a,n,S);r=t.length;a=l.end}l.next()}else f(b,e,t,i,n);if(n>=0&&r>0&&r<t.length)d(t,i,b,r,b,a,n,S);t.reverse();i.reverse();if(n>-1&&r>0){let e=u(C);A=wp(C,t,i,0,t.length,0,x-b,e,e)}else A=p(C,t,i,x-b,S-x)}i.push(A);v.push(O)}function u(e){return(t,i,n)=>{let s=0,r=t.length-1,o,l;if(r>=0&&(o=t[r])instanceof ip){if(!r&&o.type==e&&o.length==n)return o;if(l=o.prop(Xd.lookAhead))s=i[r]+o.length+l}return p(e,t,i,n,s)}}function d(e,t,i,s,r,o,l,a){let h=[],c=[];while(e.length>s){h.push(e.pop());c.push(t.pop()+i-r)}e.push(p(n.types[l],h,c,o-r,a-o));t.push(r-i)}function p(e,t,i,n,s=0,r){if(h){let e=[Xd.contextHash,h];r=r?[e].concat(r):[e]}if(s>25){let e=[Xd.lookAhead,s];r=r?[e].concat(r):[e]}return new ip(e,t,i,n,r)}function m(e,t){let i=l.fork();let n=0,r=0,a=0,h=i.end-s;let c={size:0,start:0,skip:0};e:for(let s=i.pos-e;i.pos>s;){let e=i.size;if(i.id==t&&e>=0){c.size=n;c.start=r;c.skip=a;a+=4;n+=4;i.next();continue}let l=i.pos-e;if(e<0||l<s||i.start<h)break;let f=i.id>=o?4:0;let u=i.start;i.next();while(i.pos>l){if(i.size<0)if(-3==i.size)f+=4;else break e;else if(i.id>=o)f+=4;i.next()}r=u;n+=e;a+=f}if(t<0||n==e){c.size=n;c.start=r;c.skip=a}return c.size>4?c:void 0}function g(e,t,i){let{id:n,start:s,end:r,size:a}=l;l.next();if(a>=0&&n<o){let o=i;if(a>4){let n=l.pos-(a-4);while(l.pos>n)i=g(e,t,i)}t[--i]=o;t[--i]=r-e;t[--i]=s-e;t[--i]=n}else if(-3==a)h=n;else if(-4==a)c=n;return i}let v=[],w=[];while(l.pos>0)f(e.start||0,e.bufferStart||0,v,w,-1);let y=null!==(t=e.length)&&void 0!==t?t:v.length?w[0]+v[0].length:0;return new ip(a[e.topID],v.reverse(),w.reverse(),y)}const gp=new WeakMap;function vp(e,t){if(!e.isAnonymous||t instanceof sp||t.type!=e)return 1;let i=gp.get(t);if(null==i){i=1;for(let n of t.children){if(n.type!=e||!(n instanceof ip)){i=1;break}i+=vp(e,n)}gp.set(t,i)}return i}function wp(e,t,i,n,s,r,o,l,a){let h=0;for(let p=n;p<s;p++)h+=vp(e,t[p]);let c=Math.ceil(1.5*h/8);let f=[],u=[];function d(t,i,n,s,o){for(let l=n;l<s;){let n=l,h=i[l],p=vp(e,t[l]);l++;for(;l<s;l++){let i=vp(e,t[l]);if(p+i>=c)break;p+=i}if(l==n+1){if(p>c){let e=t[n];d(e.children,e.positions,0,e.children.length,i[n]+o);continue}f.push(t[n])}else{let s=i[l-1]+t[l-1].length-h;f.push(wp(e,t,i,n,l,h,s,null,a))}u.push(h+o-r)}}d(t,i,n,s,0);return(l||a)(f,u,o)}class yp{constructor(e,t,i,n,s=false,r=false){this.from=e;this.to=t;this.tree=i;this.offset=n;this.open=(s?1:0)|(r?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],i=false){let n=[new yp(0,e.length,e,0,false,i)];for(let s of t)if(s.to>e.length)n.push(s);return n}static applyChanges(e,t,i=128){if(!t.length)return e;let n=[];let s=1,r=e.length?e[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<t.length?t[o]:null;let c=h?h.fromA:1e9;if(c-l>=i)while(r&&r.from<c){let t=r;if(l>=t.from||c<=t.to||a){let e=Math.max(t.from,l)-a,i=Math.min(t.to,c)-a;t=e>=i?null:new yp(e,i,t.tree,t.offset+a,o>0,!!h)}if(t)n.push(t);if(r.to>c)break;r=s<e.length?e[s++]:null}if(!h)break;l=h.toA;a=h.toA-h.toB}return n}}class bp{startParse(e,t,i){if("string"==typeof e)e=new xp(e);i=!i?[new Jd(0,e.length)]:i.length?i.map((e=>new Jd(e.from,e.to))):[new Jd(0,0)];return this.createParse(e,t||[],i)}parse(e,t,i){let n=this.startParse(e,t,i);for(;;){let e=n.advance();if(e)return e}}}class xp{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return false}read(e,t){return this.string.slice(e,t)}}new Xd({perNode:true});let kp=0;class Sp{constructor(e,t,i){this.set=e;this.base=t;this.modified=i;this.id=kp++}static define(e){if(null===e||void 0===e?void 0:e.base)throw new Error("Can not derive from a modified tag");let t=new Sp([],null,[]);t.set.push(t);if(e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new Ap;return t=>{if(t.modified.indexOf(e)>-1)return t;return Ap.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}}}let Cp=0;class Ap{constructor(){this.instances=[];this.id=Cp++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find((i=>i.base==e&&Mp(t,i.modified)));if(i)return i;let n=[],s=new Sp(n,e,t);for(let o of t)o.instances.push(s);let r=Op(t);for(let o of e.set)for(let e of r)n.push(Ap.get(o,e));return s}}function Mp(e,t){return e.length==t.length&&e.every(((e,i)=>e==t[i]))}function Op(e){let t=[e];for(let i=0;i<e.length;i++)for(let n of Op(e.slice(0,i).concat(e.slice(i+1))))t.push(n);return t}function Dp(e){let t=Object.create(null);for(let i in e){let n=e[i];if(!Array.isArray(n))n=[n];for(let e of i.split(" "))if(e){let i=[],s=2,r=e;for(let t=0;;){if("..."==r&&t>0&&t+3==e.length){s=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(r);if(!n)throw new RangeError("Invalid path: "+e);i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]);t+=n[0].length;if(t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){s=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);r=e.slice(t)}let o=i.length-1,l=i[o];if(!l)throw new RangeError("Invalid path: "+e);let a=new Ep(n,s,o>0?i.slice(0,o):null);t[l]=a.sort(t[l])}}return Tp.add(t)}const Tp=new Xd;class Ep{constructor(e,t,i,n){this.tags=e;this.mode=t;this.context=i;this.next=n}sort(e){if(!e||e.depth<this.depth){this.next=e;return this}e.next=this.sort(e.next);return e}get depth(){return this.context?this.context.length:0}}function Rp(e,t){let i=Object.create(null);for(let r of e)if(!Array.isArray(r.tag))i[r.tag.id]=r.class;else for(let e of r.tag)i[e.id]=r.class;let{scope:n,all:s=null}=t||{};return{style:e=>{let t=s;for(let n of e)for(let e of n.set){let n=i[e.id];if(n){t=t?t+" "+n:n;break}}return t},scope:n}}function _p(e,t){let i=null;for(let n of e){let e=n.style(t);if(e)i=i?i+" "+e:e}return i}function Bp(e,t,i,n=0,s=e.length){let r=new Lp(n,Array.isArray(t)?t:[t],i);r.highlightRange(e.cursor(),n,s,"",r.highlighters);r.flush(s)}class Lp{constructor(e,t,i){this.at=e;this.highlighters=t;this.span=i;this.class=""}startSpan(e,t){if(t!=this.class){this.flush(e);if(e>this.at)this.at=e;this.class=t}}flush(e){if(e>this.at&&this.class)this.span(this.at,e,this.class)}highlightRange(e,t,i,n,s){let{type:r,from:o,to:l}=e;if(o>=i||l<=t)return;if(r.isTop)s=this.highlighters.filter((e=>!e.scope||e.scope(r)));let a=n;let h=r.prop(Tp),c=false;while(h){if(!h.context||e.matchContext(h.context)){let e=_p(s,h.tags);if(e){if(a)a+=" ";a+=e;if(1==h.mode)n+=(n?" ":"")+e;else if(0==h.mode)c=true}break}h=h.next}this.startSpan(e.from,a);if(c)return;let f=e.tree&&e.tree.prop(Xd.mounted);if(f&&f.overlay){let r=e.node.enter(f.overlay[0].from+o,1);let h=this.highlighters.filter((e=>!e.scope||e.scope(f.tree.type)));let c=e.firstChild();for(let u=0,d=o;;u++){let p=u<f.overlay.length?f.overlay[u]:null;let m=p?p.from+o:l;let g=Math.max(t,d),v=Math.min(i,m);if(g<v&&c)while(e.from<v){this.highlightRange(e,g,v,n,s);this.startSpan(Math.min(i,e.to),a);if(e.to>=m||!e.nextSibling())break}if(!p||m>i)break;d=p.to+o;if(d>t){this.highlightRange(r.cursor(),Math.max(t,p.from+o),Math.min(i,d),n,h);this.startSpan(d,a)}}if(c)e.parent()}else if(e.firstChild()){do{if(e.to<=t)continue;if(e.from>=i)break;this.highlightRange(e,t,i,n,s);this.startSpan(Math.min(i,e.to),a)}while(e.nextSibling());e.parent()}}}const Pp=Sp.define;const Np=Pp(),Ip=Pp(),Vp=Pp(Ip),Fp=Pp(Ip),Hp=Pp(),Wp=Pp(Hp),zp=Pp(Hp),qp=Pp(),jp=Pp(qp),$p=Pp(),Up=Pp(),Kp=Pp(),Gp=Pp(Kp),Jp=Pp();const Xp={comment:Np,lineComment:Pp(Np),blockComment:Pp(Np),docComment:Pp(Np),name:Ip,variableName:Pp(Ip),typeName:Vp,tagName:Pp(Vp),propertyName:Fp,attributeName:Pp(Fp),className:Pp(Ip),labelName:Pp(Ip),namespace:Pp(Ip),macroName:Pp(Ip),literal:Hp,string:Wp,docString:Pp(Wp),character:Pp(Wp),attributeValue:Pp(Wp),number:zp,integer:Pp(zp),float:Pp(zp),bool:Pp(Hp),regexp:Pp(Hp),escape:Pp(Hp),color:Pp(Hp),url:Pp(Hp),keyword:$p,self:Pp($p),null:Pp($p),atom:Pp($p),unit:Pp($p),modifier:Pp($p),operatorKeyword:Pp($p),controlKeyword:Pp($p),definitionKeyword:Pp($p),moduleKeyword:Pp($p),operator:Up,derefOperator:Pp(Up),arithmeticOperator:Pp(Up),logicOperator:Pp(Up),bitwiseOperator:Pp(Up),compareOperator:Pp(Up),updateOperator:Pp(Up),definitionOperator:Pp(Up),typeOperator:Pp(Up),controlOperator:Pp(Up),punctuation:Kp,separator:Pp(Kp),bracket:Gp,angleBracket:Pp(Gp),squareBracket:Pp(Gp),paren:Pp(Gp),brace:Pp(Gp),content:qp,heading:jp,heading1:Pp(jp),heading2:Pp(jp),heading3:Pp(jp),heading4:Pp(jp),heading5:Pp(jp),heading6:Pp(jp),contentSeparator:Pp(qp),list:Pp(qp),quote:Pp(qp),emphasis:Pp(qp),strong:Pp(qp),link:Pp(qp),monospace:Pp(qp),strikethrough:Pp(qp),inserted:Pp(),deleted:Pp(),changed:Pp(),invalid:Pp(),meta:Jp,documentMeta:Pp(Jp),annotation:Pp(Jp),processingInstruction:Pp(Jp),definition:Sp.defineModifier(),constant:Sp.defineModifier(),function:Sp.defineModifier(),standard:Sp.defineModifier(),local:Sp.defineModifier(),special:Sp.defineModifier()};Rp([{tag:Xp.link,class:"tok-link"},{tag:Xp.heading,class:"tok-heading"},{tag:Xp.emphasis,class:"tok-emphasis"},{tag:Xp.strong,class:"tok-strong"},{tag:Xp.keyword,class:"tok-keyword"},{tag:Xp.atom,class:"tok-atom"},{tag:Xp.bool,class:"tok-bool"},{tag:Xp.url,class:"tok-url"},{tag:Xp.labelName,class:"tok-labelName"},{tag:Xp.inserted,class:"tok-inserted"},{tag:Xp.deleted,class:"tok-deleted"},{tag:Xp.literal,class:"tok-literal"},{tag:Xp.string,class:"tok-string"},{tag:Xp.number,class:"tok-number"},{tag:[Xp.regexp,Xp.escape,Xp.special(Xp.string)],class:"tok-string2"},{tag:Xp.variableName,class:"tok-variableName"},{tag:Xp.local(Xp.variableName),class:"tok-variableName tok-local"},{tag:Xp.definition(Xp.variableName),class:"tok-variableName tok-definition"},{tag:Xp.special(Xp.variableName),class:"tok-variableName2"},{tag:Xp.definition(Xp.propertyName),class:"tok-propertyName tok-definition"},{tag:Xp.typeName,class:"tok-typeName"},{tag:Xp.namespace,class:"tok-namespace"},{tag:Xp.className,class:"tok-className"},{tag:Xp.macroName,class:"tok-macroName"},{tag:Xp.propertyName,class:"tok-propertyName"},{tag:Xp.operator,class:"tok-operator"},{tag:Xp.comment,class:"tok-comment"},{tag:Xp.meta,class:"tok-meta"},{tag:Xp.invalid,class:"tok-invalid"},{tag:Xp.punctuation,class:"tok-punctuation"}]);var Yp;const Qp=new Xd;class Zp{constructor(e,t,i=[]){this.data=e;if(!sl.prototype.hasOwnProperty("tree"))Object.defineProperty(sl.prototype,"tree",{get(){return tm(this)}});this.parser=t;this.extension=[cm.of(this),sl.languageData.of(((e,t,i)=>e.facet(em(e,t,i))))].concat(i)}isActiveAt(e,t,i=-1){return em(e,t,i)==this.data}findRegions(e){let t=e.facet(cm);if((null===t||void 0===t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[];let n=(e,t)=>{if(e.prop(Qp)==this.data){i.push({from:t,to:t+e.length});return}let s=e.prop(Xd.mounted);if(s)if(s.tree.prop(Qp)==this.data){if(s.overlay)for(let e of s.overlay)i.push({from:e.from+t,to:e.to+t});else i.push({from:t,to:t+e.length});return}else if(s.overlay){let e=i.length;n(s.tree,s.overlay[0].from+t);if(i.length>e)return}for(let i=0;i<e.children.length;i++){let s=e.children[i];if(s instanceof ip)n(s,e.positions[i]+t)}};n(tm(e),0);return i}get allowsNesting(){return true}}Zp.setState=qo.define();function em(e,t,i){let n=e.facet(cm);if(!n)return null;let s=n.data;if(n.allowsNesting)for(let r=tm(e).topNode;r;r=r.enter(t,i,tp.ExcludeBuffers))s=r.type.prop(Qp)||s;return s}function tm(e){let t=e.field(Zp.state,false);return t?t.tree:ip.empty}class im{constructor(e,t=e.length){this.doc=e;this.length=t;this.cursorPos=0;this.string="";this.cursor=e.iter()}syncTo(e){this.string=this.cursor.next(e-this.cursorPos).value;this.cursorPos=e+this.string.length;return this.cursorPos-this.string.length}chunk(e){this.syncTo(e);return this.string}get lineChunks(){return true}read(e,t){let i=this.cursorPos-this.string.length;if(e<i||t>=this.cursorPos)return this.doc.sliceString(e,t);else return this.string.slice(e-i,t-i)}}let nm=null;class sm{constructor(e,t,i=[],n,s,r,o,l){this.parser=e;this.state=t;this.fragments=i;this.tree=n;this.treeLen=s;this.viewport=r;this.skipped=o;this.scheduleOn=l;this.parse=null;this.tempSkipped=[]}static create(e,t,i){return new sm(e,t,[],ip.empty,0,i,[],null)}startParse(){return this.parser.startParse(new im(this.state.doc),this.fragments)}work(e,t){if(null!=t&&t>=this.state.doc.length)t=void 0;if(this.tree!=ip.empty&&this.isDone(null!==t&&void 0!==t?t:this.state.doc.length)){this.takeTree();return true}return this.withContext((()=>{var i;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}if(!this.parse)this.parse=this.startParse();if(null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length)this.parse.stopAt(t);for(;;){let n=this.parse.advance();if(n){this.fragments=this.withoutTempSkipped(yp.addTree(n,this.fragments,null!=this.parse.stoppedAt));this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length;this.tree=n;this.parse=null;if(this.treeLen<(null!==t&&void 0!==t?t:this.state.doc.length))this.parse=this.startParse();else return true}if(e())return false}}))}takeTree(){let e,t;if(this.parse&&(e=this.parse.parsedPos)>=this.treeLen){if(null==this.parse.stoppedAt||this.parse.stoppedAt>e)this.parse.stopAt(e);this.withContext((()=>{while(!(t=this.parse.advance()));}));this.treeLen=e;this.tree=t;this.fragments=this.withoutTempSkipped(yp.addTree(this.tree,this.fragments,true));this.parse=null}}withContext(e){let t=nm;nm=this;try{return e()}finally{nm=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=rm(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:n,treeLen:s,viewport:r,skipped:o}=this;this.takeTree();if(!e.empty){let t=[];e.iterChangedRanges(((e,i,n,s)=>t.push({fromA:e,toA:i,fromB:n,toB:s})));i=yp.applyChanges(i,t);n=ip.empty;s=0;r={from:e.mapPos(r.from,-1),to:e.mapPos(r.to,1)};if(this.skipped.length){o=[];for(let t of this.skipped){let i=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);if(i<n)o.push({from:i,to:n})}}}return new sm(this.parser,t,i,n,s,r,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return false;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:t,to:n}=this.skipped[i];if(t<e.to&&n>e.from){this.fragments=rm(this.fragments,t,n);this.skipped.splice(i--,1)}}if(this.skipped.length>=t)return false;this.reset();return true}reset(){if(this.parse){this.takeTree();this.parse=null}}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends bp{createParse(t,i,n){let s=n[0].from,r=n[n.length-1].to;let o={parsedPos:s,advance(){let t=nm;if(t){for(let e of n)t.tempSkipped.push(e);if(e)t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e}this.parsedPos=r;return new ip(Qd.none,[],[],r-s)},stoppedAt:null,stopAt(){}};return o}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return nm}}function rm(e,t,i){return yp.applyChanges(e,[{fromA:t,toA:i,fromB:t,toB:i}])}class om{constructor(e){this.context=e;this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state);let i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);if(!t.work(20,i))t.takeTree();return new om(t)}static init(e){let t=Math.min(3e3,e.doc.length);let i=sm.create(e.facet(cm).parser,e,{from:0,to:t});if(!i.work(20,t))i.takeTree();return new om(i)}}Zp.state=ko.define({create:om.init,update(e,t){for(let i of t.effects)if(i.is(Zp.setState))return i.value;if(t.startState.facet(cm)!=t.state.facet(cm))return om.init(t.state);return e.apply(t)}});let lm=e=>{let t=setTimeout((()=>e()),500);return()=>clearTimeout(t)};if("undefined"!=typeof requestIdleCallback)lm=e=>{let t=-1,i=setTimeout((()=>{t=requestIdleCallback(e,{timeout:500-100})}),100);return()=>t<0?clearTimeout(i):cancelIdleCallback(t)};const am="undefined"!=typeof navigator&&(null===(Yp=navigator.scheduling)||void 0===Yp?void 0:Yp.isInputPending)?()=>navigator.scheduling.isInputPending():null;const hm=vh.fromClass(class e{constructor(e){this.view=e;this.working=null;this.workScheduled=0;this.chunkEnd=-1;this.chunkBudget=-1;this.work=this.work.bind(this);this.scheduleWork()}update(e){let t=this.view.state.field(Zp.state).context;if(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)this.scheduleWork();if(e.docChanged){if(this.view.hasFocus)this.chunkBudget+=50;this.scheduleWork()}this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Zp.state);if(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))this.working=lm(this.work)}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)){this.chunkEnd=t+3e4;this.chunkBudget=3e3}if(this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,s=i.field(Zp.state);if(s.tree==s.context.tree&&s.context.isDone(n+1e5))return;let r=Date.now()+Math.min(this.chunkBudget,100,e&&!am?Math.max(25,e.timeRemaining()-5):1e9);let o=s.context.treeLen<n&&i.doc.length>n+1e3;let l=s.context.work((()=>am&&am()||Date.now()>r),n+(o?0:1e5));this.chunkBudget-=Date.now()-t;if(l||this.chunkBudget<=0){s.context.takeTree();this.view.dispatch({effects:Zp.setState.of(new om(s.context))})}if(this.chunkBudget>0&&!(l&&!o))this.scheduleWork();this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){if(e.scheduleOn){this.workScheduled++;e.scheduleOn.then((()=>this.scheduleWork())).catch((e=>dh(this.view.state,e))).then((()=>this.workScheduled--));e.scheduleOn=null}}destroy(){if(this.working)this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}});const cm=mo.define({combine(e){return e.length?e[0]:null},enables:[Zp.state,hm]});const fm=mo.define();const um=mo.define({combine:e=>{if(!e.length)return"  ";if(!/^(?: +|\t+)$/.test(e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return e[0]}});function dm(e){let t=e.facet(um);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function pm(e,t){let i="",n=e.tabSize;if(9==e.facet(um).charCodeAt(0))while(t>=n){i+="\t";t-=n}for(let s=0;s<t;s++)i+=" ";return i}function mm(e,t){if(e instanceof sl)e=new gm(e);for(let n of e.state.facet(fm)){let i=n(e,t);if(null!=i)return i}let i=tm(e.state);return i?wm(e,i,t):null}class gm{constructor(e,t={}){this.state=e;this.options=t;this.unit=dm(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e);let{simulateBreak:n,simulateDoubleBreak:s}=this.options;if(null!=n&&n>=i.from&&n<=i.to)if(s&&n==e)return{text:"",from:e};else if(t<0?n<e:n<=e)return{text:i.text.slice(n-i.from),from:n};else return{text:i.text.slice(0,n-i.from),from:i.from};return i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(e,t);return i.slice(e-n,Math.min(i.length,e+100-n))}column(e,t=1){let{text:i,from:n}=this.lineAt(e,t);let s=this.countColumn(i,e-n);let r=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;if(r>-1)s+=r-this.countColumn(i,i.search(/\S|$/));return s}countColumn(e,t=e.length){return Sl(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:n}=this.lineAt(e,t);let s=this.options.overrideIndentation;if(s){let e=s(n);if(e>-1)return e}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const vm=new Xd;function wm(e,t,i){return xm(t.resolveInner(i).enterUnfinishedNodesBefore(i),i,e)}function ym(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}function bm(e){let t=e.type.prop(vm);if(t)return t;let i=e.firstChild,n;if(i&&(n=i.type.prop(Xd.closedBy))){let t=e.lastChild,i=t&&n.indexOf(t.name)>-1;return e=>Mm(e,true,1,void 0,i&&!ym(e)?t.from:void 0)}return null==e.parent?km:null}function xm(e,t,i){for(;e;e=e.parent){let n=bm(e);if(n)return n(Sm.create(i,t,e))}return null}function km(){return 0}class Sm extends gm{constructor(e,t,i){super(e.state,e.options);this.base=e;this.pos=t;this.node=i}static create(e,t,i){return new Sm(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);while(t.parent&&t.parent.from==t.from)t=t.parent;if(Cm(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?xm(e,this.pos,this.base):0}}function Cm(e,t){for(let i=t;i;i=i.parent)if(e==i)return true;return false}function Am(e){let t=e.node;let i=t.childAfter(t.from),n=t.lastChild;if(!i)return null;let s=e.options.simulateBreak;let r=e.state.doc.lineAt(i.from);let o=null==s||s<=r.from?r.to:Math.min(r.to,s);for(let l=i.to;;){let e=t.childAfter(l);if(!e||e==n)return null;if(!e.type.isSkipped)return e.from<o?i:null;l=e.to}}function Mm(e,t,i,n,s){let r=e.textAfter,o=r.match(/^\s*/)[0].length;let l=n&&r.slice(o,o+n.length)==n||s==e.pos+o;let a=t?Am(e):null;if(a)return l?e.column(a.from):e.column(a.to);return e.baseIndent+(l?0:e.unit*i)}const Om=200;function Dm(){return sl.transactionFilter.of((e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let i=e.newDoc,{head:n}=e.newSelection.main,s=i.lineAt(n);if(n>s.from+Om)return e;let r=i.sliceString(s.from,n);if(!t.some((e=>e.test(r))))return e;let{state:o}=e,l=-1,a=[];for(let{head:h}of o.selection.ranges){let e=o.doc.lineAt(h);if(e.from==l)continue;l=e.from;let t=mm(o,e.from);if(null==t)continue;let i=/^\s*/.exec(e.text)[0];let n=pm(o,t);if(i!=n)a.push({from:e.from,to:e.from+i.length,insert:n})}return a.length?[e,{changes:a,sequential:true}]:e}))}const Tm=mo.define();const Em=new Xd;function Rm(e,t,i){let n=tm(e);if(n.length<i)return null;let s=n.resolveInner(i);let r=null;for(let o=s;o;o=o.parent){if(o.to<=i||o.from>i)continue;if(r&&o.from<t)break;let s=o.type.prop(Em);if(s&&(o.to<n.length-50||n.length==e.doc.length||!_m(o))){let n=s(o,e);if(n&&n.from<=i&&n.from>=t&&n.to>i)r=n}}return r}function _m(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}function Bm(e,t,i){for(let n of e.facet(Tm)){let s=n(e,t,i);if(s)return s}return Rm(e,t,i)}function Lm(e,t){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);return i>=n?void 0:{from:i,to:n}}const Pm=qo.define({map:Lm});const Nm=qo.define({map:Lm});function Im(e){let t=[];for(let{head:i}of e.state.selection.ranges){if(t.some((e=>e.from<=i&&e.to>=i)))continue;t.push(e.lineBlockAt(i))}return t}const Vm=ko.define({create(){return Ua.none},update(e,t){e=e.map(t.changes);for(let i of t.effects)if(i.is(Pm)&&!Hm(e,i.value.from,i.value.to))e=e.update({add:[Ym.range(i.value.from,i.value.to)]});else if(i.is(Nm))e=e.update({filter:(e,t)=>i.value.from!=e||i.value.to!=t,filterFrom:i.value.from,filterTo:i.value.to});if(t.selection){let i=false,{head:n}=t.selection.main;e.between(n,n,((e,t)=>{if(e<n&&t>n)i=true}));if(i)e=e.update({filterFrom:n,filterTo:n,filter:(e,t)=>t<=n||e>=n})}return e},provide:e=>Kf.decorations.from(e),toJSON(e,t){let i=[];e.between(0,t.doc.length,((e,t)=>{i.push(e,t)}));return i},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let i=0;i<e.length;){let n=e[i++],s=e[i++];if("number"!=typeof n||"number"!=typeof s)throw new RangeError("Invalid JSON for fold state");t.push(Ym.range(n,s))}return Ua.set(t,true)}});function Fm(e,t,i){var n;let s=null;null===(n=e.field(Vm,false))||void 0===n?void 0:n.between(t,i,((e,t)=>{if(!s||s.from>e)s={from:e,to:t}}));return s}function Hm(e,t,i){let n=false;e.between(t,t,((e,s)=>{if(e==t&&s==i)n=true}));return n}function Wm(e,t){return e.field(Vm,false)?t:t.concat(qo.appendConfig.of(Xm()))}const zm=e=>{for(let t of Im(e)){let i=Bm(e.state,t.from,t.to);if(i){e.dispatch({effects:Wm(e.state,[Pm.of(i),jm(e,i)])});return true}}return false};const qm=e=>{if(!e.state.field(Vm,false))return false;let t=[];for(let i of Im(e)){let n=Fm(e.state,i.from,i.to);if(n)t.push(Nm.of(n),jm(e,n,false))}if(t.length)e.dispatch({effects:t});return t.length>0};function jm(e,t,i=true){let n=e.state.doc.lineAt(t.from).number,s=e.state.doc.lineAt(t.to).number;return Kf.announce.of(`${e.state.phrase(i?"Folded lines":"Unfolded lines")} ${n} ${e.state.phrase("to")} ${s}.`)}const $m=e=>{let{state:t}=e,i=[];for(let n=0;n<t.doc.length;){let s=e.lineBlockAt(n),r=Bm(t,s.from,s.to);if(r)i.push(Pm.of(r));n=(r?e.lineBlockAt(r.to):s).to+1}if(i.length)e.dispatch({effects:Wm(e.state,i)});return!!i.length};const Um=e=>{let t=e.state.field(Vm,false);if(!t||!t.size)return false;let i=[];t.between(0,e.state.doc.length,((e,t)=>{i.push(Nm.of({from:e,to:t}))}));e.dispatch({effects:i});return true};const Km=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:zm},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:qm},{key:"Ctrl-Alt-[",run:$m},{key:"Ctrl-Alt-]",run:Um}];const Gm={placeholderDOM:null,placeholderText:"…"};const Jm=mo.define({combine(e){return rl(e,Gm)}});function Xm(e){let t=[Vm,tg];if(e)t.push(Jm.of(e));return t}const Ym=Ua.replace({widget:new class extends ja{toDOM(e){let{state:t}=e,i=t.facet(Jm);let n=t=>{let i=e.lineBlockAt(e.posAtDOM(t.target));let n=Fm(e.state,i.from,i.to);if(n)e.dispatch({effects:Nm.of(n)});t.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(e,n);let s=document.createElement("span");s.textContent=i.placeholderText;s.setAttribute("aria-label",t.phrase("folded code"));s.title=t.phrase("unfold");s.className="cm-foldPlaceholder";s.onclick=n;return s}}});const Qm={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>false};class Zm extends Sd{constructor(e,t){super();this.config=e;this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");t.textContent=this.open?this.config.openText:this.config.closedText;t.title=e.state.phrase(this.open?"Fold line":"Unfold line");return t}}function eg(e={}){let t=Object.assign(Object.assign({},Qm),e);let i=new Zm(t,true),n=new Zm(t,false);let s=vh.fromClass(class{constructor(e){this.from=e.viewport.from;this.markers=this.buildMarkers(e)}update(e){if(e.docChanged||e.viewportChanged||e.startState.facet(cm)!=e.state.facet(cm)||e.startState.field(Vm,false)!=e.state.field(Vm,false)||tm(e.startState)!=tm(e.state)||t.foldingChanged(e))this.markers=this.buildMarkers(e.view)}buildMarkers(e){let t=new ul;for(let s of e.viewportLineBlocks){let r=Fm(e.state,s.from,s.to)?n:Bm(e.state,s.from,s.to)?i:null;if(r)t.add(s.from,s.from,r)}return t.finish()}});let{domEventHandlers:r}=t;return[s,Od({class:"cm-foldGutter",markers(e){var t;return(null===(t=e.plugin(s))||void 0===t?void 0:t.markers)||cl.empty},initialSpacer(){return new Zm(t,false)},domEventHandlers:Object.assign(Object.assign({},r),{click:(e,t,i)=>{if(r.click&&r.click(e,t,i))return true;let n=Fm(e.state,t.from,t.to);if(n){e.dispatch({effects:Nm.of(n)});return true}let s=Bm(e.state,t.from,t.to);if(s){e.dispatch({effects:Pm.of(s)});return true}return false}})}),Xm()]}const tg=Kf.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ig{constructor(e,t){let i;function n(e){let t=Tl.newName();(i||(i=Object.create(null)))["."+t]=e;return t}const s="string"==typeof t.all?t.all:t.all?n(t.all):void 0;const r=t.scope;this.scope=r instanceof Zp?e=>e.prop(Qp)==r.data:r?e=>e==r:void 0;this.style=Rp(e.map((e=>({tag:e.tag,class:e.class||n(Object.assign({},e,{tag:null}))}))),{all:s}).style;this.module=i?new Tl(i):null;this.themeType=t.themeType}static define(e,t){return new ig(e,t||{})}}const ng=mo.define();const sg=mo.define({combine(e){return e.length?[e[0]]:null}});function rg(e){let t=e.facet(ng);return t.length?t:e.facet(sg)}function og(e,t){let i=[ag],n;if(e instanceof ig){if(e.module)i.push(Kf.styleModule.of(e.module));n=e.themeType}if(null===t||void 0===t?void 0:t.fallback)i.push(sg.of(e));else if(n)i.push(ng.computeN([Kf.darkTheme],(t=>t.facet(Kf.darkTheme)==("dark"==n)?[e]:[])));else i.push(ng.of(e));return i}class lg{constructor(e){this.markCache=Object.create(null);this.tree=tm(e.state);this.decorations=this.buildDeco(e,rg(e.state))}update(e){let t=tm(e.state),i=rg(e.state);let n=i!=rg(e.startState);if(t.length<e.view.viewport.to&&!n&&t.type==this.tree.type)this.decorations=this.decorations.map(e.changes);else if(t!=this.tree||e.viewportChanged||n){this.tree=t;this.decorations=this.buildDeco(e.view,i)}}buildDeco(e,t){if(!t||!this.tree.length)return Ua.none;let i=new ul;for(let{from:n,to:s}of e.visibleRanges)Bp(this.tree,t,((e,t,n)=>{i.add(e,t,this.markCache[n]||(this.markCache[n]=Ua.mark({class:n})))}),n,s);return i.finish()}}const ag=Ao.high(vh.fromClass(lg,{decorations:e=>e.decorations}));const hg=ig.define([{tag:Xp.meta,color:"#7a757a"},{tag:Xp.link,textDecoration:"underline"},{tag:Xp.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Xp.emphasis,fontStyle:"italic"},{tag:Xp.strong,fontWeight:"bold"},{tag:Xp.strikethrough,textDecoration:"line-through"},{tag:Xp.keyword,color:"#708"},{tag:[Xp.atom,Xp.bool,Xp.url,Xp.contentSeparator,Xp.labelName],color:"#219"},{tag:[Xp.literal,Xp.inserted],color:"#164"},{tag:[Xp.string,Xp.deleted],color:"#a11"},{tag:[Xp.regexp,Xp.escape,Xp.special(Xp.string)],color:"#e40"},{tag:Xp.definition(Xp.variableName),color:"#00f"},{tag:Xp.local(Xp.variableName),color:"#30a"},{tag:[Xp.typeName,Xp.namespace],color:"#085"},{tag:Xp.className,color:"#167"},{tag:[Xp.special(Xp.variableName),Xp.macroName],color:"#256"},{tag:Xp.definition(Xp.propertyName),color:"#00c"},{tag:Xp.comment,color:"#940"},{tag:Xp.invalid,color:"#f00"}]);const cg=Kf.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}});const fg=1e4,ug="()[]{}";const dg=mo.define({combine(e){return rl(e,{afterCursor:true,brackets:ug,maxScanDistance:fg,renderMatch:gg})}});const pg=Ua.mark({class:"cm-matchingBracket"}),mg=Ua.mark({class:"cm-nonmatchingBracket"});function gg(e){let t=[];let i=e.matched?pg:mg;t.push(i.range(e.start.from,e.start.to));if(e.end)t.push(i.range(e.end.from,e.end.to));return t}const vg=ko.define({create(){return Ua.none},update(e,t){if(!t.docChanged&&!t.selection)return e;let i=[];let n=t.state.facet(dg);for(let s of t.state.selection.ranges){if(!s.empty)continue;let e=xg(t.state,s.head,-1,n)||s.head>0&&xg(t.state,s.head-1,1,n)||n.afterCursor&&(xg(t.state,s.head,1,n)||s.head<t.state.doc.length&&xg(t.state,s.head+1,-1,n));if(e)i=i.concat(n.renderMatch(e,t.state))}return Ua.set(i,true)},provide:e=>Kf.decorations.from(e)});const wg=[vg,cg];function yg(e={}){return[dg.of(e),wg]}function bg(e,t,i){let n=e.prop(t<0?Xd.openedBy:Xd.closedBy);if(n)return n;if(1==e.name.length){let n=i.indexOf(e.name);if(n>-1&&n%2==(t<0?1:0))return[i[n+t]]}return null}function xg(e,t,i,n={}){let s=n.maxScanDistance||fg,r=n.brackets||ug;let o=tm(e),l=o.resolveInner(t,i);for(let a=l;a;a=a.parent){let n=bg(a.type,i,r);if(n&&a.from<a.to)return kg(e,t,i,a,n,r)}return Sg(e,t,i,o,l.type,s,r)}function kg(e,t,i,n,s,r){let o=n.parent,l={from:n.from,to:n.to};let a=0,h=null===o||void 0===o?void 0:o.cursor();if(h&&(i<0?h.childBefore(n.from):h.childAfter(n.to)))do{if(i<0?h.to<=n.from:h.from>=n.to)if(0==a&&s.indexOf(h.type.name)>-1&&h.from<h.to)return{start:l,end:{from:h.from,to:h.to},matched:true};else if(bg(h.type,i,r))a++;else if(bg(h.type,-i,r)){if(0==a)return{start:l,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:false};a--}}while(i<0?h.prevSibling():h.nextSibling());return{start:l,matched:false}}function Sg(e,t,i,n,s,r,o){let l=i<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1);let a=o.indexOf(l);if(a<0||a%2==0!=i>0)return null;let h={from:i<0?t-1:t,to:i>0?t+1:t};let c=e.doc.iterRange(t,i>0?e.doc.length:0),f=0;for(let u=0;!c.next().done&&u<=r;){let e=c.value;if(i<0)u+=e.length;let r=t+u*i;for(let t=i>0?0:e.length-1,l=i>0?e.length:-1;t!=l;t+=i){let l=o.indexOf(e[t]);if(l<0||n.resolveInner(r+t,1).type!=s)continue;if(l%2==0==i>0)f++;else if(1==f)return{start:h,end:{from:r+t,to:r+t+1},matched:l>>1==a>>1};else f--}if(i>0)u+=e.length}return c.done?{start:h,matched:false}:null}const Cg=Object.create(null);const Ag=[Qd.none];const Mg=[];const Og=Object.create(null);for(let[tk,ik]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Og[tk]=Tg(Cg,ik);function Dg(e,t){if(Mg.indexOf(e)>-1)return;Mg.push(e);void 0}function Tg(e,t){let i=null;for(let r of t.split(".")){let t=e[r]||Xp[r];if(!t)Dg(r,`Unknown highlighting tag ${r}`);else if("function"==typeof t)if(!i)Dg(r,`Modifier ${r} used at start of tag`);else i=t(i);else if(i)Dg(r,`Tag ${r} used as modifier`);else i=t}if(!i)return 0;let n=t.replace(/ /g,"_"),s=Qd.define({id:Ag.length,name:n,props:[Dp({[n]:i})]});Ag.push(s);return s.id}const Eg=e=>{let t=Pg(e.state);return t.line?_g(e):t.block?Lg(e):false};function Rg(e,t){return({state:i,dispatch:n})=>{if(i.readOnly)return false;let s=e(t,i);if(!s)return false;n(i.update(s));return true}}const _g=Rg(Hg,0);const Bg=Rg(Fg,0);const Lg=Rg(((e,t)=>Fg(e,t,Vg(t))),0);function Pg(e,t=e.selection.main.head){let i=e.languageDataAt("commentTokens",t);return i.length?i[0]:{}}const Ng=50;function Ig(e,{open:t,close:i},n,s){let r=e.sliceDoc(n-Ng,n);let o=e.sliceDoc(s,s+Ng);let l=/\s*$/.exec(r)[0].length,a=/^\s*/.exec(o)[0].length;let h=r.length-l;if(r.slice(h-t.length,h)==t&&o.slice(a,a+i.length)==i)return{open:{pos:n-l,margin:l&&1},close:{pos:s+a,margin:a&&1}};let c,f;if(s-n<=2*Ng)c=f=e.sliceDoc(n,s);else{c=e.sliceDoc(n,n+Ng);f=e.sliceDoc(s-Ng,s)}let u=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(f)[0].length;let p=f.length-d-i.length;if(c.slice(u,u+t.length)==t&&f.slice(p,p+i.length)==i)return{open:{pos:n+u+t.length,margin:/\s/.test(c.charAt(u+t.length))?1:0},close:{pos:s-d-i.length,margin:/\s/.test(f.charAt(p-1))?1:0}};return null}function Vg(e){let t=[];for(let i of e.selection.ranges){let n=e.doc.lineAt(i.from);let s=i.to<=n.to?n:e.doc.lineAt(i.to);let r=t.length-1;if(r>=0&&t[r].to>n.from)t[r].to=s.to;else t.push({from:n.from,to:s.to})}return t}function Fg(e,t,i=t.selection.ranges){let n=i.map((e=>Pg(t,e.from).block));if(!n.every((e=>e)))return null;let s=i.map(((e,i)=>Ig(t,n[i],e.from,e.to)));if(2!=e&&!s.every((e=>e)))return{changes:t.changes(i.map(((e,t)=>{if(s[t])return[];return[{from:e.from,insert:n[t].open+" "},{from:e.to,insert:" "+n[t].close}]})))};else if(1!=e&&s.some((e=>e))){let e=[];for(let t=0,i;t<s.length;t++)if(i=s[t]){let s=n[t],{open:r,close:o}=i;e.push({from:r.pos-s.open.length,to:r.pos+r.margin},{from:o.pos-o.margin,to:o.pos+s.close.length})}return{changes:e}}return null}function Hg(e,t,i=t.selection.ranges){let n=[];let s=-1;for(let{from:r,to:o}of i){let e=n.length,i=1e9;for(let l=r;l<=o;){let e=t.doc.lineAt(l);if(e.from>s&&(r==o||o>e.from)){s=e.from;let r=Pg(t,l).line;if(!r)continue;let o=/^\s*/.exec(e.text)[0].length;let a=o==e.length;let h=e.text.slice(o,o+r.length)==r?o:-1;if(o<e.text.length&&o<i)i=o;n.push({line:e,comment:h,token:r,indent:o,empty:a,single:false})}l=e.to+1}if(i<1e9)for(let t=e;t<n.length;t++)if(n[t].indent<n[t].line.text.length)n[t].indent=i;if(n.length==e+1)n[e].single=true}if(2!=e&&n.some((e=>e.comment<0&&(!e.empty||e.single)))){let e=[];for(let{line:t,token:s,indent:r,empty:o,single:l}of n)if(l||!o)e.push({from:t.from+r,insert:s+" "});let i=t.changes(e);return{changes:i,selection:t.selection.map(i,1)}}else if(1!=e&&n.some((e=>e.comment>=0))){let e=[];for(let{line:t,comment:i,token:s}of n)if(i>=0){let n=t.from+i,r=n+s.length;if(" "==t.text[r-t.from])r++;e.push({from:n,to:r})}return{changes:e}}return null}const Wg=Ho.define();const zg=Ho.define();const qg=mo.define();const jg=mo.define({combine(e){return rl(e,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function $g(e){let t=0;e.iterChangedRanges(((e,i)=>t=i));return t}const Ug=ko.define({create(){return fv.empty},update(e,t){let i=t.state.facet(jg);let n=t.annotation(Wg);if(n){let s=t.docChanged?fo.single($g(t.changes)):void 0;let r=Zg.fromTransaction(t,s),o=n.side;let l=0==o?e.undone:e.done;if(r)l=ev(l,l.length,i.minDepth,r);else l=ov(l,t.startState.selection);return new fv(0==o?n.rest:l,0==o?l:n.rest)}let s=t.annotation(zg);if("full"==s||"before"==s)e=e.isolate();if(false===t.annotation(jo.addToHistory))return!t.changes.empty?e.addMapping(t.changes.desc):e;let r=Zg.fromTransaction(t);let o=t.annotation(jo.time),l=t.annotation(jo.userEvent);if(r)e=e.addChanges(r,o,l,i.newGroupDelay,i.minDepth);else if(t.selection)e=e.addSelection(t.startState.selection,o,l,i.newGroupDelay);if("full"==s||"after"==s)e=e.isolate();return e},toJSON(e){return{done:e.done.map((e=>e.toJSON())),undone:e.undone.map((e=>e.toJSON()))}},fromJSON(e){return new fv(e.done.map(Zg.fromJSON),e.undone.map(Zg.fromJSON))}});function Kg(e={}){return[Ug,jg.of(e),Kf.domEventHandlers({beforeinput(e,t){let i="historyUndo"==e.inputType?Jg:"historyRedo"==e.inputType?Xg:null;if(!i)return false;e.preventDefault();return i(t)}})]}function Gg(e,t){return function({state:i,dispatch:n}){if(!t&&i.readOnly)return false;let s=i.field(Ug,false);if(!s)return false;let r=s.pop(e,i,t);if(!r)return false;n(r);return true}}const Jg=Gg(0,false);const Xg=Gg(1,false);const Yg=Gg(0,true);const Qg=Gg(1,true);class Zg{constructor(e,t,i,n,s){this.changes=e;this.effects=t;this.mapped=i;this.startSelection=n;this.selectionsAfter=s}setSelAfter(e){return new Zg(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(i=this.startSelection)||void 0===i?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map((e=>e.toJSON()))}}static fromJSON(e){return new Zg(e.changes&&no.fromJSON(e.changes),[],e.mapped&&io.fromJSON(e.mapped),e.startSelection&&fo.fromJSON(e.startSelection),e.selectionsAfter.map(fo.fromJSON))}static fromTransaction(e,t){let i=sv;for(let n of e.startState.facet(qg)){let t=n(e);if(t.length)i=i.concat(t)}if(!i.length&&e.changes.empty)return null;return new Zg(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,sv)}static selection(e){return new Zg(void 0,sv,void 0,void 0,e)}}function ev(e,t,i,n){let s=t+1>i+20?t-i-1:0;let r=e.slice(s,t);r.push(n);return r}function tv(e,t){let i=[],n=false;e.iterChangedRanges(((e,t)=>i.push(e,t)));t.iterChangedRanges(((e,t,s,r)=>{for(let o=0;o<i.length;){let e=i[o++],t=i[o++];if(r>=e&&s<=t)n=true}}));return n}function iv(e,t){return e.ranges.length==t.ranges.length&&0===e.ranges.filter(((e,i)=>e.empty!=t.ranges[i].empty)).length}function nv(e,t){return!e.length?t:!t.length?e:e.concat(t)}const sv=[];const rv=200;function ov(e,t){if(!e.length)return[Zg.selection([t])];else{let i=e[e.length-1];let n=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-rv));if(n.length&&n[n.length-1].eq(t))return e;n.push(t);return ev(e,e.length-1,1e9,i.setSelAfter(n))}}function lv(e){let t=e[e.length-1];let i=e.slice();i[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1));return i}function av(e,t){if(!e.length)return e;let i=e.length,n=sv;while(i){let s=hv(e[i-1],t,n);if(s.changes&&!s.changes.empty||s.effects.length){let t=e.slice(0,i);t[i-1]=s;return t}else{t=s.mapped;i--;n=s.selectionsAfter}}return n.length?[Zg.selection(n)]:sv}function hv(e,t,i){let n=nv(e.selectionsAfter.length?e.selectionsAfter.map((e=>e.map(t))):sv,i);if(!e.changes)return Zg.selection(n);let s=e.changes.map(t),r=t.mapDesc(e.changes,true);let o=e.mapped?e.mapped.composeDesc(r):r;return new Zg(s,qo.mapEffects(e.effects,t),o,e.startSelection.map(r),n)}const cv=/^(input\.type|delete)($|\.)/;class fv{constructor(e,t,i=0,n=void 0){this.done=e;this.undone=t;this.prevTime=i;this.prevUserEvent=n}isolate(){return this.prevTime?new fv(this.done,this.undone):this}addChanges(e,t,i,n,s){let r=this.done,o=r[r.length-1];if(o&&o.changes&&!o.changes.empty&&e.changes&&(!i||cv.test(i))&&(!o.selectionsAfter.length&&t-this.prevTime<n&&tv(o.changes,e.changes)||"input.type.compose"==i))r=ev(r,r.length-1,s,new Zg(e.changes.compose(o.changes),nv(e.effects,o.effects),o.mapped,o.startSelection,sv));else r=ev(r,r.length,s,e);return new fv(r,sv,t,i)}addSelection(e,t,i,n){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:sv;if(s.length>0&&t-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&iv(s[s.length-1],e))return this;return new fv(ov(this.done,e),this.undone,t,i)}addMapping(e){return new fv(av(this.done,e),av(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let n=0==e?this.done:this.undone;if(0==n.length)return null;let s=n[n.length-1];if(i&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Wg.of({side:e,rest:lv(n)}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:true});else if(!s.changes)return null;else{let i=1==n.length?sv:n.slice(0,n.length-1);if(s.mapped)i=av(i,s.mapped);return t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Wg.of({side:e,rest:i}),filter:false,userEvent:0==e?"undo":"redo",scrollIntoView:true})}}}fv.empty=new fv(sv,sv);const uv=[{key:"Mod-z",run:Jg,preventDefault:true},{key:"Mod-y",mac:"Mod-Shift-z",run:Xg,preventDefault:true},{linux:"Ctrl-Shift-z",run:Xg,preventDefault:true},{key:"Mod-u",run:Yg,preventDefault:true},{key:"Alt-u",mac:"Mod-Shift-u",run:Qg,preventDefault:true}];function dv(e,t){return fo.create(e.ranges.map(t),e.mainIndex)}function pv(e,t){return e.update({selection:t,scrollIntoView:true,userEvent:"select"})}function mv({state:e,dispatch:t},i){let n=dv(e.selection,i);if(n.eq(e.selection))return false;t(pv(e,n));return true}function gv(e,t){return fo.cursor(t?e.to:e.from)}function vv(e,t){return mv(e,(i=>i.empty?e.moveByChar(i,t):gv(i,t)))}function wv(e){return e.textDirectionAt(e.state.selection.main.head)==Oh.LTR}const yv=e=>vv(e,!wv(e));const bv=e=>vv(e,wv(e));function xv(e,t){return mv(e,(i=>i.empty?e.moveByGroup(i,t):gv(i,t)))}const kv=e=>xv(e,!wv(e));const Sv=e=>xv(e,wv(e));function Cv(e,t,i){if(t.type.prop(i))return true;let n=t.to-t.from;return n&&(n>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function Av(e,t,i){let n=tm(e).resolveInner(t.head);let s=i?Xd.closedBy:Xd.openedBy;for(let a=t.head;;){let t=i?n.childAfter(a):n.childBefore(a);if(!t)break;if(Cv(e,t,s))n=t;else a=i?t.to:t.from}let r=n.type.prop(s),o,l;if(r&&(o=i?xg(e,n.from,1):xg(e,n.to,-1))&&o.matched)l=i?o.end.to:o.end.from;else l=i?n.to:n.from;return fo.cursor(l,i?-1:1)}const Mv=e=>mv(e,(t=>Av(e.state,t,!wv(e))));const Ov=e=>mv(e,(t=>Av(e.state,t,wv(e))));function Dv(e,t){return mv(e,(i=>{if(!i.empty)return gv(i,t);let n=e.moveVertically(i,t);return n.head!=i.head?n:e.moveToLineBoundary(i,t)}))}const Tv=e=>Dv(e,false);const Ev=e=>Dv(e,true);function Rv(e){return Math.max(e.defaultLineHeight,Math.min(e.dom.clientHeight,innerHeight)-5)}function _v(e,t){let{state:i}=e,n=dv(i.selection,(i=>i.empty?e.moveVertically(i,t,Rv(e)):gv(i,t)));if(n.eq(i.selection))return false;let s=e.coordsAtPos(i.selection.main.head);let r=e.scrollDOM.getBoundingClientRect();let o;if(s&&s.top>r.top&&s.bottom<r.bottom&&s.top-r.top<=e.scrollDOM.scrollHeight-e.scrollDOM.scrollTop-e.scrollDOM.clientHeight)o=Kf.scrollIntoView(n.main.head,{y:"start",yMargin:s.top-r.top});e.dispatch(pv(i,n),{effects:o});return true}const Bv=e=>_v(e,false);const Lv=e=>_v(e,true);function Pv(e,t,i){let n=e.lineBlockAt(t.head),s=e.moveToLineBoundary(t,i);if(s.head==t.head&&s.head!=(i?n.to:n.from))s=e.moveToLineBoundary(t,i,false);if(!i&&s.head==n.from&&n.length){let i=/^\s*/.exec(e.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;if(i&&t.head!=n.from+i)s=fo.cursor(n.from+i)}return s}const Nv=e=>mv(e,(t=>Pv(e,t,true)));const Iv=e=>mv(e,(t=>Pv(e,t,false)));const Vv=e=>mv(e,(t=>Pv(e,t,!wv(e))));const Fv=e=>mv(e,(t=>Pv(e,t,wv(e))));const Hv=e=>mv(e,(t=>fo.cursor(e.lineBlockAt(t.head).from,1)));const Wv=e=>mv(e,(t=>fo.cursor(e.lineBlockAt(t.head).to,-1)));function zv(e,t,i){let n=false,s=dv(e.selection,(t=>{let s=xg(e,t.head,-1)||xg(e,t.head,1)||t.head>0&&xg(e,t.head-1,1)||t.head<e.doc.length&&xg(e,t.head+1,-1);if(!s||!s.end)return t;n=true;let r=s.start.from==t.head?s.end.to:s.end.from;return i?fo.range(t.anchor,r):fo.cursor(r)}));if(!n)return false;t(pv(e,s));return true}const qv=({state:e,dispatch:t})=>zv(e,t,false);function jv(e,t){let i=dv(e.state.selection,(e=>{let i=t(e);return fo.range(e.anchor,i.head,i.goalColumn)}));if(i.eq(e.state.selection))return false;e.dispatch(pv(e.state,i));return true}function $v(e,t){return jv(e,(i=>e.moveByChar(i,t)))}const Uv=e=>$v(e,!wv(e));const Kv=e=>$v(e,wv(e));function Gv(e,t){return jv(e,(i=>e.moveByGroup(i,t)))}const Jv=e=>Gv(e,!wv(e));const Xv=e=>Gv(e,wv(e));const Yv=e=>jv(e,(t=>Av(e.state,t,!wv(e))));const Qv=e=>jv(e,(t=>Av(e.state,t,wv(e))));function Zv(e,t){return jv(e,(i=>e.moveVertically(i,t)))}const ew=e=>Zv(e,false);const tw=e=>Zv(e,true);function iw(e,t){return jv(e,(i=>e.moveVertically(i,t,Rv(e))))}const nw=e=>iw(e,false);const sw=e=>iw(e,true);const rw=e=>jv(e,(t=>Pv(e,t,true)));const ow=e=>jv(e,(t=>Pv(e,t,false)));const lw=e=>jv(e,(t=>Pv(e,t,!wv(e))));const aw=e=>jv(e,(t=>Pv(e,t,wv(e))));const hw=e=>jv(e,(t=>fo.cursor(e.lineBlockAt(t.head).from)));const cw=e=>jv(e,(t=>fo.cursor(e.lineBlockAt(t.head).to)));const fw=({state:e,dispatch:t})=>{t(pv(e,{anchor:0}));return true};const uw=({state:e,dispatch:t})=>{t(pv(e,{anchor:e.doc.length}));return true};const dw=({state:e,dispatch:t})=>{t(pv(e,{anchor:e.selection.main.anchor,head:0}));return true};const pw=({state:e,dispatch:t})=>{t(pv(e,{anchor:e.selection.main.anchor,head:e.doc.length}));return true};const mw=({state:e,dispatch:t})=>{t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"}));return true};const gw=({state:e,dispatch:t})=>{let i=Rw(e).map((({from:t,to:i})=>fo.range(t,Math.min(i+1,e.doc.length))));t(e.update({selection:fo.create(i),userEvent:"select"}));return true};const vw=({state:e,dispatch:t})=>{let i=dv(e.selection,(t=>{var i;let n=tm(e).resolveInner(t.head,1);while(!(n.from<t.from&&n.to>=t.to||n.to>t.to&&n.from<=t.from||!(null===(i=n.parent)||void 0===i?void 0:i.parent)))n=n.parent;return fo.range(n.to,n.from)}));t(pv(e,i));return true};const ww=({state:e,dispatch:t})=>{let i=e.selection,n=null;if(i.ranges.length>1)n=fo.create([i.main]);else if(!i.main.empty)n=fo.create([fo.cursor(i.main.head)]);if(!n)return false;t(pv(e,n));return true};function yw({state:e,dispatch:t},i){if(e.readOnly)return false;let n="delete.selection";let s=e.changeByRange((e=>{let{from:t,to:s}=e;if(t==s){let e=i(t);if(e<t)n="delete.backward";else if(e>t)n="delete.forward";t=Math.min(t,e);s=Math.max(s,e)}return t==s?{range:e}:{changes:{from:t,to:s},range:fo.cursor(t)}}));if(s.changes.empty)return false;t(e.update(s,{scrollIntoView:true,userEvent:n,effects:"delete.selection"==n?Kf.announce.of(e.phrase("Selection deleted")):void 0}));return true}function bw(e,t,i){if(e instanceof Kf)for(let n of e.state.facet(Kf.atomicRanges).map((t=>t(e))))n.between(t,t,((e,n)=>{if(e<t&&n>t)t=i?n:e}));return t}const xw=(e,t)=>yw(e,(i=>{let{state:n}=e,s=n.doc.lineAt(i),r,o;if(!t&&i>s.from&&i<s.from+200&&!/[^ \t]/.test(r=s.text.slice(0,i-s.from))){if("\t"==r[r.length-1])return i-1;let e=Sl(r,n.tabSize),t=e%dm(n)||dm(n);for(let n=0;n<t&&" "==r[r.length-1-n];n++)i--;o=i}else{o=Ur(s.text,i-s.from,t,t)+s.from;if(o==i&&s.number!=(t?n.doc.lines:1))o+=t?1:-1}return bw(e,o,t)}));const kw=e=>xw(e,false);const Sw=e=>xw(e,true);const Cw=(e,t)=>yw(e,(i=>{let n=i,{state:s}=e,r=s.doc.lineAt(n);let o=s.charCategorizer(n);for(let e=null;;){if(n==(t?r.to:r.from)){if(n==i&&r.number!=(t?s.doc.lines:1))n+=t?1:-1;break}let l=Ur(r.text,n-r.from,t)+r.from;let a=r.text.slice(Math.min(n,l)-r.from,Math.max(n,l)-r.from);let h=o(a);if(null!=e&&h!=e)break;if(" "!=a||n!=i)e=h;n=l}return bw(e,n,t)}));const Aw=e=>Cw(e,false);const Mw=e=>Cw(e,true);const Ow=e=>yw(e,(t=>{let i=e.lineBlockAt(t).to;return bw(e,t<i?i:Math.min(e.state.doc.length,t+1),true)}));const Dw=e=>yw(e,(t=>{let i=e.lineBlockAt(t).from;return bw(e,t>i?i:Math.max(0,t-1),false)}));const Tw=({state:e,dispatch:t})=>{if(e.readOnly)return false;let i=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:_r.of(["",""])},range:fo.cursor(e.from)})));t(e.update(i,{scrollIntoView:true,userEvent:"input"}));return true};const Ew=({state:e,dispatch:t})=>{if(e.readOnly)return false;let i=e.changeByRange((t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let i=t.from,n=e.doc.lineAt(i);let s=i==n.from?i-1:Ur(n.text,i-n.from,false)+n.from;let r=i==n.to?i+1:Ur(n.text,i-n.from,true)+n.from;return{changes:{from:s,to:r,insert:e.doc.slice(i,r).append(e.doc.slice(s,i))},range:fo.cursor(r)}}));if(i.changes.empty)return false;t(e.update(i,{scrollIntoView:true,userEvent:"move.character"}));return true};function Rw(e){let t=[],i=-1;for(let n of e.selection.ranges){let s=e.doc.lineAt(n.from),r=e.doc.lineAt(n.to);if(!n.empty&&n.to==r.from)r=e.doc.lineAt(n.to-1);if(i>=s.number){let e=t[t.length-1];e.to=r.to;e.ranges.push(n)}else t.push({from:s.from,to:r.to,ranges:[n]});i=r.number+1}return t}function _w(e,t,i){if(e.readOnly)return false;let n=[],s=[];for(let r of Rw(e)){if(i?r.to==e.doc.length:0==r.from)continue;let t=e.doc.lineAt(i?r.to+1:r.from-1);let o=t.length+1;if(i){n.push({from:r.to,to:t.to},{from:r.from,insert:t.text+e.lineBreak});for(let t of r.ranges)s.push(fo.range(Math.min(e.doc.length,t.anchor+o),Math.min(e.doc.length,t.head+o)))}else{n.push({from:t.from,to:r.from},{from:r.to,insert:e.lineBreak+t.text});for(let e of r.ranges)s.push(fo.range(e.anchor-o,e.head-o))}}if(!n.length)return false;t(e.update({changes:n,scrollIntoView:true,selection:fo.create(s,e.selection.mainIndex),userEvent:"move.line"}));return true}const Bw=({state:e,dispatch:t})=>_w(e,t,false);const Lw=({state:e,dispatch:t})=>_w(e,t,true);function Pw(e,t,i){if(e.readOnly)return false;let n=[];for(let s of Rw(e))if(i)n.push({from:s.from,insert:e.doc.slice(s.from,s.to)+e.lineBreak});else n.push({from:s.to,insert:e.lineBreak+e.doc.slice(s.from,s.to)});t(e.update({changes:n,scrollIntoView:true,userEvent:"input.copyline"}));return true}const Nw=({state:e,dispatch:t})=>Pw(e,t,false);const Iw=({state:e,dispatch:t})=>Pw(e,t,true);const Vw=e=>{if(e.state.readOnly)return false;let{state:t}=e,i=t.changes(Rw(t).map((({from:e,to:i})=>{if(e>0)e--;else if(i<t.doc.length)i++;return{from:e,to:i}})));let n=dv(t.selection,(t=>e.moveVertically(t,true))).map(i);e.dispatch({changes:i,selection:n,scrollIntoView:true,userEvent:"delete.line"});return true};function Fw(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let i=tm(e).resolveInner(t);let n=i.childBefore(t),s=i.childAfter(t),r;if(n&&s&&n.to<=t&&s.from>=t&&(r=n.type.prop(Xd.closedBy))&&r.indexOf(s.name)>-1&&e.doc.lineAt(n.to).from==e.doc.lineAt(s.from).from)return{from:n.to,to:s.from};return null}const Hw=zw(false);const Ww=zw(true);function zw(e){return({state:t,dispatch:i})=>{if(t.readOnly)return false;let n=t.changeByRange((i=>{let{from:n,to:s}=i,r=t.doc.lineAt(n);let o=!e&&n==s&&Fw(t,n);if(e)n=s=(s<=r.to?r:t.doc.lineAt(s)).to;let l=new gm(t,{simulateBreak:n,simulateDoubleBreak:!!o});let a=mm(l,n);if(null==a)a=/^\s*/.exec(t.doc.lineAt(n).text)[0].length;while(s<r.to&&/\s/.test(r.text[s-r.from]))s++;if(o)({from:n,to:s}=o);else if(n>r.from&&n<r.from+100&&!/\S/.test(r.text.slice(0,n)))n=r.from;let h=["",pm(t,a)];if(o)h.push(pm(t,l.lineIndent(r.from,-1)));return{changes:{from:n,to:s,insert:_r.of(h)},range:fo.cursor(n+1+h[1].length)}}));i(t.update(n,{scrollIntoView:true,userEvent:"input"}));return true}}function qw(e,t){let i=-1;return e.changeByRange((n=>{let s=[];for(let o=n.from;o<=n.to;){let r=e.doc.lineAt(o);if(r.number>i&&(n.empty||n.to>r.from)){t(r,s,n);i=r.number}o=r.to+1}let r=e.changes(s);return{changes:s,range:fo.range(r.mapPos(n.anchor,1),r.mapPos(n.head,1))}}))}const jw=({state:e,dispatch:t})=>{if(e.readOnly)return false;let i=Object.create(null);let n=new gm(e,{overrideIndentation:e=>{let t=i[e];return null==t?-1:t}});let s=qw(e,((t,s,r)=>{let o=mm(n,t.from);if(null==o)return;if(!/\S/.test(t.text))o=0;let l=/^\s*/.exec(t.text)[0];let a=pm(e,o);if(l!=a||r.from<t.from+l.length){i[t.from]=o;s.push({from:t.from,to:t.from+l.length,insert:a})}}));if(!s.changes.empty)t(e.update(s,{userEvent:"indent"}));return true};const $w=({state:e,dispatch:t})=>{if(e.readOnly)return false;t(e.update(qw(e,((t,i)=>{i.push({from:t.from,insert:e.facet(um)})})),{userEvent:"input.indent"}));return true};const Uw=({state:e,dispatch:t})=>{if(e.readOnly)return false;t(e.update(qw(e,((t,i)=>{let n=/^\s*/.exec(t.text)[0];if(!n)return;let s=Sl(n,e.tabSize),r=0;let o=pm(e,Math.max(0,s-dm(e)));while(r<n.length&&r<o.length&&n.charCodeAt(r)==o.charCodeAt(r))r++;i.push({from:t.from+r,to:t.from+n.length,insert:o.slice(r)})})),{userEvent:"delete.dedent"}));return true};const Kw=[{key:"Ctrl-b",run:yv,shift:Uv,preventDefault:true},{key:"Ctrl-f",run:bv,shift:Kv},{key:"Ctrl-p",run:Tv,shift:ew},{key:"Ctrl-n",run:Ev,shift:tw},{key:"Ctrl-a",run:Hv,shift:hw},{key:"Ctrl-e",run:Wv,shift:cw},{key:"Ctrl-d",run:Sw},{key:"Ctrl-h",run:kw},{key:"Ctrl-k",run:Ow},{key:"Ctrl-Alt-h",run:Aw},{key:"Ctrl-o",run:Tw},{key:"Ctrl-t",run:Ew},{key:"Ctrl-v",run:Lv}];const Gw=[{key:"ArrowLeft",run:yv,shift:Uv,preventDefault:true},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:kv,shift:Jv,preventDefault:true},{mac:"Cmd-ArrowLeft",run:Vv,shift:lw,preventDefault:true},{key:"ArrowRight",run:bv,shift:Kv,preventDefault:true},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Sv,shift:Xv,preventDefault:true},{mac:"Cmd-ArrowRight",run:Fv,shift:aw,preventDefault:true},{key:"ArrowUp",run:Tv,shift:ew,preventDefault:true},{mac:"Cmd-ArrowUp",run:fw,shift:dw},{mac:"Ctrl-ArrowUp",run:Bv,shift:nw},{key:"ArrowDown",run:Ev,shift:tw,preventDefault:true},{mac:"Cmd-ArrowDown",run:uw,shift:pw},{mac:"Ctrl-ArrowDown",run:Lv,shift:sw},{key:"PageUp",run:Bv,shift:nw},{key:"PageDown",run:Lv,shift:sw},{key:"Home",run:Iv,shift:ow,preventDefault:true},{key:"Mod-Home",run:fw,shift:dw},{key:"End",run:Nv,shift:rw,preventDefault:true},{key:"Mod-End",run:uw,shift:pw},{key:"Enter",run:Hw},{key:"Mod-a",run:mw},{key:"Backspace",run:kw,shift:kw},{key:"Delete",run:Sw},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Aw},{key:"Mod-Delete",mac:"Alt-Delete",run:Mw},{mac:"Mod-Backspace",run:Dw},{mac:"Mod-Delete",run:Ow}].concat(Kw.map((e=>({mac:e.key,run:e.run,shift:e.shift}))));const Jw=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Mv,shift:Yv},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Ov,shift:Qv},{key:"Alt-ArrowUp",run:Bw},{key:"Shift-Alt-ArrowUp",run:Nw},{key:"Alt-ArrowDown",run:Lw},{key:"Shift-Alt-ArrowDown",run:Iw},{key:"Escape",run:ww},{key:"Mod-Enter",run:Ww},{key:"Alt-l",mac:"Ctrl-l",run:gw},{key:"Mod-i",run:vw,preventDefault:true},{key:"Mod-[",run:Uw},{key:"Mod-]",run:$w},{key:"Mod-Alt-\\",run:jw},{key:"Shift-Mod-k",run:Vw},{key:"Shift-Mod-\\",run:qv},{key:"Mod-/",run:Eg},{key:"Alt-A",run:Bg}].concat(Gw);function Xw(){var e=arguments[0];if("string"==typeof e)e=document.createElement(e);var t=1,i=arguments[1];if(i&&"object"==typeof i&&null==i.nodeType&&!Array.isArray(i)){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var s=i[n];if("string"==typeof s)e.setAttribute(n,s);else if(null!=s)e[n]=s}t++}for(;t<arguments.length;t++)Yw(e,arguments[t]);return e}function Yw(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null==t);else if(null!=t.nodeType)e.appendChild(t);else if(Array.isArray(t))for(var i=0;i<t.length;i++)Yw(e,t[i]);else throw new RangeError("Unsupported child node: "+t)}const Qw="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class Zw{constructor(e,t,i=0,n=e.length,s,r){this.test=r;this.value={from:0,to:0};this.done=false;this.matches=[];this.buffer="";this.bufferPos=0;this.iter=e.iterRange(i,n);this.bufferStart=i;this.normalize=s?e=>s(Qw(e)):Qw;this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){this.bufferStart+=this.buffer.length;this.iter.next();if(this.iter.done)return-1;this.bufferPos=0;this.buffer=this.iter.value}return Yr(this.buffer,this.bufferPos)}next(){while(this.matches.length)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0){this.done=true;return this}let t=Qr(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Zr(e);let n=this.normalize(t);for(let s=0,r=i;;s++){let e=n.charCodeAt(s);let o=this.match(e,r);if(o){this.value=o;return this}if(s==n.length-1)break;if(r==i&&s<t.length&&t.charCodeAt(s)==e)r++}}}match(e,t){let i=null;for(let n=0;n<this.matches.length;n+=2){let s=this.matches[n],r=false;if(this.query.charCodeAt(s)==e)if(s==this.query.length-1)i={from:this.matches[n+1],to:t+1};else{this.matches[n]++;r=true}if(!r){this.matches.splice(n,2);n-=2}}if(this.query.charCodeAt(0)==e)if(1==this.query.length)i={from:t,to:t+1};else this.matches.push(1,t);if(i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferPos))i=null;return i}}if("undefined"!=typeof Symbol)Zw.prototype[Symbol.iterator]=function(){return this};const ey={from:-1,to:-1,match:/.*/.exec("")};const ty="gm"+(null==/x/.unicode?"":"u");class iy{constructor(e,t,i,n=0,s=e.length){this.text=e;this.to=s;this.curLine="";this.done=false;this.value=ey;if(/\\[sWDnr]|\n|\r|\[\^/.test(t))return new ry(e,t,i,n,s);this.re=new RegExp(t,ty+((null===i||void 0===i?void 0:i.ignoreCase)?"i":""));this.test=null===i||void 0===i?void 0:i.test;this.iter=e.iter();let r=e.lineAt(n);this.curLineStart=r.from;this.matchPos=ly(e,n);this.getLine(this.curLineStart)}getLine(e){this.iter.next(e);if(this.iter.lineBreak)this.curLine="";else{this.curLine=this.iter.value;if(this.curLineStart+this.curLine.length>this.to)this.curLine=this.curLine.slice(0,this.to-this.curLineStart);this.iter.next()}}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1;if(this.curLineStart>this.to)this.curLine="";else this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,n=i+t[0].length;this.matchPos=ly(this.text,n+(i==n?1:0));if(i==this.curLine.length)this.nextLine();if((i<n||i>this.value.to)&&(!this.test||this.test(i,n,t))){this.value={from:i,to:n,match:t};return this}e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to){this.nextLine();e=0}else{this.done=true;return this}}}}const ny=new WeakMap;class sy{constructor(e,t){this.from=e;this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let n=ny.get(e);if(!n||n.from>=i||n.to<=t){let n=new sy(t,e.sliceString(t,i));ny.set(e,n);return n}if(n.from==t&&n.to==i)return n;let{text:s,from:r}=n;if(r>t){s=e.sliceString(t,r)+s;r=t}if(n.to<i)s+=e.sliceString(n.to,i);ny.set(e,new sy(r,s));return new sy(t,s.slice(t-r,i-r))}}class ry{constructor(e,t,i,n,s){this.text=e;this.to=s;this.done=false;this.value=ey;this.matchPos=ly(e,n);this.re=new RegExp(t,ty+((null===i||void 0===i?void 0:i.ignoreCase)?"i":""));this.test=null===i||void 0===i?void 0:i.test;this.flat=sy.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from;let t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e){this.re.lastIndex=e+1;t=this.re.exec(this.flat.text)}if(t){let e=this.flat.from+t.index,i=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,i,t))){this.value={from:e,to:i,match:t};this.matchPos=ly(this.text,i+(e==i?1:0));return this}}if(this.flat.to==this.to){this.done=true;return this}this.flat=sy.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}if("undefined"!=typeof Symbol)iy.prototype[Symbol.iterator]=ry.prototype[Symbol.iterator]=function(){return this};function oy(e){try{new RegExp(e,ty);return true}catch(t){return false}}function ly(e,t){if(t>=e.length)return t;let i=e.lineAt(t),n;while(t<i.to&&(n=i.text.charCodeAt(t-i.from))>=56320&&n<57344)t++;return t}function ay(e){let t=Xw("input",{class:"cm-textfield",name:"line"});let i=Xw("form",{class:"cm-gotoLine",onkeydown:t=>{if(27==t.keyCode){t.preventDefault();e.dispatch({effects:hy.of(false)});e.focus()}else if(13==t.keyCode){t.preventDefault();n()}},onsubmit:e=>{e.preventDefault();n()}},Xw("label",e.state.phrase("Go to line"),": ",t)," ",Xw("button",{class:"cm-button",type:"submit"},e.state.phrase("go")));function n(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!i)return;let{state:n}=e,s=n.doc.lineAt(n.selection.main.head);let[,r,o,l,a]=i;let h=l?+l.slice(1):0;let c=o?+o:s.number;if(o&&a){let e=c/100;if(r)e=e*("-"==r?-1:1)+s.number/n.doc.lines;c=Math.round(n.doc.lines*e)}else if(o&&r)c=c*("-"==r?-1:1)+s.number;let f=n.doc.line(Math.max(1,Math.min(n.doc.lines,c)));e.dispatch({effects:hy.of(false),selection:fo.cursor(f.from+Math.max(0,Math.min(h,f.length))),scrollIntoView:true});e.focus()}return{dom:i}}const hy=qo.define();const cy=ko.define({create(){return true},update(e,t){for(let i of t.effects)if(i.is(hy))e=i.value;return e},provide:e=>kd.from(e,(e=>e?ay:null))});const fy=e=>{let t=wd(e,ay);if(!t){let i=[hy.of(true)];if(null==e.state.field(cy,false))i.push(qo.appendConfig.of([cy,uy]));e.dispatch({effects:i});t=wd(e,ay)}if(t)t.dom.querySelector("input").focus();return true};const uy=Kf.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}});const dy={highlightWordAroundCursor:false,minSelectionLength:1,maxMatches:100,wholeWords:false};const py=mo.define({combine(e){return rl(e,dy,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function my(e){let t=[xy,by];if(e)t.push(py.of(e));return t}const gy=Ua.mark({class:"cm-selectionMatch"});const vy=Ua.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function wy(e,t,i,n){return(0==i||e(t.sliceDoc(i-1,i))!=Zo.Word)&&(n==t.doc.length||e(t.sliceDoc(n,n+1))!=Zo.Word)}function yy(e,t,i,n){return e(t.sliceDoc(i,i+1))==Zo.Word&&e(t.sliceDoc(n-1,n))==Zo.Word}const by=vh.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){if(e.selectionSet||e.docChanged||e.viewportChanged)this.decorations=this.getDeco(e.view)}getDeco(e){let t=e.state.facet(py);let{state:i}=e,n=i.selection;if(n.ranges.length>1)return Ua.none;let s=n.main,r,o=null;if(s.empty){if(!t.highlightWordAroundCursor)return Ua.none;let e=i.wordAt(s.head);if(!e)return Ua.none;o=i.charCategorizer(s.head);r=i.sliceDoc(e.from,e.to)}else{let e=s.to-s.from;if(e<t.minSelectionLength||e>200)return Ua.none;if(t.wholeWords){r=i.sliceDoc(s.from,s.to);o=i.charCategorizer(s.head);if(!(wy(o,i,s.from,s.to)&&yy(o,i,s.from,s.to)))return Ua.none}else{r=i.sliceDoc(s.from,s.to).trim();if(!r)return Ua.none}}let l=[];for(let a of e.visibleRanges){let e=new Zw(i.doc,r,a.from,a.to);while(!e.next().done){let{from:n,to:r}=e.value;if(!o||wy(o,i,n,r)){if(s.empty&&n<=s.from&&r>=s.to)l.push(vy.range(n,r));else if(n>=s.to||r<=s.from)l.push(gy.range(n,r));if(l.length>t.maxMatches)return Ua.none}}}return Ua.set(l)}},{decorations:e=>e.decorations});const xy=Kf.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});const ky=({state:e,dispatch:t})=>{let{selection:i}=e;let n=fo.create(i.ranges.map((t=>e.wordAt(t.head)||fo.cursor(t.head))),i.mainIndex);if(n.eq(i))return false;t(e.update({selection:n}));return true};function Sy(e,t){let{main:i,ranges:n}=e.selection;let s=e.wordAt(i.head),r=s&&s.from==i.from&&s.to==i.to;for(let o=false,l=new Zw(e.doc,t,n[n.length-1].to);;){l.next();if(l.done){if(o)return null;l=new Zw(e.doc,t,0,Math.max(0,n[n.length-1].from-1));o=true}else{if(o&&n.some((e=>e.from==l.value.from)))continue;if(r){let t=e.wordAt(l.value.from);if(!t||t.from!=l.value.from||t.to!=l.value.to)continue}return l.value}}}const Cy=({state:e,dispatch:t})=>{let{ranges:i}=e.selection;if(i.some((e=>e.from===e.to)))return ky({state:e,dispatch:t});let n=e.sliceDoc(i[0].from,i[0].to);if(e.selection.ranges.some((t=>e.sliceDoc(t.from,t.to)!=n)))return false;let s=Sy(e,n);if(!s)return false;t(e.update({selection:e.selection.addRange(fo.range(s.from,s.to),false),effects:Kf.scrollIntoView(s.to)}));return true};const Ay=mo.define({combine(e){return rl(e,{top:false,caseSensitive:false,literal:false,wholeWord:false,createPanel:e=>new tb(e)})}});class My{constructor(e){this.search=e.search;this.caseSensitive=!!e.caseSensitive;this.literal=!!e.literal;this.regexp=!!e.regexp;this.replace=e.replace||"";this.valid=!!this.search&&(!this.regexp||oy(this.search));this.unquoted=this.literal?this.search:this.search.replace(/\\([nrt\\])/g,((e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\"));this.wholeWord=!!e.wholeWord}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Py(this):new Ey(this)}getCursor(e,t=0,i){let n=e.doc?e:sl.create({doc:e});if(null==i)i=n.doc.length;return this.regexp?Ry(this,n,t,i):Dy(this,n,t,i)}}class Oy{constructor(e){this.spec=e}}function Dy(e,t,i,n){return new Zw(t.doc,e.unquoted,i,n,e.caseSensitive?void 0:e=>e.toLowerCase(),e.wholeWord?Ty(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}function Ty(e,t){return(i,n,s,r)=>{if(r>i||r+s.length<n){r=Math.max(0,i-2);s=e.sliceString(r,Math.min(e.length,n+2))}return t(By(s,i-r))!=Zo.Word||t(_y(s,n-r))!=Zo.Word||t(_y(s,i-r))!=Zo.Word&&t(By(s,n-r))!=Zo.Word}}class Ey extends Oy{constructor(e){super(e)}nextMatch(e,t,i){let n=Dy(this.spec,e,i,e.doc.length).nextOverlapping();if(n.done)n=Dy(this.spec,e,0,t).nextOverlapping();return n.done?null:n.value}prevMatchInRange(e,t,i){for(let n=i;;){let i=Math.max(t,n-1e4-this.spec.unquoted.length);let s=Dy(this.spec,e,i,n),r=null;while(!s.nextOverlapping().done)r=s.value;if(r)return r;if(i==t)return null;n-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.replace}matchAll(e,t){let i=Dy(this.spec,e,0,e.doc.length),n=[];while(!i.next().done){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=Dy(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));while(!s.next().done)n(s.value.from,s.value.to)}}function Ry(e,t,i,n){return new iy(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?Ly(t.charCategorizer(t.selection.main.head)):void 0},i,n)}function _y(e,t){return e.slice(Ur(e,t,false),t)}function By(e,t){return e.slice(t,Ur(e,t))}function Ly(e){return(t,i,n)=>!n[0].length||e(By(n.input,n.index))!=Zo.Word||e(_y(n.input,n.index+n[0].length))!=Zo.Word||e(_y(n.input,n.index))!=Zo.Word&&e(By(n.input,n.index+n[0].length))!=Zo.Word}class Py extends Oy{nextMatch(e,t,i){let n=Ry(this.spec,e,i,e.doc.length).next();if(n.done)n=Ry(this.spec,e,0,t).next();return n.done?null:n.value}prevMatchInRange(e,t,i){for(let n=1;;n++){let s=Math.max(t,i-1e4*n);let r=Ry(this.spec,e,s,i),o=null;while(!r.next().done)o=r.value;if(o&&(s==t||o.from>s+10))return o;if(s==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.replace.replace(/\$([$&\d+])/g,((t,i)=>"$"==i?"$":"&"==i?e.match[0]:"0"!=i&&+i<e.match.length?e.match[i]:t))}matchAll(e,t){let i=Ry(this.spec,e,0,e.doc.length),n=[];while(!i.next().done){if(n.length>=t)return null;n.push(i.value)}return n}highlight(e,t,i,n){let s=Ry(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));while(!s.next().done)n(s.value.from,s.value.to)}}const Ny=qo.define();const Iy=qo.define();const Vy=ko.define({create(e){return new Fy(Yy(e).create(),null)},update(e,t){for(let i of t.effects)if(i.is(Ny))e=new Fy(i.value.create(),e.panel);else if(i.is(Iy))e=new Fy(e.query,i.value?Xy:null);return e},provide:e=>kd.from(e,(e=>e.panel))});class Fy{constructor(e,t){this.query=e;this.panel=t}}const Hy=Ua.mark({class:"cm-searchMatch"}),Wy=Ua.mark({class:"cm-searchMatch cm-searchMatch-selected"});const zy=vh.fromClass(class{constructor(e){this.view=e;this.decorations=this.highlight(e.state.field(Vy))}update(e){let t=e.state.field(Vy);if(t!=e.startState.field(Vy)||e.docChanged||e.selectionSet||e.viewportChanged)this.decorations=this.highlight(t)}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return Ua.none;let{view:i}=this;let n=new ul;for(let s=0,r=i.visibleRanges,o=r.length;s<o;s++){let{from:t,to:l}=r[s];while(s<o-1&&l>r[s+1].from-2*250)l=r[++s].to;e.highlight(i.state,t,l,((e,t)=>{let s=i.state.selection.ranges.some((i=>i.from==e&&i.to==t));n.add(e,t,s?Wy:Hy)}))}return n.finish()}},{decorations:e=>e.decorations});function qy(e){return t=>{let i=t.state.field(Vy,false);return i&&i.query.spec.valid?e(t,i):Qy(t)}}const jy=qy(((e,{query:t})=>{let{to:i}=e.state.selection.main;let n=t.nextMatch(e.state,i,i);if(!n)return false;e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:true,effects:rb(e,n),userEvent:"select.search"});return true}));const $y=qy(((e,{query:t})=>{let{state:i}=e,{from:n}=i.selection.main;let s=t.prevMatch(i,n,n);if(!s)return false;e.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:true,effects:rb(e,s),userEvent:"select.search"});return true}));const Uy=qy(((e,{query:t})=>{let i=t.matchAll(e.state,1e3);if(!i||!i.length)return false;e.dispatch({selection:fo.create(i.map((e=>fo.range(e.from,e.to)))),userEvent:"select.search.matches"});return true}));const Ky=({state:e,dispatch:t})=>{let i=e.selection;if(i.ranges.length>1||i.main.empty)return false;let{from:n,to:s}=i.main;let r=[],o=0;for(let l=new Zw(e.doc,e.sliceDoc(n,s));!l.next().done;){if(r.length>1e3)return false;if(l.value.from==n)o=r.length;r.push(fo.range(l.value.from,l.value.to))}t(e.update({selection:fo.create(r,o),userEvent:"select.search.matches"}));return true};const Gy=qy(((e,{query:t})=>{let{state:i}=e,{from:n,to:s}=i.selection.main;if(i.readOnly)return false;let r=t.nextMatch(i,n,n);if(!r)return false;let o=[],l,a;let h=[];if(r.from==n&&r.to==s){a=i.toText(t.getReplacement(r));o.push({from:r.from,to:r.to,insert:a});r=t.nextMatch(i,r.from,r.to);h.push(Kf.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(n).number)+"."))}if(r){let t=0==o.length||o[0].from>=r.to?0:r.to-r.from-a.length;l={anchor:r.from-t,head:r.to-t};h.push(rb(e,r))}e.dispatch({changes:o,selection:l,scrollIntoView:!!l,effects:h,userEvent:"input.replace"});return true}));const Jy=qy(((e,{query:t})=>{if(e.state.readOnly)return false;let i=t.matchAll(e.state,1e9).map((e=>{let{from:i,to:n}=e;return{from:i,to:n,insert:t.getReplacement(e)}}));if(!i.length)return false;let n=e.state.phrase("replaced $ matches",i.length)+".";e.dispatch({changes:i,effects:Kf.announce.of(n),userEvent:"input.replace.all"});return true}));function Xy(e){return e.state.facet(Ay).createPanel(e)}function Yy(e,t){var i,n,s,r;let o=e.selection.main;let l=o.empty||o.to>o.from+100?"":e.sliceDoc(o.from,o.to);if(t&&!l)return t;let a=e.facet(Ay);return new My({search:(null!==(i=null===t||void 0===t?void 0:t.literal)&&void 0!==i?i:a.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:null!==(n=null===t||void 0===t?void 0:t.caseSensitive)&&void 0!==n?n:a.caseSensitive,literal:null!==(s=null===t||void 0===t?void 0:t.literal)&&void 0!==s?s:a.literal,wholeWord:null!==(r=null===t||void 0===t?void 0:t.wholeWord)&&void 0!==r?r:a.wholeWord})}const Qy=e=>{let t=e.state.field(Vy,false);if(t&&t.panel){let i=wd(e,Xy);if(!i)return false;let n=i.dom.querySelector("[main-field]");if(n&&n!=e.root.activeElement){let i=Yy(e.state,t.query.spec);if(i.valid)e.dispatch({effects:Ny.of(i)});n.focus();n.select()}}else e.dispatch({effects:[Iy.of(true),t?Ny.of(Yy(e.state,t.query.spec)):qo.appendConfig.of(lb)]});return true};const Zy=e=>{let t=e.state.field(Vy,false);if(!t||!t.panel)return false;let i=wd(e,Xy);if(i&&i.dom.contains(e.root.activeElement))e.focus();e.dispatch({effects:Iy.of(false)});return true};const eb=[{key:"Mod-f",run:Qy,scope:"editor search-panel"},{key:"F3",run:jy,shift:$y,scope:"editor search-panel",preventDefault:true},{key:"Mod-g",run:jy,shift:$y,scope:"editor search-panel",preventDefault:true},{key:"Escape",run:Zy,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Ky},{key:"Alt-g",run:fy},{key:"Mod-d",run:Cy,preventDefault:true}];class tb{constructor(e){this.view=e;let t=this.query=e.state.field(Vy).query.spec;this.commit=this.commit.bind(this);this.searchField=Xw("input",{value:t.search,placeholder:ib(e,"Find"),"aria-label":ib(e,"Find"),class:"cm-textfield",name:"search","main-field":"true",onchange:this.commit,onkeyup:this.commit});this.replaceField=Xw("input",{value:t.replace,placeholder:ib(e,"Replace"),"aria-label":ib(e,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit});this.caseField=Xw("input",{type:"checkbox",name:"case",checked:t.caseSensitive,onchange:this.commit});this.reField=Xw("input",{type:"checkbox",name:"re",checked:t.regexp,onchange:this.commit});this.wordField=Xw("input",{type:"checkbox",name:"word",checked:t.wholeWord,onchange:this.commit});function i(e,t,i){return Xw("button",{class:"cm-button",name:e,onclick:t,type:"button"},i)}this.dom=Xw("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,i("next",(()=>jy(e)),[ib(e,"next")]),i("prev",(()=>$y(e)),[ib(e,"previous")]),i("select",(()=>Uy(e)),[ib(e,"all")]),Xw("label",null,[this.caseField,ib(e,"match case")]),Xw("label",null,[this.reField,ib(e,"regexp")]),Xw("label",null,[this.wordField,ib(e,"by word")]),...e.state.readOnly?[]:[Xw("br"),this.replaceField,i("replace",(()=>Gy(e)),[ib(e,"replace")]),i("replaceAll",(()=>Jy(e)),[ib(e,"replace all")]),Xw("button",{name:"close",onclick:()=>Zy(e),"aria-label":ib(e,"close"),type:"button"},["×"])]])}commit(){let e=new My({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});if(!e.eq(this.query)){this.query=e;this.view.dispatch({effects:Ny.of(e)})}}keydown(e){if(ru(this.view,e,"search-panel"))e.preventDefault();else if(13==e.keyCode&&e.target==this.searchField){e.preventDefault();(e.shiftKey?$y:jy)(this.view)}else if(13==e.keyCode&&e.target==this.replaceField){e.preventDefault();Gy(this.view)}}update(e){for(let t of e.transactions)for(let e of t.effects)if(e.is(Ny)&&!e.value.eq(this.query))this.setQuery(e.value)}setQuery(e){this.query=e;this.searchField.value=e.search;this.replaceField.value=e.replace;this.caseField.checked=e.caseSensitive;this.reField.checked=e.regexp;this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Ay).top}}function ib(e,t){return e.state.phrase(t)}const nb=30;const sb=/[\s\.,:;?!]/;function rb(e,{from:t,to:i}){let n=e.state.doc.lineAt(t),s=e.state.doc.lineAt(i).to;let r=Math.max(n.from,t-nb),o=Math.min(s,i+nb);let l=e.state.sliceDoc(r,o);if(r!=n.from)for(let a=0;a<nb;a++)if(!sb.test(l[a+1])&&sb.test(l[a])){l=l.slice(a);break}if(o!=s)for(let a=l.length-1;a>l.length-nb;a--)if(!sb.test(l[a-1])&&sb.test(l[a])){l=l.slice(0,a);break}return Kf.announce.of(`${e.state.phrase("current match")}. ${l} ${e.state.phrase("on line")} ${n.number}.`)}const ob=Kf.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}});const lb=[Vy,Ao.lowest(zy),ob];class ab{constructor(e,t,i){this.state=e;this.pos=t;this.explicit=i;this.abortListeners=[]}tokenBefore(e){let t=tm(this.state).resolveInner(this.pos,-1);while(t&&e.indexOf(t.name)<0)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos);let i=Math.max(t.from,this.pos-250);let n=t.text.slice(i-t.from,this.pos-t.from);let s=n.search(pb(e,false));return s<0?null:{from:i+s,to:this.pos,text:n.slice(s)}}get aborted(){return null==this.abortListeners}addEventListener(e,t){if("abort"==e&&this.abortListeners)this.abortListeners.push(t)}}function hb(e){let t=Object.keys(e).join("");let i=/\w/.test(t);if(i)t=t.replace(/\w/g,"");return`[${i?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function cb(e){let t=Object.create(null),i=Object.create(null);for(let{label:s}of e){t[s[0]]=true;for(let e=1;e<s.length;e++)i[s[e]]=true}let n=hb(t)+hb(i)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function fb(e){let t=e.map((e=>"string"==typeof e?{label:e}:e));let[i,n]=t.every((e=>/^\w+$/.test(e.label)))?[/\w*$/,/\w+$/]:cb(t);return e=>{let s=e.matchBefore(n);return s||e.explicit?{from:s?s.from:e.pos,options:t,validFor:i}:null}}class ub{constructor(e,t,i){this.completion=e;this.source=t;this.match=i}}function db(e){return e.selection.main.head}function pb(e,t){var i;let{source:n}=e;let s=t&&"^"!=n[0],r="$"!=n[n.length-1];if(!s&&!r)return e;return new RegExp(`${s?"^":""}(?:${n})${r?"$":""}`,null!==(i=e.flags)&&void 0!==i?i:e.ignoreCase?"i":"")}function mb(e,t,i,n){return Object.assign(Object.assign({},e.changeByRange((s=>{if(s==e.selection.main)return{changes:{from:i,to:n,insert:t},range:fo.cursor(i+t.length)};let r=n-i;if(!s.empty||r&&e.sliceDoc(s.from-r,s.from)!=e.sliceDoc(i,n))return{range:s};return{changes:{from:s.from-r,to:s.from,insert:t},range:fo.cursor(s.from-r+t.length)}}))),{userEvent:"input.complete"})}function gb(e,t){const i=t.completion.apply||t.completion.label;let n=t.source;if("string"==typeof i)e.dispatch(mb(e.state,i,n.from,n.to));else i(e,t.completion,n.from,n.to)}const vb=new WeakMap;function wb(e){if(!Array.isArray(e))return e;let t=vb.get(e);if(!t)vb.set(e,t=fb(e));return t}class yb{constructor(e){this.pattern=e;this.chars=[];this.folded=[];this.any=[];this.precise=[];this.byWord=[];for(let t=0;t<e.length;){let i=Yr(e,t),n=Zr(i);this.chars.push(i);let s=e.slice(t,t+n),r=s.toUpperCase();this.folded.push(Yr(r==s?s.toLowerCase():r,0));t+=n}this.astral=e.length!=this.chars.length}match(e){if(0==this.pattern.length)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:n,precise:s,byWord:r}=this;if(1==t.length){let n=Yr(e,0);return n==t[0]?[0,0,Zr(n)]:n==i[0]?[-200,0,Zr(n)]:null}let o=e.indexOf(this.pattern);if(0==o)return[0,0,this.pattern.length];let l=t.length,a=0;if(o<0){for(let s=0,r=Math.min(e.length,200);s<r&&a<l;){let r=Yr(e,s);if(r==t[a]||r==i[a])n[a++]=s;s+=Zr(r)}if(a<l)return null}let h=0;let c=0,f=false;let u=0,d=-1,p=-1;let m=/[a-z]/.test(e),g=true;for(let v=0,w=Math.min(e.length,200),y=0;v<w&&c<l;){let n=Yr(e,v);if(o<0){if(h<l&&n==t[h])s[h++]=v;if(u<l)if(n==t[u]||n==i[u]){if(0==u)d=v;p=v+1;u++}else u=0}let a,w=n<255?n>=48&&n<=57||n>=97&&n<=122?2:n>=65&&n<=90?1:0:(a=Qr(n))!=a.toLowerCase()?1:a!=a.toUpperCase()?2:0;if(!v||1==w&&m||0==y&&0!=w)if(t[c]==n||i[c]==n&&(f=true))r[c++]=v;else if(r.length)g=false;y=w;v+=Zr(n)}if(c==l&&0==r[0]&&g)return this.result(-100+(f?-200:0),r,e);if(u==l&&0==d)return[-200-e.length,0,p];if(o>-1)return[-700-e.length,o,o+this.pattern.length];if(u==l)return[-200+-700-e.length,d,p];if(c==l)return this.result(-100+(f?-200:0)+-700+(g?0:-1100),r,e);return 2==t.length?null:this.result((n[0]?-700:0)+-200+-1100,n,e)}result(e,t,i){let n=[e-i.length],s=1;for(let r of t){let e=r+(this.astral?Zr(Yr(i,r)):1);if(s>1&&n[s-1]==r)n[s-1]=e;else{n[s++]=r;n[s++]=e}}return n}}const bb=mo.define({combine(e){return rl(e,{activateOnTyping:true,selectOnOpen:true,override:null,closeOnBlur:true,maxRenderedOptions:100,defaultKeymap:true,optionClass:()=>"",aboveCursor:false,icons:true,addToOptions:[],compareCompletions:(e,t)=>e.label.localeCompare(t.label)},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,optionClass:(e,t)=>i=>xb(e(i),t(i)),addToOptions:(e,t)=>e.concat(t)})}});function xb(e,t){return e?t?e+" "+t:e:t}function kb(e){let t=e.addToOptions.slice();if(e.icons)t.push({render(e){let t=document.createElement("div");t.classList.add("cm-completionIcon");if(e.type)t.classList.add(...e.type.split(/\s+/g).map((e=>"cm-completionIcon-"+e)));t.setAttribute("aria-hidden","true");return t},position:20});t.push({render(e,t,i){let n=document.createElement("span");n.className="cm-completionLabel";let{label:s}=e,r=0;for(let o=1;o<i.length;){let e=i[o++],t=i[o++];if(e>r)n.appendChild(document.createTextNode(s.slice(r,e)));let l=n.appendChild(document.createElement("span"));l.appendChild(document.createTextNode(s.slice(e,t)));l.className="cm-completionMatchedText";r=t}if(r<s.length)n.appendChild(document.createTextNode(s.slice(r)));return n},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");t.className="cm-completionDetail";t.textContent=e.detail;return t},position:80});return t.sort(((e,t)=>e.position-t.position)).map((e=>e.render))}function Sb(e,t,i){if(e<=i)return{from:0,to:e};if(t<0)t=0;if(t<=e>>1){let e=Math.floor(t/i);return{from:e*i,to:(e+1)*i}}let n=Math.floor((e-t)/i);return{from:e-(n+1)*i,to:e-n*i}}class Cb{constructor(e,t){this.view=e;this.stateField=t;this.info=null;this.placeInfo={read:()=>this.measureInfo(),write:e=>this.positionInfo(e),key:this};let i=e.state.field(t);let{options:n,selected:s}=i.open;let r=e.state.facet(bb);this.optionContent=kb(r);this.optionClass=r.optionClass;this.range=Sb(n.length,s,r.maxRenderedOptions);this.dom=document.createElement("div");this.dom.className="cm-tooltip-autocomplete";this.dom.addEventListener("mousedown",(t=>{for(let i=t.target,s;i&&i!=this.dom;i=i.parentNode)if("LI"==i.nodeName&&(s=/-(\d+)$/.exec(i.id))&&+s[1]<n.length){gb(e,n[+s[1]]);t.preventDefault();return}}));this.list=this.dom.appendChild(this.createListBox(n,i.id,this.range));this.list.addEventListener("scroll",(()=>{if(this.info)this.view.requestMeasure(this.placeInfo)}))}mount(){this.updateSel()}update(e){if(e.state.field(this.stateField)!=e.startState.field(this.stateField))this.updateSel()}positioned(){if(this.info)this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if(t.selected<this.range.from||t.selected>=this.range.to){this.range=Sb(t.options.length,t.selected,this.view.state.facet(bb).maxRenderedOptions);this.list.remove();this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range));this.list.addEventListener("scroll",(()=>{if(this.info)this.view.requestMeasure(this.placeInfo)}))}if(this.updateSelectedOption(t.selected)){if(this.info){this.info.remove();this.info=null}let{completion:i}=t.options[t.selected];let{info:n}=i;if(!n)return;let s="string"===typeof n?document.createTextNode(n):n(i);if(!s)return;if("then"in s)s.then((t=>{if(t&&this.view.state.field(this.stateField,false)==e)this.addInfoPane(t)})).catch((e=>dh(this.view.state,e,"completion info")));else this.addInfoPane(s)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo";t.appendChild(e);this.dom.appendChild(t);this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)if(n==e){if(!i.hasAttribute("aria-selected")){i.setAttribute("aria-selected","true");t=i}}else if(i.hasAttribute("aria-selected"))i.removeAttribute("aria-selected");if(t)Mb(this.list,t);return t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect();let i=this.info.getBoundingClientRect();let n=e.getBoundingClientRect();if(n.top>Math.min(innerHeight,t.bottom)-10||n.bottom<Math.max(0,t.top)+10)return null;let s=Math.max(0,Math.min(n.top,innerHeight-i.height))-t.top;let r=this.view.textDirection==Oh.RTL;let o=t.left,l=innerWidth-t.right;if(r&&o<Math.min(i.width,l))r=false;else if(!r&&l<Math.min(i.width,o))r=true;return{top:s,left:r}}positionInfo(e){if(this.info){this.info.style.top=(e?e.top:-1e6)+"px";if(e){this.info.classList.toggle("cm-completionInfo-left",e.left);this.info.classList.toggle("cm-completionInfo-right",!e.left)}}}createListBox(e,t,i){const n=document.createElement("ul");n.id=t;n.setAttribute("role","listbox");n.setAttribute("aria-expanded","true");n.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let s=i.from;s<i.to;s++){let{completion:i,match:r}=e[s];const o=n.appendChild(document.createElement("li"));o.id=t+"-"+s;o.setAttribute("role","option");let l=this.optionClass(i);if(l)o.className=l;for(let e of this.optionContent){let t=e(i,this.view.state,r);if(t)o.appendChild(t)}}if(i.from)n.classList.add("cm-completionListIncompleteTop");if(i.to<e.length)n.classList.add("cm-completionListIncompleteBottom");return n}}function Ab(e){return t=>new Cb(t,e)}function Mb(e,t){let i=e.getBoundingClientRect();let n=t.getBoundingClientRect();if(n.top<i.top)e.scrollTop-=i.top-n.top;else if(n.bottom>i.bottom)e.scrollTop+=n.bottom-i.bottom}function Ob(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}function Db(e,t){let i=[],n=0;for(let l of e)if(l.hasResult())if(false===l.result.filter){let e=l.result.getMatch;for(let t of l.result.options){let s=[1e9-n++];if(e)for(let i of e(t))s.push(i);i.push(new ub(t,l,s))}}else{let e=new yb(t.sliceDoc(l.from,l.to)),n;for(let t of l.result.options)if(n=e.match(t.label)){if(null!=t.boost)n[0]+=t.boost;i.push(new ub(t,l,n))}}let s=[],r=null;let o=t.facet(bb).compareCompletions;for(let l of i.sort(((e,t)=>t.match[0]-e.match[0]||o(e.completion,t.completion)))){if(!r||r.label!=l.completion.label||r.detail!=l.completion.detail||null!=r.type&&null!=l.completion.type&&r.type!=l.completion.type||r.apply!=l.completion.apply)s.push(l);else if(Ob(l.completion)>Ob(r))s[s.length-1]=l;r=l.completion}return s}class Tb{constructor(e,t,i,n,s){this.options=e;this.attrs=t;this.tooltip=i;this.timestamp=n;this.selected=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Tb(this.options,Bb(t,e),this.tooltip,this.timestamp,e)}static build(e,t,i,n,s){let r=Db(e,t);if(!r.length)return null;let o=t.facet(bb).selectOnOpen?0:-1;if(n&&n.selected!=o&&-1!=n.selected){let e=n.options[n.selected].completion;for(let t=0;t<r.length;t++)if(r[t].completion==e){o=t;break}}return new Tb(r,Bb(i,o),{pos:e.reduce(((e,t)=>t.hasResult()?Math.min(e,t.from):e),1e8),create:Ab(qb),above:s.aboveCursor},n?n.timestamp:Date.now(),o)}map(e){return new Tb(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class Eb{constructor(e,t,i){this.active=e;this.id=t;this.open=i}static start(){return new Eb(Lb,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,i=t.facet(bb);let n=i.override||t.languageDataAt("autocomplete",db(t)).map(wb);let s=n.map((t=>{let n=this.active.find((e=>e.source==t))||new Nb(t,this.active.some((e=>0!=e.state))?1:0);return n.update(e,i)}));if(s.length==this.active.length&&s.every(((e,t)=>e==this.active[t])))s=this.active;let r=e.selection||s.some((t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to)))||!Rb(s,this.active)?Tb.build(s,t,this.id,this.open,i):this.open&&e.docChanged?this.open.map(e.changes):this.open;if(!r&&s.every((e=>1!=e.state))&&s.some((e=>e.hasResult())))s=s.map((e=>e.hasResult()?new Nb(e.source,0):e));for(let o of e.effects)if(o.is(zb))r=r&&r.setSelected(o.value,this.id);return s==this.active&&r==this.open?this:new Eb(s,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:_b}}function Rb(e,t){if(e==t)return true;for(let i=0,n=0;;){while(i<e.length&&!e[i].hasResult)i++;while(n<t.length&&!t[n].hasResult)n++;let s=i==e.length,r=n==t.length;if(s||r)return s==r;if(e[i++].result!=t[n++].result)return false}}const _b={"aria-autocomplete":"list"};function Bb(e,t){let i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};if(t>-1)i["aria-activedescendant"]=e+"-"+t;return i}const Lb=[];function Pb(e){return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}class Nb{constructor(e,t,i=-1){this.source=e;this.state=t;this.explicitPos=i}hasResult(){return false}update(e,t){let i=Pb(e),n=this;if(i)n=n.handleUserEvent(e,i,t);else if(e.docChanged)n=n.handleChange(e);else if(e.selection&&0!=n.state)n=new Nb(n.source,0);for(let s of e.effects)if(s.is(Fb))n=new Nb(n.source,1,s.value?db(e.state):-1);else if(s.is(Hb))n=new Nb(n.source,0);else if(s.is(Wb))for(let e of s.value)if(e.source==n.source)n=e;return n}handleUserEvent(e,t,i){return"delete"==t||!i.activateOnTyping?this.map(e.changes):new Nb(this.source,1)}handleChange(e){return e.changes.touchesRange(db(e.startState))?new Nb(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new Nb(this.source,this.state,e.mapPos(this.explicitPos))}}class Ib extends Nb{constructor(e,t,i,n,s){super(e,2,t);this.result=i;this.from=n;this.to=s}hasResult(){return true}handleUserEvent(e,t,i){var n;let s=e.changes.mapPos(this.from),r=e.changes.mapPos(this.to,1);let o=db(e.state);if((this.explicitPos<0?o<=s:o<this.from)||o>r||"delete"==t&&db(e.startState)==this.from)return new Nb(this.source,"input"==t&&i.activateOnTyping?1:0);let l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),a;if(Vb(this.result.validFor,e.state,s,r))return new Ib(this.source,l,this.result,s,r);if(this.result.update&&(a=this.result.update(this.result,s,r,new ab(e.state,o,l>=0))))return new Ib(this.source,l,a,a.from,null!==(n=a.to)&&void 0!==n?n:db(e.state));return new Nb(this.source,1,l)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new Nb(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new Ib(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function Vb(e,t,i,n){if(!e)return false;let s=t.sliceDoc(i,n);return"function"==typeof e?e(s,i,n,t):pb(e,true).test(s)}const Fb=qo.define();const Hb=qo.define();const Wb=qo.define({map(e,t){return e.map((e=>e.map(t)))}});const zb=qo.define();const qb=ko.define({create(){return Eb.start()},update(e,t){return e.update(t)},provide:e=>[ld.from(e,(e=>e.tooltip)),Kf.contentAttributes.from(e,(e=>e.attrs))]});const jb=75;function $b(e,t="option"){return i=>{let n=i.state.field(qb,false);if(!n||!n.open||Date.now()-n.open.timestamp<jb)return false;let s=1,r;if("page"==t&&(r=md(i,n.open.tooltip)))s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1);let{length:o}=n.open.options;let l=n.open.selected>-1?n.open.selected+s*(e?1:-1):e?0:o-1;if(l<0)l="page"==t?0:o-1;else if(l>=o)l="page"==t?o-1:0;i.dispatch({effects:zb.of(l)});return true}}const Ub=e=>{let t=e.state.field(qb,false);if(e.state.readOnly||!t||!t.open||Date.now()-t.open.timestamp<jb||t.open.selected<0)return false;gb(e,t.open.options[t.open.selected]);return true};const Kb=e=>{let t=e.state.field(qb,false);if(!t)return false;e.dispatch({effects:Fb.of(true)});return true};const Gb=e=>{let t=e.state.field(qb,false);if(!t||!t.active.some((e=>0!=e.state)))return false;e.dispatch({effects:Hb.of(null)});return true};class Jb{constructor(e,t){this.active=e;this.context=t;this.time=Date.now();this.updates=[];this.done=void 0}}const Xb=50,Yb=50,Qb=1e3;const Zb=vh.fromClass(class{constructor(e){this.view=e;this.debounceUpdate=-1;this.running=[];this.debounceAccept=-1;this.composing=0;for(let t of e.state.field(qb).active)if(1==t.state)this.startQuery(t)}update(e){let t=e.state.field(qb);if(!e.selectionSet&&!e.docChanged&&e.startState.field(qb)==t)return;let i=e.transactions.some((e=>(e.selection||e.docChanged)&&!Pb(e)));for(let s=0;s<this.running.length;s++){let t=this.running[s];if(i||t.updates.length+e.transactions.length>Yb&&Date.now()-t.time>Qb){for(let e of t.context.abortListeners)try{e()}catch(n){dh(this.view.state,n)}t.context.abortListeners=null;this.running.splice(s--,1)}else t.updates.push(...e.transactions)}if(this.debounceUpdate>-1)clearTimeout(this.debounceUpdate);this.debounceUpdate=t.active.some((e=>1==e.state&&!this.running.some((t=>t.active.source==e.source))))?setTimeout((()=>this.startUpdate()),Xb):-1;if(0!=this.composing)for(let s of e.transactions)if("input"==Pb(s))this.composing=2;else if(2==this.composing&&s.selection)this.composing=3}startUpdate(){this.debounceUpdate=-1;let{state:e}=this.view,t=e.field(qb);for(let i of t.active)if(1==i.state&&!this.running.some((e=>e.active.source==i.source)))this.startQuery(i)}startQuery(e){let{state:t}=this.view,i=db(t);let n=new ab(t,i,e.explicitPos==i);let s=new Jb(e,n);this.running.push(s);Promise.resolve(e.source(n)).then((e=>{if(!s.context.aborted){s.done=e||null;this.scheduleAccept()}}),(e=>{this.view.dispatch({effects:Hb.of(null)});dh(this.view.state,e)}))}scheduleAccept(){if(this.running.every((e=>void 0!==e.done)))this.accept();else if(this.debounceAccept<0)this.debounceAccept=setTimeout((()=>this.accept()),Xb)}accept(){var e;if(this.debounceAccept>-1)clearTimeout(this.debounceAccept);this.debounceAccept=-1;let t=[];let i=this.view.state.facet(bb);for(let n=0;n<this.running.length;n++){let s=this.running[n];if(void 0===s.done)continue;this.running.splice(n--,1);if(s.done){let n=new Ib(s.active.source,s.active.explicitPos,s.done,s.done.from,null!==(e=s.done.to)&&void 0!==e?e:db(s.updates.length?s.updates[0].startState:this.view.state));for(let e of s.updates)n=n.update(e,i);if(n.hasResult()){t.push(n);continue}}let r=this.view.state.field(qb).active.find((e=>e.source==s.active.source));if(r&&1==r.state)if(null==s.done){let e=new Nb(s.active.source,0);for(let t of s.updates)e=e.update(t,i);if(1!=e.state)t.push(e)}else this.startQuery(r)}if(t.length)this.view.dispatch({effects:Wb.of(t)})}},{eventHandlers:{blur(){let e=this.view.state.field(qb,false);if(e&&e.tooltip&&this.view.state.facet(bb).closeOnBlur)this.view.dispatch({effects:Hb.of(null)})},compositionstart(){this.composing=1},compositionend(){if(3==this.composing)setTimeout((()=>this.view.dispatch({effects:Fb.of(false)})),20);this.composing=0}}});const ex=Kf.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});const tx={brackets:["(","[","{","'",'"'],before:")]}:;>"};const ix=qo.define({map(e,t){let i=t.mapPos(e,-1,to.TrackAfter);return null==i?void 0:i}});const nx=qo.define({map(e,t){return t.mapPos(e)}});const sx=new class extends ol{};sx.startSide=1;sx.endSide=-1;const rx=ko.define({create(){return cl.empty},update(e,t){if(t.selection){let i=t.state.doc.lineAt(t.selection.main.head).from;let n=t.startState.doc.lineAt(t.startState.selection.main.head).from;if(i!=t.changes.mapPos(n,-1))e=cl.empty}e=e.map(t.changes);for(let i of t.effects)if(i.is(ix))e=e.update({add:[sx.range(i.value,i.value+1)]});else if(i.is(nx))e=e.update({filter:e=>e!=i.value});return e}});function ox(){return[fx,rx]}const lx="()[]{}<>";function ax(e){for(let t=0;t<lx.length;t+=2)if(lx.charCodeAt(t)==e)return lx.charAt(t+1);return Qr(e<128?e:e+1)}function hx(e,t){return e.languageDataAt("closeBrackets",t)[0]||tx}const cx="object"==typeof navigator&&/Android\b/.test(navigator.userAgent);const fx=Kf.inputHandler.of(((e,t,i,n)=>{if((cx?e.composing:e.compositionStarted)||e.state.readOnly)return false;let s=e.state.selection.main;if(n.length>2||2==n.length&&1==Zr(Yr(n,0))||t!=s.from||i!=s.to)return false;let r=px(e.state,n);if(!r)return false;e.dispatch(r);return true}));const ux=({state:e,dispatch:t})=>{if(e.readOnly)return false;let i=hx(e,e.selection.main.head);let n=i.brackets||tx.brackets;let s=null,r=e.changeByRange((t=>{if(t.empty){let i=vx(e.doc,t.head);for(let s of n)if(s==i&&gx(e.doc,t.head)==ax(Yr(s,0)))return{changes:{from:t.head-s.length,to:t.head+s.length},range:fo.cursor(t.head-s.length),userEvent:"delete.backward"}}return{range:s=t}}));if(!s)t(e.update(r,{scrollIntoView:true}));return!s};const dx=[{key:"Backspace",run:ux}];function px(e,t){let i=hx(e,e.selection.main.head);let n=i.brackets||tx.brackets;for(let s of n){let r=ax(Yr(s,0));if(t==s)return r==s?bx(e,s,n.indexOf(s+s+s)>-1):wx(e,s,r,i.before||tx.before);if(t==r&&mx(e,e.selection.main.from))return yx(e,s,r)}return null}function mx(e,t){let i=false;e.field(rx).between(0,e.doc.length,(e=>{if(e==t)i=true}));return i}function gx(e,t){let i=e.sliceString(t,t+2);return i.slice(0,Zr(Yr(i,0)))}function vx(e,t){let i=e.sliceString(t-2,t);return Zr(Yr(i,0))==i.length?i:i.slice(1)}function wx(e,t,i,n){let s=null,r=e.changeByRange((r=>{if(!r.empty)return{changes:[{insert:t,from:r.from},{insert:i,from:r.to}],effects:ix.of(r.to+t.length),range:fo.range(r.anchor+t.length,r.head+t.length)};let o=gx(e.doc,r.head);if(!o||/\s/.test(o)||n.indexOf(o)>-1)return{changes:{insert:t+i,from:r.head},effects:ix.of(r.head+t.length),range:fo.cursor(r.head+t.length)};return{range:s=r}}));return s?null:e.update(r,{scrollIntoView:true,userEvent:"input.type"})}function yx(e,t,i){let n=null,s=e.selection.ranges.map((t=>{if(t.empty&&gx(e.doc,t.head)==i)return fo.cursor(t.head+i.length);return n=t}));return n?null:e.update({selection:fo.create(s,e.selection.mainIndex),scrollIntoView:true,effects:e.selection.ranges.map((({from:e})=>nx.of(e)))})}function bx(e,t,i){let n=null,s=e.changeByRange((s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:t,from:s.to}],effects:ix.of(s.to+t.length),range:fo.range(s.anchor+t.length,s.head+t.length)};let r=s.head,o=gx(e.doc,r);if(o==t){if(xx(e,r))return{changes:{insert:t+t,from:r},effects:ix.of(r+t.length),range:fo.cursor(r+t.length)};else if(mx(e,r)){let n=i&&e.sliceDoc(r,r+3*t.length)==t+t+t;return{range:fo.cursor(r+t.length*(n?3:1)),effects:nx.of(r)}}}else if(i&&e.sliceDoc(r-2*t.length,r)==t+t&&xx(e,r-2*t.length))return{changes:{insert:t+t+t+t,from:r},effects:ix.of(r+t.length),range:fo.cursor(r+t.length)};else if(e.charCategorizer(r)(o)!=Zo.Word){let i=e.sliceDoc(r-1,r);if(i!=t&&e.charCategorizer(r)(i)!=Zo.Word&&!kx(e,r,t))return{changes:{insert:t+t,from:r},effects:ix.of(r+t.length),range:fo.cursor(r+t.length)}}return{range:n=s}}));return n?null:e.update(s,{scrollIntoView:true,userEvent:"input.type"})}function xx(e,t){let i=tm(e).resolveInner(t+1);return i.parent&&i.from==t}function kx(e,t,i){let n=tm(e).resolveInner(t,-1);for(let s=0;s<5;s++){if(e.sliceDoc(n.from,n.from+i.length)==i){let t=n.firstChild;while(t&&t.from==n.from&&t.to-t.from>i.length){if(e.sliceDoc(t.to-i.length,t.to)==i)return false;t=t.firstChild}return true}let s=n.to==t&&n.parent;if(!s)break;n=s}return false}function Sx(e={}){return[qb,bb.of(e),Zb,Ax,ex]}const Cx=[{key:"Ctrl-Space",run:Kb},{key:"Escape",run:Gb},{key:"ArrowDown",run:$b(true)},{key:"ArrowUp",run:$b(false)},{key:"PageDown",run:$b(true,"page")},{key:"PageUp",run:$b(false,"page")},{key:"Enter",run:Ub}];const Ax=Ao.highest(iu.computeN([bb],(e=>e.facet(bb).defaultKeymap?[Cx]:[])));class Mx{constructor(e,t,i){this.from=e;this.to=t;this.diagnostic=i}}class Ox{constructor(e,t,i){this.diagnostics=e;this.panel=t;this.selected=i}static init(e,t,i){let n=e;let s=i.facet(jx).markerFilter;if(s)n=s(n);let r=Ua.set(n.map((e=>e.from==e.to||e.from==e.to-1&&i.doc.lineAt(e.from).to==e.from?Ua.widget({widget:new Kx(e),diagnostic:e}).range(e.from):Ua.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity},diagnostic:e}).range(e.from,e.to))),true);return new Ox(r,t,Dx(r))}}function Dx(e,t=null,i=0){let n=null;e.between(i,1e9,((e,i,{spec:s})=>{if(t&&s.diagnostic!=t)return;n=new Mx(e,i,s.diagnostic);return false}));return n}function Tx(e,t){return!!(e.effects.some((e=>e.is(_x)))||e.changes.touchesRange(t.pos))}function Ex(e,t){return e.field(Px,false)?t:t.concat(qo.appendConfig.of([Px,Kf.decorations.compute([Px],(e=>{let{selected:t,panel:i}=e.field(Px);return!t||!i||t.from==t.to?Ua.none:Ua.set([Nx.range(t.from,t.to)])})),pd(Ix,{hideOn:Tx}),Qx]))}function Rx(e,t){return{effects:Ex(e,[_x.of(t)])}}const _x=qo.define();const Bx=qo.define();const Lx=qo.define();const Px=ko.define({create(){return new Ox(Ua.none,null,null)},update(e,t){if(t.docChanged){let i=e.diagnostics.map(t.changes),n=null;if(e.selected){let s=t.changes.mapPos(e.selected.from,1);n=Dx(i,e.selected.diagnostic,s)||Dx(i,null,s)}e=new Ox(i,e.panel,n)}for(let i of t.effects)if(i.is(_x))e=Ox.init(i.value,e.panel,t.state);else if(i.is(Bx))e=new Ox(e.diagnostics,i.value?Jx.open:null,e.selected);else if(i.is(Lx))e=new Ox(e.diagnostics,e.panel,i.value);return e},provide:e=>[kd.from(e,(e=>e.panel)),Kf.decorations.from(e,(e=>e.diagnostics))]});const Nx=Ua.mark({class:"cm-lintRange cm-lintRange-active"});function Ix(e,t,i){let{diagnostics:n}=e.state.field(Px);let s=[],r=2e8,o=0;n.between(t-(i<0?1:0),t+(i>0?1:0),((e,n,{spec:l})=>{if(t>=e&&t<=n&&(e==n||(t>e||i>0)&&(t<n||i<0))){s.push(l.diagnostic);r=Math.min(e,r);o=Math.max(n,o)}}));let l=e.state.facet(jx).tooltipFilter;if(l)s=l(s);if(!s.length)return null;return{pos:r,end:o,above:e.state.doc.lineAt(r).to<o,create(){return{dom:Vx(e,s)}}}}function Vx(e,t){return Xw("ul",{class:"cm-tooltip-lint"},t.map((t=>Ux(e,t,false))))}const Fx=e=>{let t=e.state.field(Px,false);if(!t||!t.panel)e.dispatch({effects:Ex(e.state,[Bx.of(true)])});let i=wd(e,Jx.open);if(i)i.dom.querySelector(".cm-panel-lint ul").focus();return true};const Hx=e=>{let t=e.state.field(Px,false);if(!t||!t.panel)return false;e.dispatch({effects:Bx.of(false)});return true};const Wx=e=>{let t=e.state.field(Px,false);if(!t)return false;let i=e.state.selection.main,n=t.diagnostics.iter(i.to+1);if(!n.value){n=t.diagnostics.iter(0);if(!n.value||n.from==i.from&&n.to==i.to)return false}e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:true});return true};const zx=[{key:"Mod-Shift-m",run:Fx},{key:"F8",run:Wx}];const qx=vh.fromClass(class{constructor(e){this.view=e;this.timeout=-1;this.set=true;let{delay:t}=e.state.facet(jx);this.lintTime=Date.now()+t;this.run=this.run.bind(this);this.timeout=setTimeout(this.run,t)}run(){let e=Date.now();if(e<this.lintTime-10)setTimeout(this.run,this.lintTime-e);else{this.set=false;let{state:e}=this.view,{sources:t}=e.facet(jx);Promise.all(t.map((e=>Promise.resolve(e(this.view))))).then((t=>{let i=t.reduce(((e,t)=>e.concat(t)));if(this.view.state.doc==e.doc)this.view.dispatch(Rx(this.view.state,i))}),(e=>{dh(this.view.state,e)}))}}update(e){let t=e.state.facet(jx);if(e.docChanged||t!=e.startState.facet(jx)){this.lintTime=Date.now()+t.delay;if(!this.set){this.set=true;this.timeout=setTimeout(this.run,t.delay)}}}force(){if(this.set){this.lintTime=Date.now();this.run()}}destroy(){clearTimeout(this.timeout)}});const jx=mo.define({combine(e){return Object.assign({sources:e.map((e=>e.source))},rl(e.map((e=>e.config)),{delay:750,markerFilter:null,tooltipFilter:null}))},enables:qx});function $x(e){let t=[];if(e)e:for(let{name:i}of e){for(let e=0;e<i.length;e++){let n=i[e];if(/[a-zA-Z]/.test(n)&&!t.some((e=>e.toLowerCase()==n.toLowerCase()))){t.push(n);continue e}}t.push("")}return t}function Ux(e,t,i){var n;let s=i?$x(t.actions):[];return Xw("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},Xw("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage():t.message),null===(n=t.actions)||void 0===n?void 0:n.map(((i,n)=>{let r=n=>{n.preventDefault();let s=Dx(e.state.field(Px).diagnostics,t);if(s)i.apply(e,s.from,s.to)};let{name:o}=i,l=s[n]?o.indexOf(s[n]):-1;let a=l<0?o:[o.slice(0,l),Xw("u",o.slice(l,l+1)),o.slice(l+1)];return Xw("button",{type:"button",class:"cm-diagnosticAction",onclick:r,onmousedown:r,"aria-label":` Action: ${o}${l<0?"":` (access key "${s[n]})"`}.`},a)})),t.source&&Xw("div",{class:"cm-diagnosticSource"},t.source))}class Kx extends ja{constructor(e){super();this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return Xw("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Gx{constructor(e,t){this.diagnostic=t;this.id="item_"+Math.floor(4294967295*Math.random()).toString(16);this.dom=Ux(e,t,true);this.dom.id=this.id;this.dom.setAttribute("role","option")}}class Jx{constructor(e){this.view=e;this.items=[];let t=t=>{if(27==t.keyCode){Hx(this.view);this.view.focus()}else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else if(t.keyCode>=65&&t.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:i}=this.items[this.selectedIndex],n=$x(i.actions);for(let s=0;s<n.length;s++)if(n[s].toUpperCase().charCodeAt(0)==t.keyCode){let t=Dx(this.view.state.field(Px).diagnostics,i);if(t)i.actions[s].apply(e,t.from,t.to)}}else return;t.preventDefault()};let i=e=>{for(let t=0;t<this.items.length;t++)if(this.items[t].dom.contains(e.target))this.moveSelection(t)};this.list=Xw("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i});this.dom=Xw("div",{class:"cm-panel-lint"},this.list,Xw("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Hx(this.view)},"×"));this.update()}get selectedIndex(){let e=this.view.state.field(Px).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Px);let i=0,n=false,s=null;e.between(0,this.view.state.doc.length,((e,r,{spec:o})=>{let l=-1,a;for(let t=i;t<this.items.length;t++)if(this.items[t].diagnostic==o.diagnostic){l=t;break}if(l<0){a=new Gx(this.view,o.diagnostic);this.items.splice(i,0,a);n=true}else{a=this.items[l];if(l>i){this.items.splice(i,l-i);n=true}}if(t&&a.diagnostic==t.diagnostic){if(!a.dom.hasAttribute("aria-selected")){a.dom.setAttribute("aria-selected","true");s=a}}else if(a.dom.hasAttribute("aria-selected"))a.dom.removeAttribute("aria-selected");i++}));while(i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0)){n=true;this.items.pop()}if(0==this.items.length){this.items.push(new Gx(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")}));n=true}if(s){this.list.setAttribute("aria-activedescendant",s.id);this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{if(e.top<t.top)this.list.scrollTop-=t.top-e.top;else if(e.bottom>t.bottom)this.list.scrollTop+=e.bottom-t.bottom}})}else if(this.selectedIndex<0)this.list.removeAttribute("aria-activedescendant");if(n)this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling;t.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){while(e!=i.dom)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);while(e)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Px);let i=Dx(t.diagnostics,this.items[e].diagnostic);if(!i)return;this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:true,effects:Lx.of(i)})}static open(e){return new Jx(e)}}function Xx(e,t=`viewBox="0 0 40 40"`){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function Yx(e){return Xx(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,`width="6" height="3"`)}const Qx=Kf.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Yx("#d11")},".cm-lintRange-warning":{backgroundImage:Yx("orange")},".cm-lintRange-info":{backgroundImage:Yx("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});const Zx=(()=>[zd(),Ud(),Pu(),Kg(),eg(),uu(),Au(),sl.allowMultipleSelections.of(true),Dm(),og(hg,{fallback:true}),yg(),ox(),Sx(),Xu(),Zu(),zu(),my(),iu.of([...dx,...Jw,...eb,...uv,...Km,...Cx,...zx])])();export{Kf as E,Xi as a,Yi as b,Us as c,Qi as d,Ss as e,Zx as f,Cr as g,Ji as o,St as r};
//# sourceMappingURL=vendor.js.map
